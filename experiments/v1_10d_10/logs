/home/zpgong/RL/MARL_Fin/main.py
#!/usr/bin/env python3
import argparse
import logging
import math
import os
import random
from copy import deepcopy
from pathlib import Path

import numpy as np
import torch
import torch.optim as optim

from env import StockEnv
from helpers import ReplayBuffer
from models import DQN

USE_CUDA = torch.cuda.is_available()
if USE_CUDA:
    print("Using GPU: GPU requested and available.")
    # dtype = torch.cuda.FloatTensor
    # dtypelong = torch.cuda.LongTensor
    device = torch.device("cuda")
else:
    print("NOT Using GPU: GPU not requested or not available.")
    # dtype = torch.FloatTensor
    # dtypelong = torch.LongTensor
    device = torch.device("cpu")


def get_logger(logpath,
               filepath,
               package_files=[],
               displaying=False,
               saving=True,
               debug=False):
    logger = logging.getLogger()
    if debug:
        level = logging.DEBUG
    else:
        level = logging.INFO
    logger.setLevel(level)
    if saving:
        info_file_handler = logging.FileHandler(logpath, mode="a")
        info_file_handler.setLevel(level)
        logger.addHandler(info_file_handler)
    if displaying:
        console_handler = logging.StreamHandler()
        console_handler.setLevel(level)
        logger.addHandler(console_handler)
    logger.info(filepath)
    with open(filepath, "r") as f:
        logger.info(f.read())

    for f in package_files:
        logger.info(f)
        with open(f, "r") as package_f:
            logger.info(package_f.read())

    return logger


class Agent:
    def __init__(self, q_network, target_q_network, lr):
        self.q_network = q_network
        self.target_q_network = target_q_network
        self.num_actions = 3
        self.optimizer = optim.Adam(self.q_network.parameters(), lr=lr)

    def act(self, state, epsilon):
        """DQN action - max q-value w/ epsilon greedy exploration."""
        state = torch.tensor(np.float32(state)).to(device)
        if random.random() > epsilon:
            q_value = self.q_network.forward(state)
            return q_value.max(1)[1].data
        return torch.randint(low=0, high=3,
                             size=(state.shape[0], 1)).squeeze(1)

    def save(self, agent_id, save_dir):
        save_f = Path(f'{save_dir}/model/agent_{agent_id}.pth')
        save_f.parent.mkdir(parents=True, exist_ok=True)
        torch.save(self.q_network.state_dict(), save_f)
        # print("Model has been saved...")

    def load(self, agent_id, save_dir):
        self.q_network = torch.load_state_dict(
            torch.load(f'{save_dir}/model/agent_{agent_id}.pth'))
        self.target_q_network = deepcopy(self.q_network)
        # print("Model has been loaded...")


def corrcoef(x, y):
    vx = x - torch.mean(x)
    vy = y - torch.mean(y)
    corr = torch.sum(vx * vy) / (torch.sqrt(torch.sum(vx**2)) *
                                 torch.sqrt(torch.sum(vy**2)))
    return corr


def compute_local_loss(agent, batch_size, replay_buffer, gamma):
    state, action, reward, next_state, done = replay_buffer.sample(batch_size)
    state = torch.tensor(np.float32(state)).to(device)
    next_state = torch.tensor(np.float32(next_state)).to(device)
    action = torch.tensor(action).to(device)
    reward = torch.tensor(reward).to(device)
    done = torch.tensor(np.float32(done)).to(device)
    # Normal DDQN update
    q_values = agent.q_network(state)
    q_value = q_values.gather(1, action.unsqueeze(1)).squeeze(1)
    # double q-learning
    online_next_q_values = agent.q_network(next_state)
    _, max_indices = torch.max(online_next_q_values, dim=1)
    target_q_values = agent.target_q_network(next_state)
    next_q_value = torch.gather(target_q_values, 1, max_indices.unsqueeze(1))
    expected_q_value = reward + gamma * next_q_value.squeeze(1) * (1 - done)
    loss = (q_value - expected_q_value.data).pow(2).mean()
    agent.optimizer.zero_grad()
    loss.backward()
    agent.optimizer.step()
    return loss


def compute_global_loss(agent_ls, batch_size, replay_buffer, global_optimizer,
                        global_loss_scale):
    state, action, reward, next_state, done = replay_buffer.sample(batch_size)
    state = torch.tensor(np.float32(state)).to(device)
    q_values = [agent.q_network(state) for agent in agent_ls]
    eta_values = [q_value[:, -1] - q_value[:, 0] for q_value in q_values]

    q_target_values = [agent.target_q_network(state) for agent in agent_ls]
    eta_target_values = [
        q_target_value[:, -1] - q_target_value[:, 0]
        for q_target_value in q_target_values
    ]

    corrcoef_ls = [
        corrcoef(eta_values[i], eta_target_values[j])**2
        for i in range(len(eta_values)) for j in range(len(eta_target_values))
        if i != j
    ]

    global_loss = torch.tensor(0.0).to(device)
    for corr in corrcoef_ls:
        global_loss += corr
    global_loss *= global_loss_scale

    global_optimizer.zero_grad()
    global_loss.backward()
    global_optimizer.step()

    return global_loss


def get_epsilon(epsilon_start, epsilon_final, epsilon_decay, frame_idx):
    return epsilon_final + (epsilon_start - epsilon_final) * math.exp(
        -1.0 * frame_idx / epsilon_decay)


def soft_update(q_network, target_q_network, tau):
    for t_param, param in zip(target_q_network.parameters(),
                              q_network.parameters()):
        if t_param is param:
            continue
        new_param = tau * param.data + (1.0 - tau) * t_param.data
        t_param.data.copy_(new_param)


def hard_update(q_network, target_q_network):
    for t_param, param in zip(target_q_network.parameters(),
                              q_network.parameters()):
        if t_param is param:
            continue
        new_param = param.data
        t_param.data.copy_(new_param)


def test_agent(test_env, agent_ls, logger):
    state = test_env.reset()

    while True:
        for idx, agent in enumerate(agent_ls):
            action = agent.act(state, epsilon=0)
            _, _, done, _ = test_env.predict(action.cpu().numpy(),
                                             agent_id=idx)
        if done.all():
            logger.info('test')
            test_env.stats()
            break
        state = test_env.step()


def test_portfolio(train_env, test_env, agent_ls, logger):
    for env in [train_env, test_env]:
        state = env.reset()
        while True:
            for idx, agent in enumerate(agent_ls):
                action = agent.act(state, epsilon=0)
                _, _, done, _ = env.predict(action.cpu().numpy(), agent_id=idx)

            with torch.no_grad():
                q_values = [
                    agent.q_network(
                        torch.as_tensor(state,
                                        device=device,
                                        dtype=torch.float32))
                    for agent in agent_ls
                ]
                eta_values = [
                    q_value[:, -1] - q_value[:, 0] for q_value in q_values
                ]
                eta_values = [
                    eta_value / eta_value.abs().sum()
                    for eta_value in eta_values
                ]

                portfolio = torch.row_stack(eta_values).mean(axis=0)
                portfolio /= portfolio.abs().sum()
                portfolio += 1

                _, _, done, _ = env.predict(portfolio.cpu().numpy(),
                                            agent_id='portfolio')

            if done.all():
                logger.info(env.name)
                env.stats()
                break

            state = env.step()


def make_agent(params, hidden_dims=-1):
    if hidden_dims == -1:
        hidden_dims = params.hidden_dims
    q_network = DQN(num_days=params.ts_window, hidden_dims=hidden_dims)
    target_q_network = deepcopy(q_network)

    if USE_CUDA:
        q_network = q_network.to(device)
        target_q_network = target_q_network.to(device)

    agent = Agent(q_network, target_q_network, lr=params.learning_rate)

    return agent


def run_gym(params):
    logpath = Path(os.path.join(params.save_dir, 'logs'))
    logpath.parent.mkdir(parents=True, exist_ok=True)

    logger = get_logger(logpath=logpath, filepath=os.path.abspath(__file__))
    logger.info(params)

    env = StockEnv(ts_window=params.ts_window,
                   start_date='20100101',
                   end_date='20190101',
                   logger=logger,
                   agent_num=params.agent_num,
                   ic_coef=params.ic_scale,
                   name='train')

    train_env = deepcopy(env)
    test_env = StockEnv(ts_window=params.ts_window,
                        start_date='20190102',
                        end_date='20210603',
                        logger=logger,
                        agent_num=params.agent_num,
                        ic_coef=params.ic_scale,
                        name='test')

    agent_ls = [
        make_agent(params, hidden_dims=(2**(6 + i), 2**(6 + i)))
        for i in range(params.agent_num)
    ]

    global_optimizer = optim.Adam([{
        'params': agent.q_network.parameters()
    } for agent in agent_ls],
                                  lr=params.learning_rate)

    replay_buffer = ReplayBuffer(params.replay_size)

    losses, all_rewards = [], []
    episode_reward = 0

    state = env.reset()
    # state shape: [num_stocks, ts_window]

    for ts in range(1, params.max_ts + 1):

        epsilon = get_epsilon(params.epsilon_start, params.epsilon_end,
                              params.epsilon_decay, ts)

        for idx, agent in enumerate(agent_ls):
            action = agent.act(state, epsilon)
            next_state, reward, done, _ = env.predict(action.cpu().numpy(),
                                                      agent_id=idx)
            reward *= params.reward_scale
            replay_buffer.push_batch(state, action, reward, next_state, done)
            episode_reward += reward.mean()

        if done.all():
            env.stats()
            state = env.reset()
            all_rewards.append(episode_reward / params.agent_num)
            episode_reward = 0

        state = env.step()

        if len(replay_buffer
               ) > params.start_train_ts and ts % params.update_every == 0:
            # Update the q-network & the target network
            for _ in range(params.gradient_step):
                all_loss = 0
                for agent in agent_ls:
                    loss = compute_local_loss(agent, params.batch_size,
                                              replay_buffer, params.gamma)
                    all_loss += loss.data

                global_loss = compute_global_loss(agent_ls, params.batch_size,
                                                  replay_buffer,
                                                  global_optimizer,
                                                  params.global_loss_scale)
                all_loss += global_loss.data
                losses.append(all_loss)

            if ts % params.target_network_update_f == 0:
                for agent in agent_ls:
                    hard_update(agent.q_network, agent.target_q_network)

        if ts % params.log_every == 0:
            out_str = "Timestep {}".format(ts)
            if len(all_rewards) > 0:
                out_str += ", Reward: {}".format(all_rewards[-1])
            if len(losses) > 0:
                out_str += ", TD Loss: {}".format(losses[-1])
            logger.info(out_str)
            [
                agent.save(agent_id=i, save_dir=params.save_dir)
                for i, agent in enumerate(agent_ls)
            ]

            test_agent(test_env, agent_ls, logger)

            if ts > 50000:
                test_portfolio(train_env, test_env, agent_ls, logger)

            logger.info('------------------')


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("--learning_rate", type=float, default=1e-4)
    parser.add_argument("--target_update_rate", type=float, default=0.1)
    parser.add_argument("--replay_size", type=int, default=100000)
    parser.add_argument("--start_train_ts", type=int, default=100)
    parser.add_argument("--epsilon_start", type=float, default=1.0)
    parser.add_argument("--epsilon_end", type=float, default=0.1)
    parser.add_argument("--epsilon_decay", type=int, default=1000)
    parser.add_argument("--max_ts", type=int, default=1000000)
    parser.add_argument("--batch_size", type=int, default=32)
    parser.add_argument("--gamma", type=float, default=0.9)
    parser.add_argument("--log_every", type=int, default=1000)
    parser.add_argument("--target_network_update_f", type=int, default=1000)
    parser.add_argument("--save_dir", type=str, default='experiments/v1')

    parser.add_argument("--ts_window", type=int, default=10)
    parser.add_argument("--reward_scale", type=float, default=1.0)
    parser.add_argument("--update_every", type=int, default=1)
    parser.add_argument("--gradient_step", type=int, default=1)
    parser.add_argument("--hidden_dims", type=tuple, default=(256, 256))
    parser.add_argument("--agent_num", type=int, default=4)
    parser.add_argument("--ic_scale", type=float, default=10.0)
    parser.add_argument("--global_loss_scale", type=float, default=1)

    run_gym(parser.parse_args())

Namespace(agent_num=4, batch_size=32, epsilon_decay=1000, epsilon_end=0.1, epsilon_start=1.0, gamma=0.9, global_loss_scale=1, gradient_step=1, hidden_dims=(256, 256), ic_scale=10.0, learning_rate=0.0001, log_every=1000, max_ts=1000000, replay_size=100000, reward_scale=1.0, save_dir='experiments/v1_10d_10', start_train_ts=100, target_network_update_f=1000, target_update_rate=0.1, ts_window=10, update_every=1)
init env:firstday:20100119 tradedays:2186,tickers:3599
init env:firstday:20190102 tradedays:597,tickers:4400
Timestep 1000, TD Loss: 37.17177949433622
test
0:  annret:8.425,  sharpe:0.574
1:  annret:7.718,  sharpe:0.404
2:  annret:8.488,  sharpe:0.409
3:  annret:8.833,  sharpe:0.518
          0         1         2         3
0  1.000000  0.613164  0.608131  0.456686
1  0.613164  1.000000  0.877836  0.659586
2  0.608131  0.877836  1.000000  0.651749
3  0.456686  0.659586  0.651749  1.000000
------------------
Timestep 2000, TD Loss: 26.90682264284973
test
0:  annret:1.653,  sharpe:0.113
1:  annret:-0.567,  sharpe:-0.035
2:  annret:-2.547,  sharpe:-0.169
3:  annret:-7.288,  sharpe:-0.456
          0         1         2         3
0  1.000000 -0.301277 -0.228348 -0.392296
1 -0.301277  1.000000  0.464466  0.578215
2 -0.228348  0.464466  1.000000  0.488305
3 -0.392296  0.578215  0.488305  1.000000
------------------
0:  annret:-6.062,  sharpe:-0.321
1:  annret:1.852,  sharpe:0.098
2:  annret:7.143,  sharpe:0.430
3:  annret:4.852,  sharpe:0.262
          0         1         2         3
0  1.000000  0.135054  0.138465  0.108078
1  0.135054  1.000000  0.401458  0.472377
2  0.138465  0.401458  1.000000  0.367110
3  0.108078  0.472377  0.367110  1.000000
Timestep 3000, Reward: 77.59519122082959, TD Loss: 36.27515463062572
test
0:  annret:11.574,  sharpe:0.943
1:  annret:8.963,  sharpe:0.497
2:  annret:22.792,  sharpe:1.065
3:  annret:18.829,  sharpe:0.885
          0         1         2         3
0  1.000000  0.131776  0.159075  0.226337
1  0.131776  1.000000  0.888476  0.853761
2  0.159075  0.888476  1.000000  0.950610
3  0.226337  0.853761  0.950610  1.000000
------------------
Timestep 4000, Reward: 77.59519122082959, TD Loss: 17.385320879040805
test
0:  annret:16.628,  sharpe:0.808
1:  annret:-3.864,  sharpe:-0.303
2:  annret:11.299,  sharpe:1.028
3:  annret:1.993,  sharpe:0.131
          0         1         2         3
0  1.000000  0.333852 -0.029554 -0.753392
1  0.333852  1.000000  0.438908 -0.034371
2 -0.029554  0.438908  1.000000  0.248175
3 -0.753392 -0.034371  0.248175  1.000000
------------------
0:  annret:6.926,  sharpe:0.308
1:  annret:6.292,  sharpe:0.307
2:  annret:19.830,  sharpe:0.962
3:  annret:9.994,  sharpe:0.473
          0         1         2         3
0  1.000000  0.373077  0.290762  0.444940
1  0.373077  1.000000  0.531096  0.358686
2  0.290762  0.531096  1.000000  0.418021
3  0.444940  0.358686  0.418021  1.000000
Timestep 5000, Reward: 154.06809340350014, TD Loss: 16.63887502299461
test
0:  annret:17.155,  sharpe:1.161
1:  annret:-3.230,  sharpe:-0.189
2:  annret:14.900,  sharpe:0.960
3:  annret:17.557,  sharpe:1.283
          0         1         2         3
0  1.000000  0.235323  0.446548  0.422018
1  0.235323  1.000000  0.611571  0.212404
2  0.446548  0.611571  1.000000  0.510823
3  0.422018  0.212404  0.510823  1.000000
------------------
Timestep 6000, Reward: 154.06809340350014, TD Loss: 6.928017673672496
test
0:  annret:17.850,  sharpe:0.860
1:  annret:5.280,  sharpe:0.369
2:  annret:17.817,  sharpe:1.127
3:  annret:10.478,  sharpe:0.652
          0         1         2         3
0  1.000000  0.661723  0.690481  0.757204
1  0.661723  1.000000  0.770076  0.710683
2  0.690481  0.770076  1.000000  0.741754
3  0.757204  0.710683  0.741754  1.000000
------------------
0:  annret:7.388,  sharpe:0.329
1:  annret:6.208,  sharpe:0.314
2:  annret:12.787,  sharpe:0.607
3:  annret:11.969,  sharpe:0.556
          0         1         2         3
0  1.000000  0.426947  0.529337  0.569201
1  0.426947  1.000000  0.505067  0.566290
2  0.529337  0.505067  1.000000  0.551554
3  0.569201  0.566290  0.551554  1.000000
Timestep 7000, Reward: 169.76160538147494, TD Loss: 18.979384222431285
test
0:  annret:9.054,  sharpe:0.688
1:  annret:-6.218,  sharpe:-0.449
2:  annret:28.738,  sharpe:1.596
3:  annret:23.092,  sharpe:1.786
          0         1         2         3
0  1.000000  0.010355  0.376642  0.266712
1  0.010355  1.000000 -0.365841  0.315350
2  0.376642 -0.365841  1.000000  0.036505
3  0.266712  0.315350  0.036505  1.000000
------------------
Timestep 8000, Reward: 169.76160538147494, TD Loss: 50.30222494763899
test
0:  annret:12.945,  sharpe:0.704
1:  annret:-3.627,  sharpe:-0.263
2:  annret:-0.353,  sharpe:-0.030
3:  annret:1.846,  sharpe:0.160
          0         1         2         3
0  1.000000  0.393134 -0.156747  0.241869
1  0.393134  1.000000  0.571125  0.597933
2 -0.156747  0.571125  1.000000  0.710138
3  0.241869  0.597933  0.710138  1.000000
------------------
0:  annret:-3.422,  sharpe:-0.160
1:  annret:7.871,  sharpe:0.400
2:  annret:20.641,  sharpe:0.977
3:  annret:15.430,  sharpe:0.736
          0         1         2         3
0  1.000000  0.578605  0.506585  0.470433
1  0.578605  1.000000  0.420177  0.425359
2  0.506585  0.420177  1.000000  0.535744
3  0.470433  0.425359  0.535744  1.000000
Timestep 9000, Reward: 130.29630739687306, TD Loss: 10.227993780882077
test
0:  annret:14.374,  sharpe:0.901
1:  annret:10.418,  sharpe:0.757
2:  annret:10.918,  sharpe:0.819
3:  annret:9.816,  sharpe:0.448
          0         1         2         3
0  1.000000  0.664946 -0.071279  0.780027
1  0.664946  1.000000 -0.102009  0.574357
2 -0.071279 -0.102009  1.000000 -0.275820
3  0.780027  0.574357 -0.275820  1.000000
------------------
Timestep 10000, Reward: 130.29630739687306, TD Loss: 49.40447427494389
test
0:  annret:19.007,  sharpe:0.752
1:  annret:13.103,  sharpe:0.604
2:  annret:14.910,  sharpe:0.698
3:  annret:17.581,  sharpe:0.687
          0         1         2         3
0  1.000000  0.928876  0.909724  0.993528
1  0.928876  1.000000  0.906609  0.930146
2  0.909724  0.906609  1.000000  0.911730
3  0.993528  0.930146  0.911730  1.000000
------------------
0:  annret:0.124,  sharpe:0.005
1:  annret:9.044,  sharpe:0.482
2:  annret:10.233,  sharpe:0.497
3:  annret:5.593,  sharpe:0.264
          0         1         2         3
0  1.000000  0.421156  0.383060  0.367010
1  0.421156  1.000000  0.329430  0.455212
2  0.383060  0.329430  1.000000  0.337477
3  0.367010  0.455212  0.337477  1.000000
Timestep 11000, Reward: 162.55099958114243, TD Loss: 17.696499374230154
test
0:  annret:-3.933,  sharpe:-0.271
1:  annret:-10.751,  sharpe:-0.533
2:  annret:9.716,  sharpe:0.567
3:  annret:-10.642,  sharpe:-0.468
          0         1         2         3
0  1.000000  0.539620  0.313553  0.563696
1  0.539620  1.000000  0.618067  0.807729
2  0.313553  0.618067  1.000000  0.682875
3  0.563696  0.807729  0.682875  1.000000
------------------
Timestep 12000, Reward: 162.55099958114243, TD Loss: 18.9109579563356
test
0:  annret:18.330,  sharpe:0.820
1:  annret:12.072,  sharpe:0.730
2:  annret:17.684,  sharpe:0.863
3:  annret:10.922,  sharpe:0.597
          0         1         2         3
0  1.000000  0.827783  0.869170  0.914084
1  0.827783  1.000000  0.812418  0.846823
2  0.869170  0.812418  1.000000  0.841640
3  0.914084  0.846823  0.841640  1.000000
------------------
Timestep 13000, Reward: 162.55099958114243, TD Loss: 42.438446607398085
test
0:  annret:-6.537,  sharpe:-0.471
1:  annret:-10.053,  sharpe:-0.472
2:  annret:8.073,  sharpe:0.491
3:  annret:-4.993,  sharpe:-0.216
          0         1         2         3
0  1.000000  0.478977  0.423278  0.548559
1  0.478977  1.000000  0.670529  0.846966
2  0.423278  0.670529  1.000000  0.727845
3  0.548559  0.846966  0.727845  1.000000
------------------
0:  annret:4.205,  sharpe:0.185
1:  annret:14.473,  sharpe:0.745
2:  annret:17.495,  sharpe:0.851
3:  annret:20.363,  sharpe:0.955
          0         1         2         3
0  1.000000  0.327667  0.489269  0.311837
1  0.327667  1.000000  0.483272  0.402953
2  0.489269  0.483272  1.000000  0.441132
3  0.311837  0.402953  0.441132  1.000000
Timestep 14000, Reward: 241.5754929764637, TD Loss: 15.661533502678571
test
0:  annret:10.895,  sharpe:0.738
1:  annret:14.212,  sharpe:1.131
2:  annret:15.715,  sharpe:0.990
3:  annret:5.422,  sharpe:0.530
          0         1         2         3
0  1.000000  0.520036  0.372177 -0.298130
1  0.520036  1.000000  0.435854 -0.112427
2  0.372177  0.435854  1.000000 -0.118779
3 -0.298130 -0.112427 -0.118779  1.000000
------------------
Timestep 15000, Reward: 241.5754929764637, TD Loss: 11.526535581949402
test
0:  annret:3.936,  sharpe:0.288
1:  annret:8.763,  sharpe:0.447
2:  annret:14.084,  sharpe:1.228
3:  annret:4.808,  sharpe:0.427
          0         1         2         3
0  1.000000 -0.015713  0.098400  0.170572
1 -0.015713  1.000000  0.022613  0.088028
2  0.098400  0.022613  1.000000  0.333605
3  0.170572  0.088028  0.333605  1.000000
------------------
0:  annret:1.330,  sharpe:0.066
1:  annret:6.439,  sharpe:0.308
2:  annret:20.019,  sharpe:0.983
3:  annret:13.827,  sharpe:0.721
          0         1         2         3
0  1.000000  0.248929  0.405326  0.308244
1  0.248929  1.000000  0.387118  0.421653
2  0.405326  0.387118  1.000000  0.498014
3  0.308244  0.421653  0.498014  1.000000
Timestep 16000, Reward: 246.48038011500708, TD Loss: 10.258701283323969
test
0:  annret:12.394,  sharpe:0.724
1:  annret:18.940,  sharpe:1.508
2:  annret:9.986,  sharpe:0.832
3:  annret:3.646,  sharpe:0.209
          0         1         2         3
0  1.000000  0.118223  0.323325 -0.614266
1  0.118223  1.000000  0.057113 -0.003500
2  0.323325  0.057113  1.000000 -0.164034
3 -0.614266 -0.003500 -0.164034  1.000000
------------------
Timestep 17000, Reward: 246.48038011500708, TD Loss: 21.63221433627155
test
0:  annret:14.223,  sharpe:1.128
1:  annret:-1.670,  sharpe:-0.093
2:  annret:14.598,  sharpe:1.131
3:  annret:1.745,  sharpe:0.102
          0         1         2         3
0  1.000000 -0.290322 -0.207973 -0.542581
1 -0.290322  1.000000  0.584795  0.754216
2 -0.207973  0.584795  1.000000  0.655946
3 -0.542581  0.754216  0.655946  1.000000
------------------
0:  annret:3.996,  sharpe:0.191
1:  annret:16.750,  sharpe:0.810
2:  annret:22.677,  sharpe:1.153
3:  annret:21.333,  sharpe:1.082
          0         1         2         3
0  1.000000  0.317302  0.507141  0.217346
1  0.317302  1.000000  0.392157  0.468136
2  0.507141  0.392157  1.000000  0.287627
3  0.217346  0.468136  0.287627  1.000000
Timestep 18000, Reward: 311.85009258440755, TD Loss: 12.217103288070728
test
0:  annret:3.201,  sharpe:0.202
1:  annret:-0.599,  sharpe:-0.038
2:  annret:12.976,  sharpe:0.903
3:  annret:-15.068,  sharpe:-0.932
          0         1         2         3
0  1.000000 -0.424739 -0.069882 -0.478251
1 -0.424739  1.000000  0.477926  0.477914
2 -0.069882  0.477926  1.000000  0.376162
3 -0.478251  0.477914  0.376162  1.000000
------------------
Timestep 19000, Reward: 311.85009258440755, TD Loss: 20.976681252398798
test
0:  annret:16.506,  sharpe:0.885
1:  annret:5.177,  sharpe:0.464
2:  annret:20.190,  sharpe:1.202
3:  annret:10.516,  sharpe:1.119
          0         1         2         3
0  1.000000  0.147672  0.865613 -0.108344
1  0.147672  1.000000  0.216630  0.505456
2  0.865613  0.216630  1.000000  0.121573
3 -0.108344  0.505456  0.121573  1.000000
------------------
0:  annret:5.925,  sharpe:0.259
1:  annret:0.998,  sharpe:0.048
2:  annret:25.888,  sharpe:1.265
3:  annret:9.937,  sharpe:0.494
          0         1         2         3
0  1.000000  0.183687  0.539471  0.362763
1  0.183687  1.000000  0.302554  0.496266
2  0.539471  0.302554  1.000000  0.437345
3  0.362763  0.496266  0.437345  1.000000
Timestep 20000, Reward: 244.15575595317398, TD Loss: 9.167681442176502
test
0:  annret:11.223,  sharpe:0.794
1:  annret:-4.818,  sharpe:-0.246
2:  annret:23.555,  sharpe:1.604
3:  annret:-7.858,  sharpe:-0.414
          0         1         2         3
0  1.000000 -0.290583  0.448314 -0.477117
1 -0.290583  1.000000 -0.268057  0.674817
2  0.448314 -0.268057  1.000000 -0.405118
3 -0.477117  0.674817 -0.405118  1.000000
------------------
Timestep 21000, Reward: 244.15575595317398, TD Loss: 53.54719016371437
test
0:  annret:12.882,  sharpe:0.773
1:  annret:2.243,  sharpe:0.182
2:  annret:3.705,  sharpe:0.313
3:  annret:5.885,  sharpe:0.424
          0         1         2         3
0  1.000000  0.144364  0.734704  0.759909
1  0.144364  1.000000  0.300409  0.236081
2  0.734704  0.300409  1.000000  0.842298
3  0.759909  0.236081  0.842298  1.000000
------------------
0:  annret:6.161,  sharpe:0.310
1:  annret:14.687,  sharpe:0.701
2:  annret:24.003,  sharpe:1.235
3:  annret:7.675,  sharpe:0.372
          0         1         2         3
0  1.000000  0.235723  0.374656  0.371912
1  0.235723  1.000000  0.479617  0.479508
2  0.374656  0.479617  1.000000  0.436270
3  0.371912  0.479508  0.436270  1.000000
Timestep 22000, Reward: 241.67515432663777, TD Loss: 11.484169991533573
test
0:  annret:3.929,  sharpe:0.320
1:  annret:3.334,  sharpe:0.194
2:  annret:9.351,  sharpe:0.673
3:  annret:5.239,  sharpe:0.332
          0         1         2         3
0  1.000000  0.353923  0.523357  0.349359
1  0.353923  1.000000  0.543610  0.661383
2  0.523357  0.543610  1.000000  0.523403
3  0.349359  0.661383  0.523403  1.000000
------------------
Timestep 23000, Reward: 241.67515432663777, TD Loss: 23.7939335128509
test
0:  annret:11.523,  sharpe:0.597
1:  annret:13.901,  sharpe:0.888
2:  annret:16.209,  sharpe:1.223
3:  annret:6.675,  sharpe:0.322
          0         1         2         3
0  1.000000  0.641736  0.474388  0.752770
1  0.641736  1.000000  0.451968  0.749506
2  0.474388  0.451968  1.000000  0.459694
3  0.752770  0.749506  0.459694  1.000000
------------------
0:  annret:6.129,  sharpe:0.308
1:  annret:21.212,  sharpe:0.975
2:  annret:17.235,  sharpe:0.908
3:  annret:14.243,  sharpe:0.691
          0         1         2         3
0  1.000000  0.257069  0.375803  0.283331
1  0.257069  1.000000  0.418077  0.522834
2  0.375803  0.418077  1.000000  0.406587
3  0.283331  0.522834  0.406587  1.000000
Timestep 24000, Reward: 273.81546951889527, TD Loss: 23.48747970362104
test
0:  annret:3.340,  sharpe:0.199
1:  annret:17.376,  sharpe:0.934
2:  annret:9.351,  sharpe:0.534
3:  annret:-4.018,  sharpe:-0.221
          0         1         2         3
0  1.000000  0.506788  0.535387  0.619773
1  0.506788  1.000000  0.421279  0.603648
2  0.535387  0.421279  1.000000  0.607719
3  0.619773  0.603648  0.607719  1.000000
------------------
Timestep 25000, Reward: 273.81546951889527, TD Loss: 5.433437638063015
test
0:  annret:7.324,  sharpe:0.615
1:  annret:21.375,  sharpe:1.211
2:  annret:25.623,  sharpe:1.914
3:  annret:-2.960,  sharpe:-0.225
          0         1         2         3
0  1.000000 -0.232364  0.165165 -0.285921
1 -0.232364  1.000000 -0.370343  0.265939
2  0.165165 -0.370343  1.000000 -0.235921
3 -0.285921  0.265939 -0.235921  1.000000
------------------
Timestep 26000, Reward: 273.81546951889527, TD Loss: 18.77934901891949
test
0:  annret:-0.155,  sharpe:-0.010
1:  annret:11.961,  sharpe:0.641
2:  annret:24.376,  sharpe:2.449
3:  annret:-2.804,  sharpe:-0.150
          0         1         2         3
0  1.000000  0.521235 -0.223940  0.564525
1  0.521235  1.000000 -0.122395  0.603691
2 -0.223940 -0.122395  1.000000 -0.196360
3  0.564525  0.603691 -0.196360  1.000000
------------------
0:  annret:0.478,  sharpe:0.023
1:  annret:16.784,  sharpe:0.774
2:  annret:19.714,  sharpe:0.990
3:  annret:11.063,  sharpe:0.527
          0         1         2         3
0  1.000000  0.433231  0.404782  0.408440
1  0.433231  1.000000  0.458699  0.493076
2  0.404782  0.458699  1.000000  0.465483
3  0.408440  0.493076  0.465483  1.000000
Timestep 27000, Reward: 285.3019328068899, TD Loss: 9.791289730551188
test
0:  annret:9.569,  sharpe:0.724
1:  annret:20.388,  sharpe:1.237
2:  annret:8.015,  sharpe:0.482
3:  annret:2.552,  sharpe:0.204
          0         1         2         3
0  1.000000  0.185488  0.008864  0.240925
1  0.185488  1.000000  0.304189  0.469031
2  0.008864  0.304189  1.000000  0.199706
3  0.240925  0.469031  0.199706  1.000000
------------------
Timestep 28000, Reward: 285.3019328068899, TD Loss: 14.09159070596636
test
0:  annret:1.782,  sharpe:0.145
1:  annret:8.323,  sharpe:0.509
2:  annret:11.648,  sharpe:0.756
3:  annret:9.969,  sharpe:0.623
          0         1         2         3
0  1.000000  0.346177  0.280079  0.300527
1  0.346177  1.000000  0.581422  0.629223
2  0.280079  0.581422  1.000000  0.610324
3  0.300527  0.629223  0.610324  1.000000
------------------
0:  annret:7.895,  sharpe:0.372
1:  annret:22.434,  sharpe:0.992
2:  annret:22.794,  sharpe:1.134
3:  annret:21.220,  sharpe:1.018
          0         1         2         3
0  1.000000  0.416932  0.465340  0.404658
1  0.416932  1.000000  0.426936  0.561729
2  0.465340  0.426936  1.000000  0.451091
3  0.404658  0.561729  0.451091  1.000000
Timestep 29000, Reward: 304.4107241610184, TD Loss: 3.5704356762899674
test
0:  annret:5.067,  sharpe:0.339
1:  annret:9.253,  sharpe:0.452
2:  annret:27.808,  sharpe:1.894
3:  annret:10.504,  sharpe:0.545
          0         1         2         3
0  1.000000  0.280675  0.051431  0.469638
1  0.280675  1.000000  0.091103  0.630635
2  0.051431  0.091103  1.000000  0.102206
3  0.469638  0.630635  0.102206  1.000000
------------------
Timestep 30000, Reward: 304.4107241610184, TD Loss: 9.783013773906811
test
0:  annret:11.300,  sharpe:0.876
1:  annret:3.696,  sharpe:0.247
2:  annret:18.075,  sharpe:1.713
3:  annret:6.692,  sharpe:0.525
          0         1         2         3
0  1.000000 -0.398915 -0.127128 -0.395552
1 -0.398915  1.000000  0.311380  0.676790
2 -0.127128  0.311380  1.000000  0.405520
3 -0.395552  0.676790  0.405520  1.000000
------------------
0:  annret:14.046,  sharpe:0.640
1:  annret:15.733,  sharpe:0.747
2:  annret:32.283,  sharpe:1.670
3:  annret:25.204,  sharpe:1.254
          0         1         2         3
0  1.000000  0.339957  0.336681  0.171847
1  0.339957  1.000000  0.383195  0.452204
2  0.336681  0.383195  1.000000  0.219739
3  0.171847  0.452204  0.219739  1.000000
Timestep 31000, Reward: 308.72463595842476, TD Loss: 7.285351556629683
test
0:  annret:7.117,  sharpe:0.459
1:  annret:2.766,  sharpe:0.246
2:  annret:14.113,  sharpe:1.030
3:  annret:6.728,  sharpe:0.492
          0         1         2         3
0  1.000000 -0.283750 -0.188942 -0.064497
1 -0.283750  1.000000  0.164415  0.259828
2 -0.188942  0.164415  1.000000  0.516286
3 -0.064497  0.259828  0.516286  1.000000
------------------
Timestep 32000, Reward: 308.72463595842476, TD Loss: 24.808906692357212
test
0:  annret:16.432,  sharpe:0.794
1:  annret:-4.103,  sharpe:-0.199
2:  annret:11.549,  sharpe:0.862
3:  annret:14.609,  sharpe:1.347
          0         1         2         3
0  1.000000 -0.817855  0.695913  0.509240
1 -0.817855  1.000000 -0.558622 -0.344863
2  0.695913 -0.558622  1.000000  0.709254
3  0.509240 -0.344863  0.709254  1.000000
------------------
0:  annret:17.382,  sharpe:0.839
1:  annret:21.703,  sharpe:0.972
2:  annret:32.484,  sharpe:1.590
3:  annret:20.617,  sharpe:1.033
          0         1         2         3
0  1.000000  0.199459  0.288957  0.310134
1  0.199459  1.000000  0.424552  0.443465
2  0.288957  0.424552  1.000000  0.356721
3  0.310134  0.443465  0.356721  1.000000
Timestep 33000, Reward: 326.55088116214506, TD Loss: 19.9133639315698
test
0:  annret:11.842,  sharpe:0.840
1:  annret:2.284,  sharpe:0.111
2:  annret:17.795,  sharpe:1.145
3:  annret:6.340,  sharpe:0.450
          0         1         2         3
0  1.000000 -0.514082  0.666914 -0.536042
1 -0.514082  1.000000 -0.681600  0.573925
2  0.666914 -0.681600  1.000000 -0.668113
3 -0.536042  0.573925 -0.668113  1.000000
------------------
Timestep 34000, Reward: 326.55088116214506, TD Loss: 72.4209497435378
test
0:  annret:8.954,  sharpe:0.524
1:  annret:-2.915,  sharpe:-0.261
2:  annret:-1.666,  sharpe:-0.156
3:  annret:-3.729,  sharpe:-0.283
          0         1         2         3
0  1.000000 -0.271793 -0.204861 -0.545273
1 -0.271793  1.000000  0.337306  0.331922
2 -0.204861  0.337306  1.000000  0.416855
3 -0.545273  0.331922  0.416855  1.000000
------------------
0:  annret:11.394,  sharpe:0.504
1:  annret:8.896,  sharpe:0.394
2:  annret:19.463,  sharpe:0.980
3:  annret:14.536,  sharpe:0.711
          0         1         2         3
0  1.000000  0.238514  0.389659  0.351896
1  0.238514  1.000000  0.260756  0.418530
2  0.389659  0.260756  1.000000  0.289518
3  0.351896  0.418530  0.289518  1.000000
Timestep 35000, Reward: 260.60020909189757, TD Loss: 15.696249182421244
test
0:  annret:7.706,  sharpe:0.654
1:  annret:8.952,  sharpe:0.423
2:  annret:18.964,  sharpe:1.126
3:  annret:-0.457,  sharpe:-0.041
          0         1         2         3
0  1.000000 -0.198786  0.175251  0.131165
1 -0.198786  1.000000 -0.605627  0.268723
2  0.175251 -0.605627  1.000000 -0.137345
3  0.131165  0.268723 -0.137345  1.000000
------------------
Timestep 36000, Reward: 260.60020909189757, TD Loss: 20.546903118359655
test
0:  annret:12.435,  sharpe:0.559
1:  annret:16.926,  sharpe:0.878
2:  annret:19.334,  sharpe:0.992
3:  annret:12.557,  sharpe:0.904
          0         1         2         3
0  1.000000 -0.530023  0.805729 -0.330350
1 -0.530023  1.000000 -0.573132  0.279987
2  0.805729 -0.573132  1.000000 -0.306438
3 -0.330350  0.279987 -0.306438  1.000000
------------------
0:  annret:10.285,  sharpe:0.478
1:  annret:10.536,  sharpe:0.478
2:  annret:23.449,  sharpe:1.152
3:  annret:22.355,  sharpe:1.156
          0         1         2         3
0  1.000000  0.301506  0.359086  0.147879
1  0.301506  1.000000  0.379772  0.465081
2  0.359086  0.379772  1.000000  0.263974
3  0.147879  0.465081  0.263974  1.000000
Timestep 37000, Reward: 291.8246104109127, TD Loss: 7.029531388472918
test
0:  annret:3.453,  sharpe:0.237
1:  annret:4.022,  sharpe:0.214
2:  annret:2.685,  sharpe:0.147
3:  annret:8.123,  sharpe:0.523
          0         1         2         3
0  1.000000 -0.457165 -0.470952 -0.445382
1 -0.457165  1.000000  0.609045  0.515870
2 -0.470952  0.609045  1.000000  0.634567
3 -0.445382  0.515870  0.634567  1.000000
------------------
Timestep 38000, Reward: 291.8246104109127, TD Loss: 14.882501750654873
test
0:  annret:0.056,  sharpe:0.005
1:  annret:1.896,  sharpe:0.086
2:  annret:17.619,  sharpe:0.851
3:  annret:8.502,  sharpe:0.815
          0         1         2         3
0  1.000000 -0.187161  0.118983 -0.040902
1 -0.187161  1.000000 -0.759964  0.383381
2  0.118983 -0.759964  1.000000 -0.472506
3 -0.040902  0.383381 -0.472506  1.000000
------------------
Timestep 39000, Reward: 291.8246104109127, TD Loss: 27.386819332267663
test
0:  annret:9.164,  sharpe:0.796
1:  annret:-2.871,  sharpe:-0.167
2:  annret:11.527,  sharpe:0.815
3:  annret:6.157,  sharpe:0.425
          0         1         2         3
0  1.000000 -0.058567 -0.042143 -0.115464
1 -0.058567  1.000000  0.542375  0.595840
2 -0.042143  0.542375  1.000000  0.545568
3 -0.115464  0.595840  0.545568  1.000000
------------------
0:  annret:16.249,  sharpe:0.790
1:  annret:13.164,  sharpe:0.621
2:  annret:20.923,  sharpe:1.081
3:  annret:23.588,  sharpe:1.137
          0         1         2         3
0  1.000000  0.360538  0.225137  0.262738
1  0.360538  1.000000  0.373216  0.527582
2  0.225137  0.373216  1.000000  0.388790
3  0.262738  0.527582  0.388790  1.000000
Timestep 40000, Reward: 306.82212485025264, TD Loss: 17.9572033313602
test
0:  annret:4.639,  sharpe:0.318
1:  annret:0.430,  sharpe:0.030
2:  annret:9.625,  sharpe:0.971
3:  annret:7.187,  sharpe:0.407
          0         1         2         3
0  1.000000  0.532889 -0.020780  0.567291
1  0.532889  1.000000  0.058552  0.621553
2 -0.020780  0.058552  1.000000 -0.080544
3  0.567291  0.621553 -0.080544  1.000000
------------------
Timestep 41000, Reward: 306.82212485025264, TD Loss: 10.39973843315854
test
0:  annret:1.922,  sharpe:0.180
1:  annret:-5.569,  sharpe:-0.331
2:  annret:7.418,  sharpe:0.549
3:  annret:8.737,  sharpe:0.818
          0         1         2         3
0  1.000000  0.286449  0.177044  0.461095
1  0.286449  1.000000  0.328759  0.223143
2  0.177044  0.328759  1.000000  0.375172
3  0.461095  0.223143  0.375172  1.000000
------------------
0:  annret:13.057,  sharpe:0.590
1:  annret:12.354,  sharpe:0.563
2:  annret:24.133,  sharpe:1.249
3:  annret:24.099,  sharpe:1.128
          0         1         2         3
0  1.000000  0.446504  0.563894  0.401731
1  0.446504  1.000000  0.387440  0.482352
2  0.563894  0.387440  1.000000  0.358656
3  0.401731  0.482352  0.358656  1.000000
Timestep 42000, Reward: 302.0553962054596, TD Loss: 7.3945907716102575
test
0:  annret:1.629,  sharpe:0.119
1:  annret:4.120,  sharpe:0.198
2:  annret:7.898,  sharpe:0.449
3:  annret:0.104,  sharpe:0.006
          0         1         2         3
0  1.000000  0.541944  0.518599  0.536359
1  0.541944  1.000000  0.595527  0.642518
2  0.518599  0.595527  1.000000  0.618356
3  0.536359  0.642518  0.618356  1.000000
------------------
Timestep 43000, Reward: 302.0553962054596, TD Loss: 16.999973669787448
test
0:  annret:15.500,  sharpe:0.782
1:  annret:2.482,  sharpe:0.184
2:  annret:-2.638,  sharpe:-0.163
3:  annret:9.801,  sharpe:0.843
          0         1         2         3
0  1.000000 -0.445905 -0.705002 -0.511069
1 -0.445905  1.000000  0.455960  0.527233
2 -0.705002  0.455960  1.000000  0.560543
3 -0.511069  0.527233  0.560543  1.000000
------------------
0:  annret:5.905,  sharpe:0.260
1:  annret:18.750,  sharpe:0.881
2:  annret:21.191,  sharpe:1.137
3:  annret:18.860,  sharpe:0.961
          0         1         2         3
0  1.000000  0.420847  0.222302  0.379489
1  0.420847  1.000000  0.377835  0.425430
2  0.222302  0.377835  1.000000  0.307461
3  0.379489  0.425430  0.307461  1.000000
Timestep 44000, Reward: 295.7038754104667, TD Loss: 6.645943616486183
test
0:  annret:14.195,  sharpe:0.833
1:  annret:6.516,  sharpe:0.433
2:  annret:-0.565,  sharpe:-0.030
3:  annret:11.558,  sharpe:0.584
          0         1         2         3
0  1.000000 -0.459886 -0.440672 -0.647337
1 -0.459886  1.000000  0.523349  0.572603
2 -0.440672  0.523349  1.000000  0.780914
3 -0.647337  0.572603  0.780914  1.000000
------------------
Timestep 45000, Reward: 295.7038754104667, TD Loss: 32.23098640956481
test
0:  annret:-8.806,  sharpe:-0.625
1:  annret:3.036,  sharpe:0.219
2:  annret:5.220,  sharpe:0.702
3:  annret:3.957,  sharpe:0.316
          0         1         2         3
0  1.000000  0.580532  0.122993  0.721062
1  0.580532  1.000000  0.076927  0.444724
2  0.122993  0.076927  1.000000  0.203394
3  0.721062  0.444724  0.203394  1.000000
------------------
0:  annret:16.554,  sharpe:0.828
1:  annret:15.459,  sharpe:0.724
2:  annret:21.744,  sharpe:1.089
3:  annret:18.263,  sharpe:0.909
          0         1         2         3
0  1.000000  0.502613  0.290009  0.291736
1  0.502613  1.000000  0.368016  0.402896
2  0.290009  0.368016  1.000000  0.326876
3  0.291736  0.402896  0.326876  1.000000
Timestep 46000, Reward: 278.4245875115751, TD Loss: 8.3278784803647
test
0:  annret:0.528,  sharpe:0.054
1:  annret:11.784,  sharpe:0.634
2:  annret:-4.059,  sharpe:-0.352
3:  annret:14.556,  sharpe:1.014
          0         1         2         3
0  1.000000 -0.051902  0.067844  0.134339
1 -0.051902  1.000000 -0.365748 -0.623157
2  0.067844 -0.365748  1.000000  0.424797
3  0.134339 -0.623157  0.424797  1.000000
------------------
Timestep 47000, Reward: 278.4245875115751, TD Loss: 165.22628103555644
test
0:  annret:13.332,  sharpe:0.604
1:  annret:10.330,  sharpe:0.955
2:  annret:9.013,  sharpe:0.660
3:  annret:1.127,  sharpe:0.129
          0         1         2         3
0  1.000000  0.020883  0.656547  0.247009
1  0.020883  1.000000 -0.011937 -0.201421
2  0.656547 -0.011937  1.000000  0.216736
3  0.247009 -0.201421  0.216736  1.000000
------------------
0:  annret:7.769,  sharpe:0.355
1:  annret:-0.564,  sharpe:-0.027
2:  annret:20.387,  sharpe:1.088
3:  annret:25.391,  sharpe:1.221
          0         1         2         3
0  1.000000  0.475361  0.392136  0.472679
1  0.475361  1.000000  0.389155  0.425495
2  0.392136  0.389155  1.000000  0.310983
3  0.472679  0.425495  0.310983  1.000000
Timestep 48000, Reward: 240.7448681825772, TD Loss: 15.12889696579442
test
0:  annret:-5.028,  sharpe:-0.369
1:  annret:4.680,  sharpe:0.439
2:  annret:-2.553,  sharpe:-0.129
3:  annret:-1.843,  sharpe:-0.091
          0         1         2         3
0  1.000000  0.138489  0.667267  0.666288
1  0.138489  1.000000  0.175603  0.271384
2  0.667267  0.175603  1.000000  0.698856
3  0.666288  0.271384  0.698856  1.000000
------------------
Timestep 49000, Reward: 240.7448681825772, TD Loss: 6.498114742760242
test
0:  annret:14.349,  sharpe:0.655
1:  annret:14.278,  sharpe:0.659
2:  annret:20.051,  sharpe:0.891
3:  annret:5.807,  sharpe:0.292
          0         1         2         3
0  1.000000  0.793794  0.860361  0.786838
1  0.793794  1.000000  0.876357  0.802932
2  0.860361  0.876357  1.000000  0.814960
3  0.786838  0.802932  0.814960  1.000000
------------------
Timestep 50000, Reward: 240.7448681825772, TD Loss: 12.26384052382523
test
0:  annret:8.432,  sharpe:0.535
1:  annret:12.570,  sharpe:1.261
2:  annret:-0.561,  sharpe:-0.040
3:  annret:-2.109,  sharpe:-0.127
          0         1         2         3
0  1.000000  0.170042 -0.237923 -0.586460
1  0.170042  1.000000 -0.138183 -0.106630
2 -0.237923 -0.138183  1.000000  0.583435
3 -0.586460 -0.106630  0.583435  1.000000
------------------
0:  annret:10.130,  sharpe:0.438
1:  annret:8.704,  sharpe:0.417
2:  annret:31.200,  sharpe:1.578
3:  annret:24.634,  sharpe:1.199
          0         1         2         3
0  1.000000  0.425939  0.303061  0.364139
1  0.425939  1.000000  0.390755  0.380916
2  0.303061  0.390755  1.000000  0.384364
3  0.364139  0.380916  0.384364  1.000000
Timestep 51000, Reward: 299.5872166419155, TD Loss: 28.889942389635898
test
0:  annret:8.131,  sharpe:0.561
1:  annret:11.207,  sharpe:0.589
2:  annret:12.127,  sharpe:1.134
3:  annret:2.187,  sharpe:0.223
          0         1         2         3
0  1.000000  0.507763  0.097601 -0.058918
1  0.507763  1.000000 -0.067413 -0.106023
2  0.097601 -0.067413  1.000000  0.307357
3 -0.058918 -0.106023  0.307357  1.000000
train
0:  annret:24.121,  sharpe:1.255
1:  annret:16.198,  sharpe:0.721
2:  annret:37.335,  sharpe:2.365
3:  annret:31.705,  sharpe:1.990
portfolio:  annret:52.092,  sharpe:3.669
                  0         1         2         3  portfolio
0          1.000000  0.450128  0.143650  0.058885   0.511260
1          0.450128  1.000000  0.033331  0.016696   0.373163
2          0.143650  0.033331  1.000000  0.305799   0.560067
3          0.058885  0.016696  0.305799  1.000000   0.507656
portfolio  0.511260  0.373163  0.560067  0.507656   1.000000
test
0:  annret:8.131,  sharpe:0.561
1:  annret:11.207,  sharpe:0.589
2:  annret:12.127,  sharpe:1.134
3:  annret:2.187,  sharpe:0.223
portfolio:  annret:14.711,  sharpe:1.619
                  0         1         2         3  portfolio
0          1.000000  0.507763  0.097601 -0.058918   0.510687
1          0.507763  1.000000 -0.067413 -0.106023   0.300769
2          0.097601 -0.067413  1.000000  0.307357   0.373283
3         -0.058918 -0.106023  0.307357  1.000000   0.328107
portfolio  0.510687  0.300769  0.373283  0.328107   1.000000
------------------
Timestep 52000, Reward: 299.5872166419155, TD Loss: 24.501422761634544
test
0:  annret:14.592,  sharpe:1.217
1:  annret:-3.903,  sharpe:-0.272
2:  annret:5.205,  sharpe:0.449
3:  annret:11.027,  sharpe:1.061
          0         1         2         3
0  1.000000 -0.257112 -0.057543  0.248989
1 -0.257112  1.000000  0.347701  0.253815
2 -0.057543  0.347701  1.000000  0.312994
3  0.248989  0.253815  0.312994  1.000000
train
0:  annret:33.882,  sharpe:2.056
1:  annret:38.363,  sharpe:2.005
2:  annret:36.642,  sharpe:2.018
3:  annret:33.823,  sharpe:1.993
portfolio:  annret:54.914,  sharpe:3.318
                  0         1         2         3  portfolio
0          1.000000  0.057283  0.117726  0.390345   0.354208
1          0.057283  1.000000  0.540066  0.384741   0.808589
2          0.117726  0.540066  1.000000  0.276462   0.625178
3          0.390345  0.384741  0.276462  1.000000   0.596279
portfolio  0.354208  0.808589  0.625178  0.596279   1.000000
test
0:  annret:14.592,  sharpe:1.217
1:  annret:-3.903,  sharpe:-0.272
2:  annret:5.205,  sharpe:0.449
3:  annret:11.027,  sharpe:1.061
portfolio:  annret:12.498,  sharpe:1.115
                  0         1         2         3  portfolio
0          1.000000 -0.257112 -0.057543  0.248989   0.132524
1         -0.257112  1.000000  0.347701  0.253815   0.721398
2         -0.057543  0.347701  1.000000  0.312994   0.487010
3          0.248989  0.253815  0.312994  1.000000   0.513625
portfolio  0.132524  0.721398  0.487010  0.513625   1.000000
------------------
0:  annret:7.614,  sharpe:0.371
1:  annret:25.884,  sharpe:1.192
2:  annret:23.067,  sharpe:1.168
3:  annret:14.144,  sharpe:0.695
          0         1         2         3
0  1.000000  0.489754  0.320028  0.341838
1  0.489754  1.000000  0.367195  0.343445
2  0.320028  0.367195  1.000000  0.352619
3  0.341838  0.343445  0.352619  1.000000
Timestep 53000, Reward: 309.67516056768744, TD Loss: 8.01445853725128
test
0:  annret:16.993,  sharpe:1.005
1:  annret:14.220,  sharpe:1.469
2:  annret:7.012,  sharpe:0.543
3:  annret:0.953,  sharpe:0.093
          0         1         2         3
0  1.000000  0.305021 -0.425856  0.403701
1  0.305021  1.000000 -0.256057  0.047942
2 -0.425856 -0.256057  1.000000 -0.087401
3  0.403701  0.047942 -0.087401  1.000000
train
0:  annret:19.040,  sharpe:0.897
1:  annret:30.403,  sharpe:2.027
2:  annret:34.542,  sharpe:1.880
3:  annret:30.901,  sharpe:1.940
portfolio:  annret:53.655,  sharpe:3.449
                  0         1         2         3  portfolio
0          1.000000  0.386455 -0.348395  0.321909   0.248533
1          0.386455  1.000000  0.025816  0.313463   0.605602
2         -0.348395  0.025816  1.000000  0.038887   0.420036
3          0.321909  0.313463  0.038887  1.000000   0.510172
portfolio  0.248533  0.605602  0.420036  0.510172   1.000000
test
0:  annret:16.993,  sharpe:1.005
1:  annret:14.220,  sharpe:1.469
2:  annret:7.012,  sharpe:0.543
3:  annret:0.953,  sharpe:0.093
portfolio:  annret:16.931,  sharpe:1.603
                  0         1         2         3  portfolio
0          1.000000  0.305021 -0.425856  0.403701   0.173017
1          0.305021  1.000000 -0.256057  0.047942   0.320963
2         -0.425856 -0.256057  1.000000 -0.087401   0.311611
3          0.403701  0.047942 -0.087401  1.000000   0.283876
portfolio  0.173017  0.320963  0.311611  0.283876   1.000000
------------------
Timestep 54000, Reward: 309.67516056768744, TD Loss: 18.531286832294537
test
0:  annret:1.037,  sharpe:0.065
1:  annret:1.785,  sharpe:0.183
2:  annret:0.549,  sharpe:0.036
3:  annret:-0.942,  sharpe:-0.075
          0         1         2         3
0  1.000000  0.185220  0.638233  0.746208
1  0.185220  1.000000  0.211996  0.435576
2  0.638233  0.211996  1.000000  0.609267
3  0.746208  0.435576  0.609267  1.000000
train
0:  annret:33.011,  sharpe:1.620
1:  annret:32.334,  sharpe:1.946
2:  annret:41.283,  sharpe:2.034
3:  annret:33.835,  sharpe:1.891
portfolio:  annret:50.809,  sharpe:2.671
                  0         1         2         3  portfolio
0          1.000000  0.397549  0.628066  0.678282   0.840101
1          0.397549  1.000000  0.519138  0.596554   0.658565
2          0.628066  0.519138  1.000000  0.528686   0.802480
3          0.678282  0.596554  0.528686  1.000000   0.786682
portfolio  0.840101  0.658565  0.802480  0.786682   1.000000
test
0:  annret:1.037,  sharpe:0.065
1:  annret:1.785,  sharpe:0.183
2:  annret:0.549,  sharpe:0.036
3:  annret:-0.942,  sharpe:-0.075
portfolio:  annret:7.637,  sharpe:0.539
                  0         1         2         3  portfolio
0          1.000000  0.185220  0.638233  0.746208   0.835899
1          0.185220  1.000000  0.211996  0.435576   0.384288
2          0.638233  0.211996  1.000000  0.609267   0.805189
3          0.746208  0.435576  0.609267  1.000000   0.817054
portfolio  0.835899  0.384288  0.805189  0.817054   1.000000
------------------
0:  annret:22.433,  sharpe:1.095
1:  annret:17.207,  sharpe:0.886
2:  annret:30.063,  sharpe:1.652
3:  annret:26.178,  sharpe:1.338
          0         1         2         3
0  1.000000  0.360318  0.312235  0.390752
1  0.360318  1.000000  0.302133  0.430533
2  0.312235  0.302133  1.000000  0.341010
3  0.390752  0.430533  0.341010  1.000000
Timestep 55000, Reward: 330.09578266092507, TD Loss: 8.228556093166205
test
0:  annret:9.784,  sharpe:0.808
1:  annret:-1.751,  sharpe:-0.094
2:  annret:3.442,  sharpe:0.184
3:  annret:9.010,  sharpe:1.000
          0         1         2         3
0  1.000000  0.231875  0.465304  0.083185
1  0.231875  1.000000  0.644100  0.282357
2  0.465304  0.644100  1.000000  0.421246
3  0.083185  0.282357  0.421246  1.000000
train
0:  annret:33.827,  sharpe:2.038
1:  annret:25.752,  sharpe:1.124
2:  annret:38.956,  sharpe:1.700
3:  annret:30.780,  sharpe:2.087
portfolio:  annret:49.506,  sharpe:2.874
                  0         1         2         3  portfolio
0          1.000000  0.300936  0.282195  0.231534   0.575628
1          0.300936  1.000000  0.668790  0.232545   0.774959
2          0.282195  0.668790  1.000000  0.373050   0.761608
3          0.231534  0.232545  0.373050  1.000000   0.492330
portfolio  0.575628  0.774959  0.761608  0.492330   1.000000
test
0:  annret:9.784,  sharpe:0.808
1:  annret:-1.751,  sharpe:-0.094
2:  annret:3.442,  sharpe:0.184
3:  annret:9.010,  sharpe:1.000
portfolio:  annret:11.403,  sharpe:0.907
                  0         1         2         3  portfolio
0          1.000000  0.231875  0.465304  0.083185   0.554131
1          0.231875  1.000000  0.644100  0.282357   0.709010
2          0.465304  0.644100  1.000000  0.421246   0.801322
3          0.083185  0.282357  0.421246  1.000000   0.449105
portfolio  0.554131  0.709010  0.801322  0.449105   1.000000
------------------
Timestep 56000, Reward: 330.09578266092507, TD Loss: 8.962188407297418
test
0:  annret:13.826,  sharpe:0.908
1:  annret:11.088,  sharpe:0.897
2:  annret:15.448,  sharpe:0.953
3:  annret:10.915,  sharpe:0.948
          0         1         2         3
0  1.000000  0.355695  0.788050 -0.376999
1  0.355695  1.000000  0.328002  0.207470
2  0.788050  0.328002  1.000000 -0.324084
3 -0.376999  0.207470 -0.324084  1.000000
train
0:  annret:30.173,  sharpe:1.508
1:  annret:28.633,  sharpe:1.592
2:  annret:33.013,  sharpe:1.567
3:  annret:35.266,  sharpe:2.051
portfolio:  annret:49.436,  sharpe:3.167
                  0         1         2         3  portfolio
0          1.000000  0.364343  0.735916  0.044645   0.514561
1          0.364343  1.000000  0.303670  0.430666   0.644281
2          0.735916  0.303670  1.000000  0.073705   0.569738
3          0.044645  0.430666  0.073705  1.000000   0.646376
portfolio  0.514561  0.644281  0.569738  0.646376   1.000000
test
0:  annret:13.826,  sharpe:0.908
1:  annret:11.088,  sharpe:0.897
2:  annret:15.448,  sharpe:0.953
3:  annret:10.915,  sharpe:0.948
portfolio:  annret:14.768,  sharpe:1.523
                  0         1         2         3  portfolio
0          1.000000  0.355695  0.788050 -0.376999   0.374290
1          0.355695  1.000000  0.328002  0.207470   0.635378
2          0.788050  0.328002  1.000000 -0.324084   0.289378
3         -0.376999  0.207470 -0.324084  1.000000   0.403463
portfolio  0.374290  0.635378  0.289378  0.403463   1.000000
------------------
0:  annret:13.252,  sharpe:0.632
1:  annret:19.014,  sharpe:0.883
2:  annret:26.822,  sharpe:1.361
3:  annret:28.061,  sharpe:1.464
          0         1         2         3
0  1.000000  0.382407  0.362117  0.267760
1  0.382407  1.000000  0.230415  0.418427
2  0.362117  0.230415  1.000000  0.163535
3  0.267760  0.418427  0.163535  1.000000
Timestep 57000, Reward: 304.19738542167335, TD Loss: 22.674780048668943
test
0:  annret:7.097,  sharpe:0.819
1:  annret:16.986,  sharpe:1.910
2:  annret:12.712,  sharpe:1.046
3:  annret:8.396,  sharpe:0.653
          0         1         2         3
0  1.000000  0.064828  0.208586  0.201807
1  0.064828  1.000000  0.155323  0.102068
2  0.208586  0.155323  1.000000  0.517744
3  0.201807  0.102068  0.517744  1.000000
train
0:  annret:33.705,  sharpe:2.360
1:  annret:34.198,  sharpe:2.379
2:  annret:44.363,  sharpe:2.590
3:  annret:41.954,  sharpe:2.289
portfolio:  annret:59.242,  sharpe:3.627
                  0         1         2         3  portfolio
0          1.000000  0.277429  0.300076  0.372200   0.561424
1          0.277429  1.000000  0.361029  0.331524   0.592056
2          0.300076  0.361029  1.000000  0.481556   0.686583
3          0.372200  0.331524  0.481556  1.000000   0.743458
portfolio  0.561424  0.592056  0.686583  0.743458   1.000000
test
0:  annret:7.097,  sharpe:0.819
1:  annret:16.986,  sharpe:1.910
2:  annret:12.712,  sharpe:1.046
3:  annret:8.396,  sharpe:0.653
portfolio:  annret:19.726,  sharpe:1.776
                  0         1         2         3  portfolio
0          1.000000  0.064828  0.208586  0.201807   0.455341
1          0.064828  1.000000  0.155323  0.102068   0.430476
2          0.208586  0.155323  1.000000  0.517744   0.638449
3          0.201807  0.102068  0.517744  1.000000   0.646042
portfolio  0.455341  0.430476  0.638449  0.646042   1.000000
------------------
Timestep 58000, Reward: 304.19738542167335, TD Loss: 40.28372933863648
test
0:  annret:-1.479,  sharpe:-0.143
1:  annret:-2.872,  sharpe:-0.162
2:  annret:4.212,  sharpe:0.462
3:  annret:-0.138,  sharpe:-0.010
          0         1         2         3
0  1.000000  0.345127  0.136844  0.207833
1  0.345127  1.000000 -0.041692  0.603744
2  0.136844 -0.041692  1.000000  0.252230
3  0.207833  0.603744  0.252230  1.000000
train
0:  annret:23.163,  sharpe:1.404
1:  annret:26.807,  sharpe:1.254
2:  annret:28.222,  sharpe:1.811
3:  annret:34.446,  sharpe:1.811
portfolio:  annret:44.751,  sharpe:2.638
                  0         1         2         3  portfolio
0          1.000000  0.348009  0.394584  0.307117   0.559910
1          0.348009  1.000000  0.326305  0.584639   0.787720
2          0.394584  0.326305  1.000000  0.509327   0.626791
3          0.307117  0.584639  0.509327  1.000000   0.750594
portfolio  0.559910  0.787720  0.626791  0.750594   1.000000
test
0:  annret:-1.479,  sharpe:-0.143
1:  annret:-2.872,  sharpe:-0.162
2:  annret:4.212,  sharpe:0.462
3:  annret:-0.138,  sharpe:-0.010
portfolio:  annret:7.839,  sharpe:0.683
                  0         1         2         3  portfolio
0          1.000000  0.345127  0.136844  0.207833   0.470784
1          0.345127  1.000000 -0.041692  0.603744   0.794006
2          0.136844 -0.041692  1.000000  0.252230   0.242429
3          0.207833  0.603744  0.252230  1.000000   0.713495
portfolio  0.470784  0.794006  0.242429  0.713495   1.000000
------------------
0:  annret:14.482,  sharpe:0.660
1:  annret:15.347,  sharpe:0.748
2:  annret:24.381,  sharpe:1.264
3:  annret:34.521,  sharpe:1.760
          0         1         2         3
0  1.000000  0.266826  0.467682  0.329666
1  0.266826  1.000000  0.052895  0.373518
2  0.467682  0.052895  1.000000  0.212209
3  0.329666  0.373518  0.212209  1.000000
Timestep 59000, Reward: 336.5314332190305, TD Loss: 7.922145903419205
test
0:  annret:12.343,  sharpe:1.202
1:  annret:19.864,  sharpe:1.795
2:  annret:18.151,  sharpe:1.240
3:  annret:11.801,  sharpe:0.812
          0         1         2         3
0  1.000000  0.057413  0.437889 -0.108395
1  0.057413  1.000000 -0.124569  0.296384
2  0.437889 -0.124569  1.000000 -0.563052
3 -0.108395  0.296384 -0.563052  1.000000
train
0:  annret:28.083,  sharpe:1.789
1:  annret:36.717,  sharpe:2.315
2:  annret:34.387,  sharpe:1.908
3:  annret:40.017,  sharpe:2.031
portfolio:  annret:53.895,  sharpe:3.487
                  0         1         2         3  portfolio
0          1.000000  0.195525  0.492861  0.059700   0.455401
1          0.195525  1.000000  0.172868  0.445710   0.662682
2          0.492861  0.172868  1.000000 -0.131374   0.409611
3          0.059700  0.445710 -0.131374  1.000000   0.642662
portfolio  0.455401  0.662682  0.409611  0.642662   1.000000
test
0:  annret:12.343,  sharpe:1.202
1:  annret:19.864,  sharpe:1.795
2:  annret:18.151,  sharpe:1.240
3:  annret:11.801,  sharpe:0.812
portfolio:  annret:20.244,  sharpe:2.117
                  0         1         2         3  portfolio
0          1.000000  0.057413  0.437889 -0.108395   0.347797
1          0.057413  1.000000 -0.124569  0.296384   0.526590
2          0.437889 -0.124569  1.000000 -0.563052   0.048398
3         -0.108395  0.296384 -0.563052  1.000000   0.446334
portfolio  0.347797  0.526590  0.048398  0.446334   1.000000
------------------
Timestep 60000, Reward: 336.5314332190305, TD Loss: 44.14500781918312
test
0:  annret:16.618,  sharpe:0.688
1:  annret:18.497,  sharpe:0.763
2:  annret:14.276,  sharpe:0.599
3:  annret:10.086,  sharpe:0.398
          0         1         2         3
0  1.000000  0.931438  0.951233  0.955221
1  0.931438  1.000000  0.937095  0.945461
2  0.951233  0.937095  1.000000  0.962727
3  0.955221  0.945461  0.962727  1.000000
train
0:  annret:11.044,  sharpe:0.377
1:  annret:10.135,  sharpe:0.359
2:  annret:19.401,  sharpe:0.710
3:  annret:14.858,  sharpe:0.505
portfolio:  annret:19.798,  sharpe:0.741
                  0         1         2         3  portfolio
0          1.000000  0.888449  0.875777  0.879403   0.957224
1          0.888449  1.000000  0.838672  0.852153   0.939250
2          0.875777  0.838672  1.000000  0.817806   0.915069
3          0.879403  0.852153  0.817806  1.000000   0.915925
portfolio  0.957224  0.939250  0.915069  0.915925   1.000000
test
0:  annret:16.618,  sharpe:0.688
1:  annret:18.497,  sharpe:0.763
2:  annret:14.276,  sharpe:0.599
3:  annret:10.086,  sharpe:0.398
portfolio:  annret:16.211,  sharpe:0.720
                  0         1         2         3  portfolio
0          1.000000  0.931438  0.951233  0.955221   0.976272
1          0.931438  1.000000  0.937095  0.945461   0.960071
2          0.951233  0.937095  1.000000  0.962727   0.971332
3          0.955221  0.945461  0.962727  1.000000   0.971354
portfolio  0.976272  0.960071  0.971332  0.971354   1.000000
------------------
0:  annret:11.099,  sharpe:0.501
1:  annret:14.859,  sharpe:0.687
2:  annret:27.977,  sharpe:1.470
3:  annret:24.100,  sharpe:1.205
          0         1         2         3
0  1.000000  0.576965  0.327307  0.261060
1  0.576965  1.000000  0.323603  0.153358
2  0.327307  0.323603  1.000000  0.106756
3  0.261060  0.153358  0.106756  1.000000
Timestep 61000, Reward: 324.9878542710389, TD Loss: 17.316916061052442
test
0:  annret:-1.544,  sharpe:-0.064
1:  annret:-3.822,  sharpe:-0.176
2:  annret:1.540,  sharpe:0.075
3:  annret:10.243,  sharpe:0.476
          0         1         2         3
0  1.000000  0.791175  0.763187  0.870317
1  0.791175  1.000000  0.688419  0.769071
2  0.763187  0.688419  1.000000  0.773846
3  0.870317  0.769071  0.773846  1.000000
train
0:  annret:20.116,  sharpe:0.710
1:  annret:20.034,  sharpe:0.766
2:  annret:30.051,  sharpe:1.202
3:  annret:29.222,  sharpe:1.158
portfolio:  annret:28.545,  sharpe:1.205
                  0         1         2         3  portfolio
0          1.000000  0.762504  0.665841  0.676856   0.880142
1          0.762504  1.000000  0.687427  0.680870   0.889833
2          0.665841  0.687427  1.000000  0.627939   0.820455
3          0.676856  0.680870  0.627939  1.000000   0.813837
portfolio  0.880142  0.889833  0.820455  0.813837   1.000000
test
0:  annret:-1.544,  sharpe:-0.064
1:  annret:-3.822,  sharpe:-0.176
2:  annret:1.540,  sharpe:0.075
3:  annret:10.243,  sharpe:0.476
portfolio:  annret:5.518,  sharpe:0.286
                  0         1         2         3  portfolio
0          1.000000  0.791175  0.763187  0.870317   0.917482
1          0.791175  1.000000  0.688419  0.769071   0.854322
2          0.763187  0.688419  1.000000  0.773846   0.855489
3          0.870317  0.769071  0.773846  1.000000   0.919219
portfolio  0.917482  0.854322  0.855489  0.919219   1.000000
------------------
Timestep 62000, Reward: 324.9878542710389, TD Loss: 6.619212169292125
test
0:  annret:10.133,  sharpe:0.498
1:  annret:16.417,  sharpe:0.801
2:  annret:3.300,  sharpe:0.273
3:  annret:6.887,  sharpe:0.742
          0         1         2         3
0  1.000000  0.801312 -0.444406  0.130029
1  0.801312  1.000000 -0.437268  0.334908
2 -0.444406 -0.437268  1.000000 -0.127750
3  0.130029  0.334908 -0.127750  1.000000
train
0:  annret:20.484,  sharpe:0.810
1:  annret:18.944,  sharpe:0.779
2:  annret:24.390,  sharpe:1.395
3:  annret:37.015,  sharpe:2.334
portfolio:  annret:47.541,  sharpe:3.090
                  0         1         2         3  portfolio
0          1.000000  0.708815 -0.347343  0.160010   0.587690
1          0.708815  1.000000 -0.296585  0.266420   0.627619
2         -0.347343 -0.296585  1.000000 -0.055425   0.115129
3          0.160010  0.266420 -0.055425  1.000000   0.457896
portfolio  0.587690  0.627619  0.115129  0.457896   1.000000
test
0:  annret:10.133,  sharpe:0.498
1:  annret:16.417,  sharpe:0.801
2:  annret:3.300,  sharpe:0.273
3:  annret:6.887,  sharpe:0.742
portfolio:  annret:17.004,  sharpe:1.582
                  0         1         2         3  portfolio
0          1.000000  0.801312 -0.444406  0.130029   0.661184
1          0.801312  1.000000 -0.437268  0.334908   0.647178
2         -0.444406 -0.437268  1.000000 -0.127750  -0.086004
3          0.130029  0.334908 -0.127750  1.000000   0.356205
portfolio  0.661184  0.647178 -0.086004  0.356205   1.000000
------------------
Timestep 63000, Reward: 324.9878542710389, TD Loss: 21.170406986248494
test
0:  annret:-5.340,  sharpe:-0.259
1:  annret:-8.659,  sharpe:-0.383
2:  annret:7.304,  sharpe:0.422
3:  annret:-3.383,  sharpe:-0.157
          0         1         2         3
0  1.000000  0.838588  0.781724  0.885825
1  0.838588  1.000000  0.767471  0.829192
2  0.781724  0.767471  1.000000  0.804755
3  0.885825  0.829192  0.804755  1.000000
train
0:  annret:23.483,  sharpe:0.963
1:  annret:21.578,  sharpe:0.814
2:  annret:36.615,  sharpe:1.689
3:  annret:25.856,  sharpe:1.011
portfolio:  annret:38.447,  sharpe:1.736
                  0         1         2         3  portfolio
0          1.000000  0.775882  0.643647  0.753746   0.857532
1          0.775882  1.000000  0.733856  0.776618   0.909576
2          0.643647  0.733856  1.000000  0.703602   0.818789
3          0.753746  0.776618  0.703602  1.000000   0.872994
portfolio  0.857532  0.909576  0.818789  0.872994   1.000000
test
0:  annret:-5.340,  sharpe:-0.259
1:  annret:-8.659,  sharpe:-0.383
2:  annret:7.304,  sharpe:0.422
3:  annret:-3.383,  sharpe:-0.157
portfolio:  annret:6.802,  sharpe:0.371
                  0         1         2         3  portfolio
0          1.000000  0.838588  0.781724  0.885825   0.917186
1          0.838588  1.000000  0.767471  0.829192   0.895070
2          0.781724  0.767471  1.000000  0.804755   0.857703
3          0.885825  0.829192  0.804755  1.000000   0.924868
portfolio  0.917186  0.895070  0.857703  0.924868   1.000000
------------------
0:  annret:23.329,  sharpe:1.137
1:  annret:21.396,  sharpe:0.963
2:  annret:24.433,  sharpe:1.324
3:  annret:28.659,  sharpe:1.420
          0         1         2         3
0  1.000000  0.521547  0.315038  0.446978
1  0.521547  1.000000  0.439396  0.338958
2  0.315038  0.439396  1.000000  0.314929
3  0.446978  0.338958  0.314929  1.000000
Timestep 64000, Reward: 344.2304219237782, TD Loss: 19.26012517312058
test
0:  annret:6.594,  sharpe:0.695
1:  annret:7.282,  sharpe:0.434
2:  annret:9.940,  sharpe:1.063
3:  annret:-4.675,  sharpe:-0.425
          0         1         2         3
0  1.000000 -0.206574  0.176945  0.272085
1 -0.206574  1.000000  0.404402 -0.333500
2  0.176945  0.404402  1.000000 -0.050839
3  0.272085 -0.333500 -0.050839  1.000000
train
0:  annret:29.279,  sharpe:1.870
1:  annret:28.336,  sharpe:1.372
2:  annret:39.016,  sharpe:2.578
3:  annret:36.175,  sharpe:2.135
portfolio:  annret:55.870,  sharpe:3.555
                  0         1         2         3  portfolio
0          1.000000  0.000227  0.298169  0.357279   0.574464
1          0.000227  1.000000  0.298567 -0.103382   0.330277
2          0.298169  0.298567  1.000000  0.136532   0.540578
3          0.357279 -0.103382  0.136532  1.000000   0.612728
portfolio  0.574464  0.330277  0.540578  0.612728   1.000000
test
0:  annret:6.594,  sharpe:0.695
1:  annret:7.282,  sharpe:0.434
2:  annret:9.940,  sharpe:1.063
3:  annret:-4.675,  sharpe:-0.425
portfolio:  annret:12.988,  sharpe:1.355
                  0         1         2         3  portfolio
0          1.000000 -0.206574  0.176945  0.272085   0.417849
1         -0.206574  1.000000  0.404402 -0.333500   0.050473
2          0.176945  0.404402  1.000000 -0.050839   0.378234
3          0.272085 -0.333500 -0.050839  1.000000   0.588899
portfolio  0.417849  0.050473  0.378234  0.588899   1.000000
------------------
Timestep 65000, Reward: 344.2304219237782, TD Loss: 9.009168897059038
test
0:  annret:13.743,  sharpe:1.161
1:  annret:-0.058,  sharpe:-0.006
2:  annret:16.857,  sharpe:0.958
3:  annret:0.183,  sharpe:0.017
          0         1         2         3
0  1.000000 -0.251798  0.751350 -0.430178
1 -0.251798  1.000000 -0.334627  0.253802
2  0.751350 -0.334627  1.000000 -0.535771
3 -0.430178  0.253802 -0.535771  1.000000
train
0:  annret:27.058,  sharpe:1.561
1:  annret:41.344,  sharpe:2.641
2:  annret:34.967,  sharpe:1.599
3:  annret:36.136,  sharpe:2.227
portfolio:  annret:54.390,  sharpe:3.592
                  0         1         2         3  portfolio
0          1.000000  0.077567  0.724122  0.062196   0.455768
1          0.077567  1.000000  0.040087  0.512111   0.658065
2          0.724122  0.040087  1.000000 -0.040986   0.432064
3          0.062196  0.512111 -0.040986  1.000000   0.610081
portfolio  0.455768  0.658065  0.432064  0.610081   1.000000
test
0:  annret:13.743,  sharpe:1.161
1:  annret:-0.058,  sharpe:-0.006
2:  annret:16.857,  sharpe:0.958
3:  annret:0.183,  sharpe:0.017
portfolio:  annret:13.790,  sharpe:1.668
                  0         1         2         3  portfolio
0          1.000000 -0.251798  0.751350 -0.430178   0.150423
1         -0.251798  1.000000 -0.334627  0.253802   0.467822
2          0.751350 -0.334627  1.000000 -0.535771  -0.026625
3         -0.430178  0.253802 -0.535771  1.000000   0.395793
portfolio  0.150423  0.467822 -0.026625  0.395793   1.000000
------------------
0:  annret:14.852,  sharpe:0.713
1:  annret:20.973,  sharpe:0.959
2:  annret:32.318,  sharpe:1.557
3:  annret:22.154,  sharpe:1.159
          0         1         2         3
0  1.000000  0.321323  0.271405  0.334670
1  0.321323  1.000000  0.451573  0.374033
2  0.271405  0.451573  1.000000  0.241190
3  0.334670  0.374033  0.241190  1.000000
Timestep 66000, Reward: 344.7305097847364, TD Loss: 12.416160046988
test
0:  annret:14.664,  sharpe:0.827
1:  annret:7.005,  sharpe:0.446
2:  annret:12.983,  sharpe:0.720
3:  annret:-1.086,  sharpe:-0.057
          0         1         2         3
0  1.000000 -0.272219  0.749539 -0.708890
1 -0.272219  1.000000 -0.533261  0.511799
2  0.749539 -0.533261  1.000000 -0.749022
3 -0.708890  0.511799 -0.749022  1.000000
train
0:  annret:27.998,  sharpe:1.211
1:  annret:39.128,  sharpe:1.965
2:  annret:35.501,  sharpe:1.577
3:  annret:24.652,  sharpe:1.055
portfolio:  annret:50.962,  sharpe:3.223
                  0         1         2         3  portfolio
0          1.000000 -0.175072  0.727881 -0.457525   0.334300
1         -0.175072  1.000000 -0.272345  0.539129   0.594778
2          0.727881 -0.272345  1.000000 -0.379736   0.347068
3         -0.457525  0.539129 -0.379736  1.000000   0.470683
portfolio  0.334300  0.594778  0.347068  0.470683   1.000000
test
0:  annret:14.664,  sharpe:0.827
1:  annret:7.005,  sharpe:0.446
2:  annret:12.983,  sharpe:0.720
3:  annret:-1.086,  sharpe:-0.057
portfolio:  annret:13.987,  sharpe:1.427
                  0         1         2         3  portfolio
0          1.000000 -0.272219  0.749539 -0.708890   0.086162
1         -0.272219  1.000000 -0.533261  0.511799   0.642125
2          0.749539 -0.533261  1.000000 -0.749022  -0.125380
3         -0.708890  0.511799 -0.749022  1.000000   0.395335
portfolio  0.086162  0.642125 -0.125380  0.395335   1.000000
------------------
Timestep 67000, Reward: 344.7305097847364, TD Loss: 22.774183995956562
test
0:  annret:3.464,  sharpe:0.342
1:  annret:-7.083,  sharpe:-0.418
2:  annret:9.480,  sharpe:0.842
3:  annret:-7.784,  sharpe:-0.455
          0         1         2         3
0  1.000000  0.540566 -0.273960  0.605110
1  0.540566  1.000000 -0.585276  0.726407
2 -0.273960 -0.585276  1.000000 -0.461313
3  0.605110  0.726407 -0.461313  1.000000
train
0:  annret:29.144,  sharpe:1.828
1:  annret:27.753,  sharpe:1.313
2:  annret:37.606,  sharpe:2.162
3:  annret:27.132,  sharpe:1.247
portfolio:  annret:49.638,  sharpe:2.956
                  0         1         2         3  portfolio
0          1.000000  0.553240  0.200933  0.533788   0.697463
1          0.553240  1.000000 -0.027870  0.701457   0.776806
2          0.200933 -0.027870  1.000000  0.057454   0.280499
3          0.533788  0.701457  0.057454  1.000000   0.780257
portfolio  0.697463  0.776806  0.280499  0.780257   1.000000
test
0:  annret:3.464,  sharpe:0.342
1:  annret:-7.083,  sharpe:-0.418
2:  annret:9.480,  sharpe:0.842
3:  annret:-7.784,  sharpe:-0.455
portfolio:  annret:9.969,  sharpe:0.859
                  0         1         2         3  portfolio
0          1.000000  0.540566 -0.273960  0.605110   0.660164
1          0.540566  1.000000 -0.585276  0.726407   0.729582
2         -0.273960 -0.585276  1.000000 -0.461313  -0.311497
3          0.605110  0.726407 -0.461313  1.000000   0.795220
portfolio  0.660164  0.729582 -0.311497  0.795220   1.000000
------------------
0:  annret:22.623,  sharpe:1.058
1:  annret:13.666,  sharpe:0.668
2:  annret:20.496,  sharpe:1.033
3:  annret:17.568,  sharpe:0.905
          0         1         2         3
0  1.000000  0.356711  0.372312  0.325300
1  0.356711  1.000000  0.228491  0.399328
2  0.372312  0.228491  1.000000  0.251276
3  0.325300  0.399328  0.251276  1.000000
Timestep 68000, Reward: 309.67415942247754, TD Loss: 13.959394286132868
test
0:  annret:13.810,  sharpe:1.510
1:  annret:0.429,  sharpe:0.027
2:  annret:7.179,  sharpe:0.666
3:  annret:1.720,  sharpe:0.123
          0         1         2         3
0  1.000000  0.212137  0.017900  0.015314
1  0.212137  1.000000 -0.141819  0.452112
2  0.017900 -0.141819  1.000000  0.057046
3  0.015314  0.452112  0.057046  1.000000
train
0:  annret:32.564,  sharpe:2.300
1:  annret:35.330,  sharpe:1.736
2:  annret:32.610,  sharpe:1.962
3:  annret:29.645,  sharpe:1.594
portfolio:  annret:49.734,  sharpe:3.014
                  0         1         2         3  portfolio
0          1.000000  0.360102  0.097619  0.214330   0.499963
1          0.360102  1.000000  0.081342  0.562572   0.773583
2          0.097619  0.081342  1.000000  0.249263   0.378838
3          0.214330  0.562572  0.249263  1.000000   0.725751
portfolio  0.499963  0.773583  0.378838  0.725751   1.000000
test
0:  annret:13.810,  sharpe:1.510
1:  annret:0.429,  sharpe:0.027
2:  annret:7.179,  sharpe:0.666
3:  annret:1.720,  sharpe:0.123
portfolio:  annret:10.462,  sharpe:0.905
                  0         1         2         3  portfolio
0          1.000000  0.212137  0.017900  0.015314   0.306418
1          0.212137  1.000000 -0.141819  0.452112   0.682541
2          0.017900 -0.141819  1.000000  0.057046   0.097772
3          0.015314  0.452112  0.057046  1.000000   0.668533
portfolio  0.306418  0.682541  0.097772  0.668533   1.000000
------------------
Timestep 69000, Reward: 309.67415942247754, TD Loss: 11.22292301750921
test
0:  annret:12.964,  sharpe:1.211
1:  annret:9.233,  sharpe:0.642
2:  annret:18.995,  sharpe:1.370
3:  annret:1.629,  sharpe:0.105
          0         1         2         3
0  1.000000  0.650442  0.724629  0.589520
1  0.650442  1.000000  0.681713  0.752369
2  0.724629  0.681713  1.000000  0.713589
3  0.589520  0.752369  0.713589  1.000000
train
0:  annret:29.806,  sharpe:1.861
1:  annret:25.986,  sharpe:1.342
2:  annret:38.584,  sharpe:2.006
3:  annret:26.412,  sharpe:1.313
portfolio:  annret:49.348,  sharpe:3.061
                  0         1         2         3  portfolio
0          1.000000  0.640945  0.678266  0.572462   0.656477
1          0.640945  1.000000  0.577579  0.706356   0.713068
2          0.678266  0.577579  1.000000  0.604952   0.668774
3          0.572462  0.706356  0.604952  1.000000   0.552548
portfolio  0.656477  0.713068  0.668774  0.552548   1.000000
test
0:  annret:12.964,  sharpe:1.211
1:  annret:9.233,  sharpe:0.642
2:  annret:18.995,  sharpe:1.370
3:  annret:1.629,  sharpe:0.105
portfolio:  annret:12.750,  sharpe:1.232
                  0         1         2         3  portfolio
0          1.000000  0.650442  0.724629  0.589520   0.548342
1          0.650442  1.000000  0.681713  0.752369   0.628134
2          0.724629  0.681713  1.000000  0.713589   0.465015
3          0.589520  0.752369  0.713589  1.000000   0.439791
portfolio  0.548342  0.628134  0.465015  0.439791   1.000000
------------------
0:  annret:19.446,  sharpe:0.961
1:  annret:24.665,  sharpe:1.098
2:  annret:32.441,  sharpe:1.657
3:  annret:26.789,  sharpe:1.330
          0         1         2         3
0  1.000000  0.378438  0.247140  0.365829
1  0.378438  1.000000  0.320285  0.477890
2  0.247140  0.320285  1.000000  0.271149
3  0.365829  0.477890  0.271149  1.000000
Timestep 70000, Reward: 358.10795501789175, TD Loss: 21.755794350214366
test
0:  annret:8.593,  sharpe:0.836
1:  annret:1.714,  sharpe:0.183
2:  annret:14.338,  sharpe:0.960
3:  annret:8.544,  sharpe:0.653
          0         1         2         3
0  1.000000  0.070465  0.011335  0.217386
1  0.070465  1.000000  0.260410 -0.137101
2  0.011335  0.260410  1.000000 -0.466012
3  0.217386 -0.137101 -0.466012  1.000000
train
0:  annret:23.518,  sharpe:1.630
1:  annret:30.058,  sharpe:1.995
2:  annret:37.140,  sharpe:1.959
3:  annret:25.102,  sharpe:1.449
portfolio:  annret:51.851,  sharpe:3.538
                  0         1         2         3  portfolio
0          1.000000  0.179119  0.083559  0.179907   0.344218
1          0.179119  1.000000  0.346060  0.103948   0.685192
2          0.083559  0.346060  1.000000 -0.114686   0.579637
3          0.179907  0.103948 -0.114686  1.000000   0.220724
portfolio  0.344218  0.685192  0.579637  0.220724   1.000000
test
0:  annret:8.593,  sharpe:0.836
1:  annret:1.714,  sharpe:0.183
2:  annret:14.338,  sharpe:0.960
3:  annret:8.544,  sharpe:0.653
portfolio:  annret:13.387,  sharpe:1.406
                  0         1         2         3  portfolio
0          1.000000  0.070465  0.011335  0.217386   0.237711
1          0.070465  1.000000  0.260410 -0.137101   0.511044
2          0.011335  0.260410  1.000000 -0.466012   0.531083
3          0.217386 -0.137101 -0.466012  1.000000  -0.039219
portfolio  0.237711  0.511044  0.531083 -0.039219   1.000000
------------------
Timestep 71000, Reward: 358.10795501789175, TD Loss: 32.9375401839833
test
0:  annret:13.533,  sharpe:0.665
1:  annret:13.065,  sharpe:0.667
2:  annret:13.488,  sharpe:0.920
3:  annret:4.213,  sharpe:0.263
          0         1         2         3
0  1.000000  0.875367  0.790811  0.822213
1  0.875367  1.000000  0.773192  0.741440
2  0.790811  0.773192  1.000000  0.692310
3  0.822213  0.741440  0.692310  1.000000
train
0:  annret:18.653,  sharpe:0.746
1:  annret:19.107,  sharpe:0.772
2:  annret:36.065,  sharpe:1.773
3:  annret:24.099,  sharpe:1.179
portfolio:  annret:39.203,  sharpe:2.284
                  0         1         2         3  portfolio
0          1.000000  0.812004  0.607101  0.674163   0.697647
1          0.812004  1.000000  0.583705  0.580664   0.759887
2          0.607101  0.583705  1.000000  0.549046   0.757493
3          0.674163  0.580664  0.549046  1.000000   0.613359
portfolio  0.697647  0.759887  0.757493  0.613359   1.000000
test
0:  annret:13.533,  sharpe:0.665
1:  annret:13.065,  sharpe:0.667
2:  annret:13.488,  sharpe:0.920
3:  annret:4.213,  sharpe:0.263
portfolio:  annret:7.841,  sharpe:0.669
                  0         1         2         3  portfolio
0          1.000000  0.875367  0.790811  0.822213   0.693095
1          0.875367  1.000000  0.773192  0.741440   0.751839
2          0.790811  0.773192  1.000000  0.692310   0.735211
3          0.822213  0.741440  0.692310  1.000000   0.609576
portfolio  0.693095  0.751839  0.735211  0.609576   1.000000
------------------
0:  annret:11.820,  sharpe:0.570
1:  annret:16.852,  sharpe:0.777
2:  annret:31.233,  sharpe:1.594
3:  annret:18.697,  sharpe:0.968
          0         1         2         3
0  1.000000  0.448501  0.389184  0.470997
1  0.448501  1.000000  0.351128  0.406631
2  0.389184  0.351128  1.000000  0.328483
3  0.470997  0.406631  0.328483  1.000000
Timestep 72000, Reward: 303.73707138481035, TD Loss: 14.16960883444535
test
0:  annret:7.524,  sharpe:0.788
1:  annret:0.821,  sharpe:0.046
2:  annret:14.966,  sharpe:1.351
3:  annret:8.197,  sharpe:0.722
          0         1         2         3
0  1.000000  0.397817 -0.026086  0.385906
1  0.397817  1.000000 -0.292489  0.432587
2 -0.026086 -0.292489  1.000000 -0.329790
3  0.385906  0.432587 -0.329790  1.000000
train
0:  annret:34.594,  sharpe:2.366
1:  annret:31.572,  sharpe:1.458
2:  annret:38.219,  sharpe:2.265
3:  annret:42.681,  sharpe:2.382
portfolio:  annret:54.702,  sharpe:3.394
                  0         1         2         3  portfolio
0          1.000000  0.463452  0.103654  0.507435   0.678934
1          0.463452  1.000000 -0.075926  0.530942   0.757539
2          0.103654 -0.075926  1.000000  0.049988   0.212535
3          0.507435  0.530942  0.049988  1.000000   0.759599
portfolio  0.678934  0.757539  0.212535  0.759599   1.000000
test
0:  annret:7.524,  sharpe:0.788
1:  annret:0.821,  sharpe:0.046
2:  annret:14.966,  sharpe:1.351
3:  annret:8.197,  sharpe:0.722
portfolio:  annret:14.802,  sharpe:1.438
                  0         1         2         3  portfolio
0          1.000000  0.397817 -0.026086  0.385906   0.559456
1          0.397817  1.000000 -0.292489  0.432587   0.763270
2         -0.026086 -0.292489  1.000000 -0.329790  -0.182792
3          0.385906  0.432587 -0.329790  1.000000   0.646542
portfolio  0.559456  0.763270 -0.182792  0.646542   1.000000
------------------
Timestep 73000, Reward: 303.73707138481035, TD Loss: 19.922174729025414
test
0:  annret:12.565,  sharpe:0.546
1:  annret:9.911,  sharpe:0.460
2:  annret:20.792,  sharpe:0.893
3:  annret:8.519,  sharpe:0.377
          0         1         2         3
0  1.000000  0.840772  0.904256  0.864165
1  0.840772  1.000000  0.879407  0.843574
2  0.904256  0.879407  1.000000  0.879720
3  0.864165  0.843574  0.879720  1.000000
train
0:  annret:20.499,  sharpe:0.734
1:  annret:15.052,  sharpe:0.586
2:  annret:25.443,  sharpe:0.932
3:  annret:27.678,  sharpe:1.059
portfolio:  annret:30.678,  sharpe:1.349
                  0         1         2         3  portfolio
0          1.000000  0.776293  0.820753  0.750852   0.907031
1          0.776293  1.000000  0.750478  0.688309   0.852713
2          0.820753  0.750478  1.000000  0.699709   0.893452
3          0.750852  0.688309  0.699709  1.000000   0.814411
portfolio  0.907031  0.852713  0.893452  0.814411   1.000000
test
0:  annret:12.565,  sharpe:0.546
1:  annret:9.911,  sharpe:0.460
2:  annret:20.792,  sharpe:0.893
3:  annret:8.519,  sharpe:0.377
portfolio:  annret:16.052,  sharpe:0.874
                  0         1         2         3  portfolio
0          1.000000  0.840772  0.904256  0.864165   0.933508
1          0.840772  1.000000  0.879407  0.843574   0.900117
2          0.904256  0.879407  1.000000  0.879720   0.936923
3          0.864165  0.843574  0.879720  1.000000   0.890830
portfolio  0.933508  0.900117  0.936923  0.890830   1.000000
------------------
0:  annret:15.404,  sharpe:0.691
1:  annret:12.747,  sharpe:0.604
2:  annret:32.683,  sharpe:1.668
3:  annret:22.436,  sharpe:1.103
          0         1         2         3
0  1.000000  0.341058  0.373081  0.422669
1  0.341058  1.000000  0.248056  0.252191
2  0.373081  0.248056  1.000000  0.259185
3  0.422669  0.252191  0.259185  1.000000
Timestep 74000, Reward: 337.3125119409357, TD Loss: 25.207494700803753
test
0:  annret:-1.633,  sharpe:-0.074
1:  annret:-3.890,  sharpe:-0.232
2:  annret:1.096,  sharpe:0.061
3:  annret:4.989,  sharpe:0.310
          0         1         2         3
0  1.000000  0.538022  0.694834  0.807083
1  0.538022  1.000000  0.620150  0.542993
2  0.694834  0.620150  1.000000  0.732221
3  0.807083  0.542993  0.732221  1.000000
train
0:  annret:20.667,  sharpe:0.791
1:  annret:30.837,  sharpe:1.485
2:  annret:38.921,  sharpe:1.735
3:  annret:33.928,  sharpe:1.633
portfolio:  annret:43.206,  sharpe:2.175
                  0         1         2         3  portfolio
0          1.000000  0.520497  0.608340  0.621339   0.777308
1          0.520497  1.000000  0.633958  0.586250   0.798713
2          0.608340  0.633958  1.000000  0.637250   0.825083
3          0.621339  0.586250  0.637250  1.000000   0.791133
portfolio  0.777308  0.798713  0.825083  0.791133   1.000000
test
0:  annret:-1.633,  sharpe:-0.074
1:  annret:-3.890,  sharpe:-0.232
2:  annret:1.096,  sharpe:0.061
3:  annret:4.989,  sharpe:0.310
portfolio:  annret:8.751,  sharpe:0.570
                  0         1         2         3  portfolio
0          1.000000  0.538022  0.694834  0.807083   0.844352
1          0.538022  1.000000  0.620150  0.542993   0.712668
2          0.694834  0.620150  1.000000  0.732221   0.841692
3          0.807083  0.542993  0.732221  1.000000   0.856854
portfolio  0.844352  0.712668  0.841692  0.856854   1.000000
------------------
Timestep 75000, Reward: 337.3125119409357, TD Loss: 8.532339787829411
test
0:  annret:8.808,  sharpe:0.734
1:  annret:0.502,  sharpe:0.052
2:  annret:16.257,  sharpe:1.471
3:  annret:13.409,  sharpe:0.866
          0         1         2         3
0  1.000000  0.198574  0.159191  0.567712
1  0.198574  1.000000  0.138151  0.210236
2  0.159191  0.138151  1.000000  0.112717
3  0.567712  0.210236  0.112717  1.000000
train
0:  annret:26.560,  sharpe:1.561
1:  annret:31.112,  sharpe:2.012
2:  annret:37.053,  sharpe:2.248
3:  annret:34.594,  sharpe:1.811
portfolio:  annret:55.122,  sharpe:3.774
                  0         1         2         3  portfolio
0          1.000000  0.250921  0.241301  0.377862   0.450850
1          0.250921  1.000000  0.234807  0.251146   0.583816
2          0.241301  0.234807  1.000000  0.091995   0.494558
3          0.377862  0.251146  0.091995  1.000000   0.469868
portfolio  0.450850  0.583816  0.494558  0.469868   1.000000
test
0:  annret:8.808,  sharpe:0.734
1:  annret:0.502,  sharpe:0.052
2:  annret:16.257,  sharpe:1.471
3:  annret:13.409,  sharpe:0.866
portfolio:  annret:16.641,  sharpe:1.945
                  0         1         2         3  portfolio
0          1.000000  0.198574  0.159191  0.567712   0.306088
1          0.198574  1.000000  0.138151  0.210236   0.335378
2          0.159191  0.138151  1.000000  0.112717   0.216789
3          0.567712  0.210236  0.112717  1.000000   0.322821
portfolio  0.306088  0.335378  0.216789  0.322821   1.000000
------------------
Timestep 76000, Reward: 337.3125119409357, TD Loss: 20.48078174335998
test
0:  annret:-3.808,  sharpe:-0.173
1:  annret:-7.226,  sharpe:-0.690
2:  annret:11.628,  sharpe:0.827
3:  annret:6.168,  sharpe:0.339
          0         1         2         3
0  1.000000  0.387149 -0.648625  0.778594
1  0.387149  1.000000 -0.210994  0.447873
2 -0.648625 -0.210994  1.000000 -0.574889
3  0.778594  0.447873 -0.574889  1.000000
train
0:  annret:22.714,  sharpe:0.880
1:  annret:30.476,  sharpe:1.855
2:  annret:38.967,  sharpe:2.029
3:  annret:28.298,  sharpe:1.252
portfolio:  annret:50.196,  sharpe:2.883
                  0         1         2         3  portfolio
0          1.000000  0.369065 -0.294516  0.612409   0.689182
1          0.369065  1.000000  0.201608  0.529244   0.731623
2         -0.294516  0.201608  1.000000 -0.068693   0.140113
3          0.612409  0.529244 -0.068693  1.000000   0.779883
portfolio  0.689182  0.731623  0.140113  0.779883   1.000000
test
0:  annret:-3.808,  sharpe:-0.173
1:  annret:-7.226,  sharpe:-0.690
2:  annret:11.628,  sharpe:0.827
3:  annret:6.168,  sharpe:0.339
portfolio:  annret:11.771,  sharpe:0.958
                  0         1         2         3  portfolio
0          1.000000  0.387149 -0.648625  0.778594   0.784289
1          0.387149  1.000000 -0.210994  0.447873   0.605931
2         -0.648625 -0.210994  1.000000 -0.574889  -0.362704
3          0.778594  0.447873 -0.574889  1.000000   0.784365
portfolio  0.784289  0.605931 -0.362704  0.784365   1.000000
------------------
0:  annret:20.403,  sharpe:0.933
1:  annret:17.377,  sharpe:0.837
2:  annret:27.088,  sharpe:1.415
3:  annret:26.378,  sharpe:1.319
          0         1         2         3
0  1.000000  0.315674  0.164252  0.344908
1  0.315674  1.000000  0.370437  0.455719
2  0.164252  0.370437  1.000000  0.307665
3  0.344908  0.455719  0.307665  1.000000
Timestep 77000, Reward: 344.7826198849476, TD Loss: 25.226289794980815
test
0:  annret:13.057,  sharpe:0.935
1:  annret:9.611,  sharpe:0.486
2:  annret:17.473,  sharpe:0.776
3:  annret:8.987,  sharpe:0.450
          0         1        2         3
0  1.000000  0.479899  0.66739  0.653925
1  0.479899  1.000000  0.84925  0.806923
2  0.667390  0.849250  1.00000  0.830750
3  0.653925  0.806923  0.83075  1.000000
train
0:  annret:25.183,  sharpe:1.430
1:  annret:20.607,  sharpe:0.854
2:  annret:28.344,  sharpe:1.087
3:  annret:23.439,  sharpe:1.000
portfolio:  annret:45.349,  sharpe:2.593
                  0         1         2         3  portfolio
0          1.000000  0.391054  0.564241  0.521588   0.601271
1          0.391054  1.000000  0.716741  0.667657   0.754305
2          0.564241  0.716741  1.000000  0.646135   0.751036
3          0.521588  0.667657  0.646135  1.000000   0.666894
portfolio  0.601271  0.754305  0.751036  0.666894   1.000000
test
0:  annret:13.057,  sharpe:0.935
1:  annret:9.611,  sharpe:0.486
2:  annret:17.473,  sharpe:0.776
3:  annret:8.987,  sharpe:0.450
portfolio:  annret:19.374,  sharpe:1.573
                  0         1         2         3  portfolio
0          1.000000  0.479899  0.667390  0.653925   0.714997
1          0.479899  1.000000  0.849250  0.806923   0.765777
2          0.667390  0.849250  1.000000  0.830750   0.754165
3          0.653925  0.806923  0.830750  1.000000   0.762093
portfolio  0.714997  0.765777  0.754165  0.762093   1.000000
------------------
Timestep 78000, Reward: 344.7826198849476, TD Loss: 23.20747508796816
test
0:  annret:1.745,  sharpe:0.203
1:  annret:-6.300,  sharpe:-0.326
2:  annret:6.918,  sharpe:0.641
3:  annret:-4.781,  sharpe:-0.552
          0         1         2         3
0  1.000000  0.202925  0.322883 -0.172133
1  0.202925  1.000000  0.134933 -0.162039
2  0.322883  0.134933  1.000000  0.033044
3 -0.172133 -0.162039  0.033044  1.000000
train
0:  annret:33.133,  sharpe:2.180
1:  annret:27.469,  sharpe:1.198
2:  annret:39.473,  sharpe:2.297
3:  annret:21.976,  sharpe:1.460
portfolio:  annret:51.999,  sharpe:3.446
                  0         1         2         3  portfolio
0          1.000000  0.206401  0.544192  0.216134   0.549780
1          0.206401  1.000000  0.222163  0.174522   0.685800
2          0.544192  0.222163  1.000000  0.405758   0.578939
3          0.216134  0.174522  0.405758  1.000000   0.454756
portfolio  0.549780  0.685800  0.578939  0.454756   1.000000
test
0:  annret:1.745,  sharpe:0.203
1:  annret:-6.300,  sharpe:-0.326
2:  annret:6.918,  sharpe:0.641
3:  annret:-4.781,  sharpe:-0.552
portfolio:  annret:14.104,  sharpe:1.438
                  0         1         2         3  portfolio
0          1.000000  0.202925  0.322883 -0.172133   0.393407
1          0.202925  1.000000  0.134933 -0.162039   0.709774
2          0.322883  0.134933  1.000000  0.033044   0.405849
3         -0.172133 -0.162039  0.033044  1.000000  -0.010009
portfolio  0.393407  0.709774  0.405849 -0.010009   1.000000
------------------
0:  annret:19.572,  sharpe:1.000
1:  annret:19.280,  sharpe:0.899
2:  annret:27.040,  sharpe:1.417
3:  annret:17.999,  sharpe:0.890
          0         1         2         3
0  1.000000  0.382749  0.213846  0.415290
1  0.382749  1.000000  0.323724  0.304834
2  0.213846  0.323724  1.000000  0.269390
3  0.415290  0.304834  0.269390  1.000000
Timestep 79000, Reward: 321.8463476400666, TD Loss: 22.391884530195128
test
0:  annret:8.823,  sharpe:0.925
1:  annret:2.097,  sharpe:0.159
2:  annret:0.611,  sharpe:0.053
3:  annret:8.596,  sharpe:0.590
          0         1         2         3
0  1.000000 -0.063808  0.097887  0.104203
1 -0.063808  1.000000  0.202448 -0.452534
2  0.097887  0.202448  1.000000 -0.570014
3  0.104203 -0.452534 -0.570014  1.000000
train
0:  annret:22.097,  sharpe:1.623
1:  annret:33.051,  sharpe:1.832
2:  annret:35.146,  sharpe:2.084
3:  annret:30.140,  sharpe:1.671
portfolio:  annret:55.435,  sharpe:3.839
                  0         1         2         3  portfolio
0          1.000000  0.137008  0.129846  0.263540   0.480443
1          0.137008  1.000000  0.287349 -0.024118   0.627520
2          0.129846  0.287349  1.000000 -0.065043   0.477947
3          0.263540 -0.024118 -0.065043  1.000000   0.313107
portfolio  0.480443  0.627520  0.477947  0.313107   1.000000
test
0:  annret:8.823,  sharpe:0.925
1:  annret:2.097,  sharpe:0.159
2:  annret:0.611,  sharpe:0.053
3:  annret:8.596,  sharpe:0.590
portfolio:  annret:16.882,  sharpe:2.061
                  0         1         2         3  portfolio
0          1.000000 -0.063808  0.097887  0.104203   0.337876
1         -0.063808  1.000000  0.202448 -0.452534   0.518967
2          0.097887  0.202448  1.000000 -0.570014   0.228608
3          0.104203 -0.452534 -0.570014  1.000000  -0.101255
portfolio  0.337876  0.518967  0.228608 -0.101255   1.000000
------------------
Timestep 80000, Reward: 321.8463476400666, TD Loss: 9.484549769298187
test
0:  annret:-3.996,  sharpe:-0.234
1:  annret:14.589,  sharpe:0.799
2:  annret:3.150,  sharpe:0.321
3:  annret:-0.774,  sharpe:-0.061
          0         1         2         3
0  1.000000 -0.768974  0.354724 -0.553679
1 -0.768974  1.000000 -0.133540  0.715879
2  0.354724 -0.133540  1.000000 -0.132017
3 -0.553679  0.715879 -0.132017  1.000000
train
0:  annret:27.230,  sharpe:1.289
1:  annret:22.954,  sharpe:1.038
2:  annret:37.009,  sharpe:2.225
3:  annret:23.109,  sharpe:1.277
portfolio:  annret:52.630,  sharpe:3.391
                  0         1         2         3  portfolio
0          1.000000 -0.435674  0.405984 -0.130847   0.509983
1         -0.435674  1.000000  0.102715  0.625594   0.320622
2          0.405984  0.102715  1.000000  0.378373   0.670810
3         -0.130847  0.625594  0.378373  1.000000   0.453212
portfolio  0.509983  0.320622  0.670810  0.453212   1.000000
test
0:  annret:-3.996,  sharpe:-0.234
1:  annret:14.589,  sharpe:0.799
2:  annret:3.150,  sharpe:0.321
3:  annret:-0.774,  sharpe:-0.061
portfolio:  annret:16.253,  sharpe:1.735
                  0         1         2         3  portfolio
0          1.000000 -0.768974  0.354724 -0.553679   0.396127
1         -0.768974  1.000000 -0.133540  0.715879   0.011072
2          0.354724 -0.133540  1.000000 -0.132017   0.555086
3         -0.553679  0.715879 -0.132017  1.000000   0.040779
portfolio  0.396127  0.011072  0.555086  0.040779   1.000000
------------------
0:  annret:24.534,  sharpe:1.163
1:  annret:14.807,  sharpe:0.654
2:  annret:33.401,  sharpe:1.789
3:  annret:23.012,  sharpe:1.182
          0         1         2         3
0  1.000000  0.186476  0.440399  0.390420
1  0.186476  1.000000  0.196809  0.319263
2  0.440399  0.196809  1.000000  0.396573
3  0.390420  0.319263  0.396573  1.000000
Timestep 81000, Reward: 371.791485991676, TD Loss: 11.342544201742324
test
0:  annret:-1.008,  sharpe:-0.068
1:  annret:6.800,  sharpe:0.427
2:  annret:-6.233,  sharpe:-0.461
3:  annret:15.204,  sharpe:0.921
          0         1         2         3
0  1.000000 -0.377156  0.678608  0.631965
1 -0.377156  1.000000 -0.453897 -0.646351
2  0.678608 -0.453897  1.000000  0.742522
3  0.631965 -0.646351  0.742522  1.000000
train
0:  annret:34.361,  sharpe:1.871
1:  annret:27.257,  sharpe:1.306
2:  annret:32.649,  sharpe:1.738
3:  annret:26.232,  sharpe:1.286
portfolio:  annret:54.283,  sharpe:3.375
                  0         1         2         3  portfolio
0          1.000000 -0.142040  0.537852  0.597440   0.713887
1         -0.142040  1.000000 -0.179689 -0.333438   0.151058
2          0.537852 -0.179689  1.000000  0.609040   0.650278
3          0.597440 -0.333438  0.609040  1.000000   0.665563
portfolio  0.713887  0.151058  0.650278  0.665563   1.000000
test
0:  annret:-1.008,  sharpe:-0.068
1:  annret:6.800,  sharpe:0.427
2:  annret:-6.233,  sharpe:-0.461
3:  annret:15.204,  sharpe:0.921
portfolio:  annret:13.434,  sharpe:1.151
                  0         1         2         3  portfolio
0          1.000000 -0.377156  0.678608  0.631965   0.764591
1         -0.377156  1.000000 -0.453897 -0.646351  -0.227977
2          0.678608 -0.453897  1.000000  0.742522   0.703204
3          0.631965 -0.646351  0.742522  1.000000   0.695937
portfolio  0.764591 -0.227977  0.703204  0.695937   1.000000
------------------
Timestep 82000, Reward: 371.791485991676, TD Loss: 35.88917935303006
test
0:  annret:9.819,  sharpe:0.894
1:  annret:-0.058,  sharpe:-0.005
2:  annret:10.104,  sharpe:0.858
3:  annret:8.429,  sharpe:0.473
          0         1         2         3
0  1.000000  0.242620  0.550466  0.636001
1  0.242620  1.000000  0.251375  0.084513
2  0.550466  0.251375  1.000000  0.701852
3  0.636001  0.084513  0.701852  1.000000
train
0:  annret:28.783,  sharpe:1.701
1:  annret:32.585,  sharpe:1.946
2:  annret:36.225,  sharpe:2.037
3:  annret:25.577,  sharpe:1.163
portfolio:  annret:51.936,  sharpe:3.365
                  0         1         2         3  portfolio
0          1.000000  0.356149  0.437405  0.675530   0.625137
1          0.356149  1.000000  0.264080  0.248476   0.735446
2          0.437405  0.264080  1.000000  0.558602   0.640336
3          0.675530  0.248476  0.558602  1.000000   0.529591
portfolio  0.625137  0.735446  0.640336  0.529591   1.000000
test
0:  annret:9.819,  sharpe:0.894
1:  annret:-0.058,  sharpe:-0.005
2:  annret:10.104,  sharpe:0.858
3:  annret:8.429,  sharpe:0.473
portfolio:  annret:15.546,  sharpe:1.680
                  0         1         2         3  portfolio
0          1.000000  0.242620  0.550466  0.636001   0.502572
1          0.242620  1.000000  0.251375  0.084513   0.711058
2          0.550466  0.251375  1.000000  0.701852   0.568684
3          0.636001  0.084513  0.701852  1.000000   0.322802
portfolio  0.502572  0.711058  0.568684  0.322802   1.000000
------------------
0:  annret:27.382,  sharpe:1.336
1:  annret:21.648,  sharpe:1.053
2:  annret:35.367,  sharpe:1.902
3:  annret:21.421,  sharpe:1.039
          0         1         2         3
0  1.000000  0.438569  0.417628  0.375441
1  0.438569  1.000000  0.291681  0.322532
2  0.417628  0.291681  1.000000  0.339216
3  0.375441  0.322532  0.339216  1.000000
Timestep 83000, Reward: 385.4373462982128, TD Loss: 19.02362694696518
test
0:  annret:13.209,  sharpe:0.751
1:  annret:1.615,  sharpe:0.153
2:  annret:20.512,  sharpe:1.814
3:  annret:6.684,  sharpe:0.373
          0         1         2         3
0  1.000000 -0.275129  0.713393  0.741875
1 -0.275129  1.000000 -0.261074 -0.382745
2  0.713393 -0.261074  1.000000  0.604485
3  0.741875 -0.382745  0.604485  1.000000
train
0:  annret:15.240,  sharpe:0.682
1:  annret:23.879,  sharpe:1.624
2:  annret:38.379,  sharpe:2.371
3:  annret:29.173,  sharpe:1.333
portfolio:  annret:51.732,  sharpe:3.594
                  0         1         2         3  portfolio
0          1.000000 -0.169705  0.531804  0.631541   0.425428
1         -0.169705  1.000000 -0.095049 -0.160940   0.260556
2          0.531804 -0.095049  1.000000  0.490572   0.611538
3          0.631541 -0.160940  0.490572  1.000000   0.539918
portfolio  0.425428  0.260556  0.611538  0.539918   1.000000
test
0:  annret:13.209,  sharpe:0.751
1:  annret:1.615,  sharpe:0.153
2:  annret:20.512,  sharpe:1.814
3:  annret:6.684,  sharpe:0.373
portfolio:  annret:21.463,  sharpe:2.440
                  0         1         2         3  portfolio
0          1.000000 -0.275129  0.713393  0.741875   0.287893
1         -0.275129  1.000000 -0.261074 -0.382745   0.148477
2          0.713393 -0.261074  1.000000  0.604485   0.446903
3          0.741875 -0.382745  0.604485  1.000000   0.326145
portfolio  0.287893  0.148477  0.446903  0.326145   1.000000
------------------
Timestep 84000, Reward: 385.4373462982128, TD Loss: 95.37271995036882
test
0:  annret:12.797,  sharpe:1.078
1:  annret:1.851,  sharpe:0.110
2:  annret:1.052,  sharpe:0.078
3:  annret:6.752,  sharpe:0.340
          0         1         2         3
0  1.000000  0.172487  0.417214  0.121078
1  0.172487  1.000000  0.723696 -0.693602
2  0.417214  0.723696  1.000000 -0.412588
3  0.121078 -0.693602 -0.412588  1.000000
train
0:  annret:34.378,  sharpe:1.988
1:  annret:31.117,  sharpe:1.554
2:  annret:37.669,  sharpe:2.010
3:  annret:25.317,  sharpe:1.101
portfolio:  annret:48.426,  sharpe:2.953
                  0         1         2         3  portfolio
0          1.000000  0.313374  0.522462  0.292912   0.643257
1          0.313374  1.000000  0.636858 -0.383836   0.674426
2          0.522462  0.636858  1.000000 -0.142337   0.854648
3          0.292912 -0.383836 -0.142337  1.000000   0.101229
portfolio  0.643257  0.674426  0.854648  0.101229   1.000000
test
0:  annret:12.797,  sharpe:1.078
1:  annret:1.851,  sharpe:0.110
2:  annret:1.052,  sharpe:0.078
3:  annret:6.752,  sharpe:0.340
portfolio:  annret:10.008,  sharpe:0.963
                  0         1         2         3  portfolio
0          1.000000  0.172487  0.417214  0.121078   0.495550
1          0.172487  1.000000  0.723696 -0.693602   0.683879
2          0.417214  0.723696  1.000000 -0.412588   0.811598
3          0.121078 -0.693602 -0.412588  1.000000  -0.276153
portfolio  0.495550  0.683879  0.811598 -0.276153   1.000000
------------------
0:  annret:14.348,  sharpe:0.702
1:  annret:11.902,  sharpe:0.564
2:  annret:27.168,  sharpe:1.551
3:  annret:19.027,  sharpe:0.903
          0         1         2         3
0  1.000000  0.426445  0.402631  0.403402
1  0.426445  1.000000  0.355268  0.271645
2  0.402631  0.355268  1.000000  0.263528
3  0.403402  0.271645  0.263528  1.000000
Timestep 85000, Reward: 309.7127834616974, TD Loss: 14.698607066038589
test
0:  annret:15.318,  sharpe:0.929
1:  annret:9.888,  sharpe:0.653
2:  annret:9.357,  sharpe:0.789
3:  annret:12.187,  sharpe:0.829
          0         1         2         3
0  1.000000 -0.425226 -0.389260  0.639538
1 -0.425226  1.000000  0.432294 -0.543656
2 -0.389260  0.432294  1.000000 -0.455763
3  0.639538 -0.543656 -0.455763  1.000000
train
0:  annret:24.738,  sharpe:1.189
1:  annret:31.709,  sharpe:1.677
2:  annret:33.965,  sharpe:1.964
3:  annret:27.674,  sharpe:1.413
portfolio:  annret:54.817,  sharpe:3.660
                  0         1         2         3  portfolio
0          1.000000 -0.213625 -0.258330  0.575850   0.313705
1         -0.213625  1.000000  0.232200 -0.171536   0.482072
2         -0.258330  0.232200  1.000000 -0.171868   0.413517
3          0.575850 -0.171536 -0.171868  1.000000   0.459809
portfolio  0.313705  0.482072  0.413517  0.459809   1.000000
test
0:  annret:15.318,  sharpe:0.929
1:  annret:9.888,  sharpe:0.653
2:  annret:9.357,  sharpe:0.789
3:  annret:12.187,  sharpe:0.829
portfolio:  annret:24.152,  sharpe:2.409
                  0         1         2         3  portfolio
0          1.000000 -0.425226 -0.389260  0.639538   0.163542
1         -0.425226  1.000000  0.432294 -0.543656   0.481723
2         -0.389260  0.432294  1.000000 -0.455763   0.426482
3          0.639538 -0.543656 -0.455763  1.000000   0.136169
portfolio  0.163542  0.481723  0.426482  0.136169   1.000000
------------------
Timestep 86000, Reward: 309.7127834616974, TD Loss: 23.928645547827383
test
0:  annret:14.439,  sharpe:0.680
1:  annret:16.510,  sharpe:0.730
2:  annret:19.555,  sharpe:0.943
3:  annret:13.205,  sharpe:0.820
          0         1         2         3
0  1.000000  0.851509  0.879483  0.775101
1  0.851509  1.000000  0.892272  0.741438
2  0.879483  0.892272  1.000000  0.763181
3  0.775101  0.741438  0.763181  1.000000
train
0:  annret:20.586,  sharpe:0.805
1:  annret:7.959,  sharpe:0.295
2:  annret:27.540,  sharpe:1.117
3:  annret:27.065,  sharpe:1.296
portfolio:  annret:39.854,  sharpe:2.043
                  0         1         2         3  portfolio
0          1.000000  0.785305  0.777017  0.672348   0.812785
1          0.785305  1.000000  0.724254  0.656184   0.790910
2          0.777017  0.724254  1.000000  0.608067   0.842621
3          0.672348  0.656184  0.608067  1.000000   0.702311
portfolio  0.812785  0.790910  0.842621  0.702311   1.000000
test
0:  annret:14.439,  sharpe:0.680
1:  annret:16.510,  sharpe:0.730
2:  annret:19.555,  sharpe:0.943
3:  annret:13.205,  sharpe:0.820
portfolio:  annret:22.021,  sharpe:1.529
                  0         1         2         3  portfolio
0          1.000000  0.851509  0.879483  0.775101   0.838630
1          0.851509  1.000000  0.892272  0.741438   0.815336
2          0.879483  0.892272  1.000000  0.763181   0.833413
3          0.775101  0.741438  0.763181  1.000000   0.727111
portfolio  0.838630  0.815336  0.833413  0.727111   1.000000
------------------
0:  annret:15.538,  sharpe:0.679
1:  annret:15.866,  sharpe:0.726
2:  annret:26.926,  sharpe:1.421
3:  annret:30.332,  sharpe:1.429
          0         1         2         3
0  1.000000  0.373602  0.352948  0.416308
1  0.373602  1.000000  0.355090  0.479814
2  0.352948  0.355090  1.000000  0.341162
3  0.416308  0.479814  0.341162  1.000000
Timestep 87000, Reward: 369.5245747044224, TD Loss: 7.576601364371951
test
0:  annret:16.014,  sharpe:0.848
1:  annret:3.637,  sharpe:0.181
2:  annret:13.614,  sharpe:1.470
3:  annret:10.994,  sharpe:0.916
          0         1         2         3
0  1.000000 -0.632351 -0.109382 -0.636453
1 -0.632351  1.000000  0.226107  0.581016
2 -0.109382  0.226107  1.000000  0.313077
3 -0.636453  0.581016  0.313077  1.000000
train
0:  annret:26.121,  sharpe:1.132
1:  annret:36.676,  sharpe:1.586
2:  annret:37.111,  sharpe:2.469
3:  annret:37.545,  sharpe:2.245
portfolio:  annret:53.783,  sharpe:3.626
                  0         1         2         3  portfolio
0          1.000000 -0.498490  0.023371 -0.294808   0.229687
1         -0.498490  1.000000  0.250950  0.623326   0.529980
2          0.023371  0.250950  1.000000  0.398016   0.551766
3         -0.294808  0.623326  0.398016  1.000000   0.611208
portfolio  0.229687  0.529980  0.551766  0.611208   1.000000
test
0:  annret:16.014,  sharpe:0.848
1:  annret:3.637,  sharpe:0.181
2:  annret:13.614,  sharpe:1.470
3:  annret:10.994,  sharpe:0.916
portfolio:  annret:16.653,  sharpe:1.746
                  0         1         2         3  portfolio
0          1.000000 -0.632351 -0.109382 -0.636453   0.032950
1         -0.632351  1.000000  0.226107  0.581016   0.541958
2         -0.109382  0.226107  1.000000  0.313077   0.384062
3         -0.636453  0.581016  0.313077  1.000000   0.390020
portfolio  0.032950  0.541958  0.384062  0.390020   1.000000
------------------
Timestep 88000, Reward: 369.5245747044224, TD Loss: 12.834304898340463
test
0:  annret:12.594,  sharpe:0.540
1:  annret:14.231,  sharpe:0.667
2:  annret:20.460,  sharpe:1.199
3:  annret:3.596,  sharpe:0.201
          0         1         2         3
0  1.000000  0.876633  0.834994  0.854775
1  0.876633  1.000000  0.816957  0.860771
2  0.834994  0.816957  1.000000  0.753605
3  0.854775  0.860771  0.753605  1.000000
train
0:  annret:14.764,  sharpe:0.526
1:  annret:12.709,  sharpe:0.503
2:  annret:34.948,  sharpe:1.601
3:  annret:29.241,  sharpe:1.353
portfolio:  annret:40.706,  sharpe:2.043
                  0         1         2         3  portfolio
0          1.000000  0.818013  0.707144  0.670843   0.813279
1          0.818013  1.000000  0.681901  0.705399   0.826889
2          0.707144  0.681901  1.000000  0.590313   0.817064
3          0.670843  0.705399  0.590313  1.000000   0.748141
portfolio  0.813279  0.826889  0.817064  0.748141   1.000000
test
0:  annret:12.594,  sharpe:0.540
1:  annret:14.231,  sharpe:0.667
2:  annret:20.460,  sharpe:1.199
3:  annret:3.596,  sharpe:0.201
portfolio:  annret:18.825,  sharpe:1.236
                  0         1         2         3  portfolio
0          1.000000  0.876633  0.834994  0.854775   0.859598
1          0.876633  1.000000  0.816957  0.860771   0.853617
2          0.834994  0.816957  1.000000  0.753605   0.849041
3          0.854775  0.860771  0.753605  1.000000   0.840669
portfolio  0.859598  0.853617  0.849041  0.840669   1.000000
------------------
Timestep 89000, Reward: 369.5245747044224, TD Loss: 22.379543003728433
test
0:  annret:14.949,  sharpe:0.694
1:  annret:4.734,  sharpe:0.453
2:  annret:12.305,  sharpe:0.828
3:  annret:7.537,  sharpe:0.384
          0         1         2         3
0  1.000000  0.315391  0.751903  0.857557
1  0.315391  1.000000  0.434465  0.256282
2  0.751903  0.434465  1.000000  0.689134
3  0.857557  0.256282  0.689134  1.000000
train
0:  annret:22.394,  sharpe:0.864
1:  annret:30.120,  sharpe:1.895
2:  annret:32.833,  sharpe:1.655
3:  annret:31.630,  sharpe:1.367
portfolio:  annret:44.552,  sharpe:2.678
                  0         1         2         3  portfolio
0          1.000000  0.343292  0.613478  0.727757   0.674908
1          0.343292  1.000000  0.482821  0.410884   0.680611
2          0.613478  0.482821  1.000000  0.541977   0.659499
3          0.727757  0.410884  0.541977  1.000000   0.738750
portfolio  0.674908  0.680611  0.659499  0.738750   1.000000
test
0:  annret:14.949,  sharpe:0.694
1:  annret:4.734,  sharpe:0.453
2:  annret:12.305,  sharpe:0.828
3:  annret:7.537,  sharpe:0.384
portfolio:  annret:15.700,  sharpe:1.349
                  0         1         2         3  portfolio
0          1.000000  0.315391  0.751903  0.857557   0.693140
1          0.315391  1.000000  0.434465  0.256282   0.589793
2          0.751903  0.434465  1.000000  0.689134   0.621407
3          0.857557  0.256282  0.689134  1.000000   0.714818
portfolio  0.693140  0.589793  0.621407  0.714818   1.000000
------------------
0:  annret:10.826,  sharpe:0.460
1:  annret:14.804,  sharpe:0.683
2:  annret:29.210,  sharpe:1.616
3:  annret:19.444,  sharpe:0.962
          0         1         2         3
0  1.000000  0.413462  0.304336  0.513148
1  0.413462  1.000000  0.393096  0.367665
2  0.304336  0.393096  1.000000  0.374899
3  0.513148  0.367665  0.374899  1.000000
Timestep 90000, Reward: 356.0542903504646, TD Loss: 18.660524170627873
test
0:  annret:10.208,  sharpe:0.615
1:  annret:4.178,  sharpe:0.283
2:  annret:25.062,  sharpe:1.733
3:  annret:9.004,  sharpe:0.570
          0         1         2         3
0  1.000000 -0.424542  0.628543  0.678905
1 -0.424542  1.000000 -0.462582 -0.452448
2  0.628543 -0.462582  1.000000  0.580477
3  0.678905 -0.452448  0.580477  1.000000
train
0:  annret:25.328,  sharpe:1.217
1:  annret:39.616,  sharpe:2.175
2:  annret:38.179,  sharpe:2.033
3:  annret:35.039,  sharpe:1.813
portfolio:  annret:53.209,  sharpe:3.545
                  0         1         2         3  portfolio
0          1.000000 -0.274879  0.555963  0.426664   0.530497
1         -0.274879  1.000000 -0.117312 -0.153198   0.334033
2          0.555963 -0.117312  1.000000  0.313776   0.634054
3          0.426664 -0.153198  0.313776  1.000000   0.547072
portfolio  0.530497  0.334033  0.634054  0.547072   1.000000
test
0:  annret:10.208,  sharpe:0.615
1:  annret:4.178,  sharpe:0.283
2:  annret:25.062,  sharpe:1.733
3:  annret:9.004,  sharpe:0.570
portfolio:  annret:19.239,  sharpe:1.949
                  0         1         2         3  portfolio
0          1.000000 -0.424542  0.628543  0.678905   0.560707
1         -0.424542  1.000000 -0.462582 -0.452448   0.138503
2          0.628543 -0.462582  1.000000  0.580477   0.538870
3          0.678905 -0.452448  0.580477  1.000000   0.582499
portfolio  0.560707  0.138503  0.538870  0.582499   1.000000
------------------
Timestep 91000, Reward: 356.0542903504646, TD Loss: 10.272414240581522
test
0:  annret:8.737,  sharpe:0.519
1:  annret:0.241,  sharpe:0.024
2:  annret:14.777,  sharpe:1.524
3:  annret:3.611,  sharpe:0.221
          0         1         2         3
0  1.000000 -0.107011  0.247710  0.708802
1 -0.107011  1.000000  0.110939  0.100554
2  0.247710  0.110939  1.000000  0.127894
3  0.708802  0.100554  0.127894  1.000000
train
0:  annret:33.297,  sharpe:1.588
1:  annret:40.776,  sharpe:2.442
2:  annret:36.684,  sharpe:2.194
3:  annret:29.172,  sharpe:1.412
portfolio:  annret:53.623,  sharpe:3.463
                  0         1         2         3  portfolio
0          1.000000  0.068389  0.331233  0.614791   0.380266
1          0.068389  1.000000  0.500997  0.325136   0.759823
2          0.331233  0.500997  1.000000  0.267748   0.607877
3          0.614791  0.325136  0.267748  1.000000   0.495761
portfolio  0.380266  0.759823  0.607877  0.495761   1.000000
test
0:  annret:8.737,  sharpe:0.519
1:  annret:0.241,  sharpe:0.024
2:  annret:14.777,  sharpe:1.524
3:  annret:3.611,  sharpe:0.221
portfolio:  annret:16.658,  sharpe:1.767
                  0         1         2         3  portfolio
0          1.000000 -0.107011  0.247710  0.708802   0.134602
1         -0.107011  1.000000  0.110939  0.100554   0.646410
2          0.247710  0.110939  1.000000  0.127894   0.279611
3          0.708802  0.100554  0.127894  1.000000   0.242322
portfolio  0.134602  0.646410  0.279611  0.242322   1.000000
------------------
0:  annret:13.386,  sharpe:0.615
1:  annret:20.785,  sharpe:0.936
2:  annret:27.026,  sharpe:1.388
3:  annret:19.988,  sharpe:0.927
          0         1         2         3
0  1.000000  0.315445  0.417418  0.420656
1  0.315445  1.000000  0.204584  0.453708
2  0.417418  0.204584  1.000000  0.273235
3  0.420656  0.453708  0.273235  1.000000
Timestep 92000, Reward: 370.7463752995852, TD Loss: 5.768723409725576
test
0:  annret:20.057,  sharpe:1.934
1:  annret:-1.279,  sharpe:-0.066
2:  annret:18.034,  sharpe:2.158
3:  annret:13.811,  sharpe:0.633
          0         1         2         3
0  1.000000  0.054019  0.177552 -0.178832
1  0.054019  1.000000  0.047718 -0.662905
2  0.177552  0.047718  1.000000 -0.026806
3 -0.178832 -0.662905 -0.026806  1.000000
train
0:  annret:45.879,  sharpe:2.841
1:  annret:35.761,  sharpe:1.609
2:  annret:37.207,  sharpe:2.599
3:  annret:32.564,  sharpe:1.311
portfolio:  annret:57.876,  sharpe:3.994
                  0         1         2         3  portfolio
0          1.000000  0.186438  0.319233  0.067023   0.667143
1          0.186438  1.000000  0.250420 -0.467575   0.439598
2          0.319233  0.250420  1.000000  0.011751   0.544710
3          0.067023 -0.467575  0.011751  1.000000   0.281478
portfolio  0.667143  0.439598  0.544710  0.281478   1.000000
test
0:  annret:20.057,  sharpe:1.934
1:  annret:-1.279,  sharpe:-0.066
2:  annret:18.034,  sharpe:2.158
3:  annret:13.811,  sharpe:0.633
portfolio:  annret:17.707,  sharpe:2.043
                  0         1         2         3  portfolio
0          1.000000  0.054019  0.177552 -0.178832   0.409898
1          0.054019  1.000000  0.047718 -0.662905   0.334898
2          0.177552  0.047718  1.000000 -0.026806   0.314017
3         -0.178832 -0.662905 -0.026806  1.000000   0.158088
portfolio  0.409898  0.334898  0.314017  0.158088   1.000000
------------------
Timestep 93000, Reward: 370.7463752995852, TD Loss: 10.501663359489159
test
0:  annret:7.579,  sharpe:0.556
1:  annret:-8.143,  sharpe:-0.490
2:  annret:14.952,  sharpe:0.807
3:  annret:7.218,  sharpe:0.390
          0         1         2         3
0  1.000000 -0.340306  0.758012  0.707937
1 -0.340306  1.000000 -0.700382 -0.587959
2  0.758012 -0.700382  1.000000  0.811595
3  0.707937 -0.587959  0.811595  1.000000
train
0:  annret:33.855,  sharpe:1.845
1:  annret:30.633,  sharpe:1.493
2:  annret:30.533,  sharpe:1.374
3:  annret:25.977,  sharpe:1.180
portfolio:  annret:50.865,  sharpe:3.295
                  0         1         2         3  portfolio
0          1.000000 -0.120086  0.696870  0.642240   0.657840
1         -0.120086  1.000000 -0.346855 -0.262675   0.403417
2          0.696870 -0.346855  1.000000  0.641329   0.553534
3          0.642240 -0.262675  0.641329  1.000000   0.521517
portfolio  0.657840  0.403417  0.553534  0.521517   1.000000
test
0:  annret:7.579,  sharpe:0.556
1:  annret:-8.143,  sharpe:-0.490
2:  annret:14.952,  sharpe:0.807
3:  annret:7.218,  sharpe:0.390
portfolio:  annret:12.201,  sharpe:1.294
                  0         1         2         3  portfolio
0          1.000000 -0.340306  0.758012  0.707937   0.609436
1         -0.340306  1.000000 -0.700382 -0.587959   0.233339
2          0.758012 -0.700382  1.000000  0.811595   0.345523
3          0.707937 -0.587959  0.811595  1.000000   0.443228
portfolio  0.609436  0.233339  0.345523  0.443228   1.000000
------------------
0:  annret:19.825,  sharpe:0.989
1:  annret:22.831,  sharpe:1.122
2:  annret:22.660,  sharpe:1.185
3:  annret:20.747,  sharpe:1.020
          0         1         2         3
0  1.000000  0.283830  0.372117  0.444034
1  0.283830  1.000000  0.087135  0.251205
2  0.372117  0.087135  1.000000  0.357798
3  0.444034  0.251205  0.357798  1.000000
Timestep 94000, Reward: 361.1613929194183, TD Loss: 2.653707822026584
test
0:  annret:15.402,  sharpe:0.796
1:  annret:-8.387,  sharpe:-0.349
2:  annret:18.394,  sharpe:1.994
3:  annret:8.639,  sharpe:0.790
          0         1         2         3
0  1.000000 -0.748555  0.321006  0.314357
1 -0.748555  1.000000 -0.392919 -0.477262
2  0.321006 -0.392919  1.000000  0.271552
3  0.314357 -0.477262  0.271552  1.000000
train
0:  annret:26.176,  sharpe:1.071
1:  annret:16.933,  sharpe:0.609
2:  annret:32.789,  sharpe:2.171
3:  annret:22.064,  sharpe:1.384
portfolio:  annret:49.949,  sharpe:3.665
                  0         1         2         3  portfolio
0          1.000000 -0.725194  0.305390  0.354392   0.299246
1         -0.725194  1.000000 -0.174383 -0.269265   0.179203
2          0.305390 -0.174383  1.000000  0.314217   0.531587
3          0.354392 -0.269265  0.314217  1.000000   0.502727
portfolio  0.299246  0.179203  0.531587  0.502727   1.000000
test
0:  annret:15.402,  sharpe:0.796
1:  annret:-8.387,  sharpe:-0.349
2:  annret:18.394,  sharpe:1.994
3:  annret:8.639,  sharpe:0.790
portfolio:  annret:17.139,  sharpe:2.056
                  0         1         2         3  portfolio
0          1.000000 -0.748555  0.321006  0.314357   0.221194
1         -0.748555  1.000000 -0.392919 -0.477262   0.265115
2          0.321006 -0.392919  1.000000  0.271552   0.069889
3          0.314357 -0.477262  0.271552  1.000000   0.073510
portfolio  0.221194  0.265115  0.069889  0.073510   1.000000
------------------
Timestep 95000, Reward: 361.1613929194183, TD Loss: 24.819984712644633
test
0:  annret:15.073,  sharpe:1.201
1:  annret:-2.920,  sharpe:-0.266
2:  annret:7.987,  sharpe:0.557
3:  annret:2.313,  sharpe:0.218
          0         1         2         3
0  1.000000  0.056444  0.715766 -0.460746
1  0.056444  1.000000 -0.170761  0.264618
2  0.715766 -0.170761  1.000000 -0.557406
3 -0.460746  0.264618 -0.557406  1.000000
train
0:  annret:34.894,  sharpe:1.944
1:  annret:32.462,  sharpe:1.923
2:  annret:35.533,  sharpe:1.868
3:  annret:31.051,  sharpe:1.884
portfolio:  annret:50.982,  sharpe:3.451
                  0         1         2         3  portfolio
0          1.000000  0.312160  0.597356  0.096489   0.567774
1          0.312160  1.000000  0.205586  0.527563   0.728470
2          0.597356  0.205586  1.000000  0.112832   0.580553
3          0.096489  0.527563  0.112832  1.000000   0.628617
portfolio  0.567774  0.728470  0.580553  0.628617   1.000000
test
0:  annret:15.073,  sharpe:1.201
1:  annret:-2.920,  sharpe:-0.266
2:  annret:7.987,  sharpe:0.557
3:  annret:2.313,  sharpe:0.218
portfolio:  annret:8.821,  sharpe:1.082
                  0         1         2         3  portfolio
0          1.000000  0.056444  0.715766 -0.460746   0.394014
1          0.056444  1.000000 -0.170761  0.264618   0.616756
2          0.715766 -0.170761  1.000000 -0.557406   0.289786
3         -0.460746  0.264618 -0.557406  1.000000   0.177160
portfolio  0.394014  0.616756  0.289786  0.177160   1.000000
------------------
0:  annret:16.223,  sharpe:0.780
1:  annret:21.352,  sharpe:1.021
2:  annret:21.400,  sharpe:1.039
3:  annret:17.599,  sharpe:0.915
          0         1         2         3
0  1.000000  0.408941  0.456034  0.451666
1  0.408941  1.000000  0.132366  0.317594
2  0.456034  0.132366  1.000000  0.298803
3  0.451666  0.317594  0.298803  1.000000
Timestep 96000, Reward: 353.495311262793, TD Loss: 15.485787475821454
test
0:  annret:10.486,  sharpe:0.618
1:  annret:2.156,  sharpe:0.186
2:  annret:9.787,  sharpe:0.853
3:  annret:10.141,  sharpe:0.692
          0         1         2         3
0  1.000000 -0.384701  0.443338 -0.603672
1 -0.384701  1.000000 -0.289748  0.414725
2  0.443338 -0.289748  1.000000 -0.327674
3 -0.603672  0.414725 -0.327674  1.000000
train
0:  annret:25.971,  sharpe:1.233
1:  annret:31.960,  sharpe:2.073
2:  annret:31.814,  sharpe:1.924
3:  annret:27.191,  sharpe:1.462
portfolio:  annret:49.756,  sharpe:3.577
                  0         1         2         3  portfolio
0          1.000000 -0.202240  0.329024 -0.301974   0.376226
1         -0.202240  1.000000  0.059954  0.479785   0.530983
2          0.329024  0.059954  1.000000 -0.031599   0.430492
3         -0.301974  0.479785 -0.031599  1.000000   0.462544
portfolio  0.376226  0.530983  0.430492  0.462544   1.000000
test
0:  annret:10.486,  sharpe:0.618
1:  annret:2.156,  sharpe:0.186
2:  annret:9.787,  sharpe:0.853
3:  annret:10.141,  sharpe:0.692
portfolio:  annret:14.894,  sharpe:1.797
                  0         1         2         3  portfolio
0          1.000000 -0.384701  0.443338 -0.603672   0.269028
1         -0.384701  1.000000 -0.289748  0.414725   0.384578
2          0.443338 -0.289748  1.000000 -0.327674   0.144589
3         -0.603672  0.414725 -0.327674  1.000000   0.212496
portfolio  0.269028  0.384578  0.144589  0.212496   1.000000
------------------
Timestep 97000, Reward: 353.495311262793, TD Loss: 123.09673014977218
test
0:  annret:0.587,  sharpe:0.030
1:  annret:-5.390,  sharpe:-0.264
2:  annret:2.361,  sharpe:0.231
3:  annret:11.062,  sharpe:1.160
          0         1         2         3
0  1.000000  0.706291 -0.218286 -0.363367
1  0.706291  1.000000 -0.014354 -0.500648
2 -0.218286 -0.014354  1.000000  0.210495
3 -0.363367 -0.500648  0.210495  1.000000
train
0:  annret:19.872,  sharpe:0.826
1:  annret:12.556,  sharpe:0.508
2:  annret:28.650,  sharpe:1.629
3:  annret:34.578,  sharpe:2.129
portfolio:  annret:37.998,  sharpe:2.327
                  0         1         2         3  portfolio
0          1.000000  0.712955  0.075411 -0.191697   0.702496
1          0.712955  1.000000  0.154711 -0.249461   0.717990
2          0.075411  0.154711  1.000000  0.229574   0.480120
3         -0.191697 -0.249461  0.229574  1.000000   0.182657
portfolio  0.702496  0.717990  0.480120  0.182657   1.000000
test
0:  annret:0.587,  sharpe:0.030
1:  annret:-5.390,  sharpe:-0.264
2:  annret:2.361,  sharpe:0.231
3:  annret:11.062,  sharpe:1.160
portfolio:  annret:11.126,  sharpe:1.083
                  0         1         2         3  portfolio
0          1.000000  0.706291 -0.218286 -0.363367   0.679395
1          0.706291  1.000000 -0.014354 -0.500648   0.781101
2         -0.218286 -0.014354  1.000000  0.210495   0.167458
3         -0.363367 -0.500648  0.210495  1.000000  -0.193970
portfolio  0.679395  0.781101  0.167458 -0.193970   1.000000
------------------
0:  annret:19.775,  sharpe:0.963
1:  annret:21.764,  sharpe:1.132
2:  annret:28.560,  sharpe:1.408
3:  annret:18.281,  sharpe:0.964
          0         1         2         3
0  1.000000  0.322026  0.208754  0.211039
1  0.322026  1.000000  0.184138  0.158910
2  0.208754  0.184138  1.000000  0.263202
3  0.211039  0.158910  0.263202  1.000000
Timestep 98000, Reward: 365.52267667926617, TD Loss: 6.044918132239356
test
0:  annret:5.383,  sharpe:0.349
1:  annret:-2.445,  sharpe:-0.150
2:  annret:20.955,  sharpe:1.863
3:  annret:11.468,  sharpe:0.816
          0         1         2         3
0  1.000000  0.596051 -0.329905  0.576148
1  0.596051  1.000000 -0.147846  0.534476
2 -0.329905 -0.147846  1.000000 -0.269965
3  0.576148  0.534476 -0.269965  1.000000
train
0:  annret:35.711,  sharpe:1.794
1:  annret:36.002,  sharpe:1.836
2:  annret:45.842,  sharpe:2.763
3:  annret:39.673,  sharpe:2.107
portfolio:  annret:55.170,  sharpe:3.502
                  0         1         2         3  portfolio
0          1.000000  0.585012  0.007115  0.514735   0.648436
1          0.585012  1.000000  0.089505  0.574456   0.753204
2          0.007115  0.089505  1.000000  0.114503   0.418607
3          0.514735  0.574456  0.114503  1.000000   0.698391
portfolio  0.648436  0.753204  0.418607  0.698391   1.000000
test
0:  annret:5.383,  sharpe:0.349
1:  annret:-2.445,  sharpe:-0.150
2:  annret:20.955,  sharpe:1.863
3:  annret:11.468,  sharpe:0.816
portfolio:  annret:17.478,  sharpe:1.751
                  0         1         2         3  portfolio
0          1.000000  0.596051 -0.329905  0.576148   0.566907
1          0.596051  1.000000 -0.147846  0.534476   0.738384
2         -0.329905 -0.147846  1.000000 -0.269965   0.168694
3          0.576148  0.534476 -0.269965  1.000000   0.578782
portfolio  0.566907  0.738384  0.168694  0.578782   1.000000
------------------
Timestep 99000, Reward: 365.52267667926617, TD Loss: 11.796791476261237
test
0:  annret:18.247,  sharpe:1.085
1:  annret:11.355,  sharpe:0.929
2:  annret:20.248,  sharpe:1.026
3:  annret:17.532,  sharpe:0.796
          0         1         2         3
0  1.000000  0.687019  0.802372  0.774119
1  0.687019  1.000000  0.722632  0.615142
2  0.802372  0.722632  1.000000  0.776035
3  0.774119  0.615142  0.776035  1.000000
train
0:  annret:27.681,  sharpe:1.284
1:  annret:22.695,  sharpe:1.357
2:  annret:31.085,  sharpe:1.282
3:  annret:29.901,  sharpe:1.166
portfolio:  annret:44.701,  sharpe:2.511
                  0         1         2         3  portfolio
0          1.000000  0.572047  0.681751  0.700021   0.799779
1          0.572047  1.000000  0.581476  0.503134   0.684942
2          0.681751  0.581476  1.000000  0.578592   0.763976
3          0.700021  0.503134  0.578592  1.000000   0.732336
portfolio  0.799779  0.684942  0.763976  0.732336   1.000000
test
0:  annret:18.247,  sharpe:1.085
1:  annret:11.355,  sharpe:0.929
2:  annret:20.248,  sharpe:1.026
3:  annret:17.532,  sharpe:0.796
portfolio:  annret:22.755,  sharpe:1.836
                  0         1         2         3  portfolio
0          1.000000  0.687019  0.802372  0.774119   0.800583
1          0.687019  1.000000  0.722632  0.615142   0.715767
2          0.802372  0.722632  1.000000  0.776035   0.783337
3          0.774119  0.615142  0.776035  1.000000   0.772861
portfolio  0.800583  0.715767  0.783337  0.772861   1.000000
------------------
Timestep 100000, Reward: 365.52267667926617, TD Loss: 11.735494646268437
test
0:  annret:-2.181,  sharpe:-0.211
1:  annret:4.130,  sharpe:0.325
2:  annret:11.011,  sharpe:1.275
3:  annret:19.074,  sharpe:1.689
          0         1         2         3
0  1.000000  0.170307  0.309608  0.226962
1  0.170307  1.000000  0.306062  0.338310
2  0.309608  0.306062  1.000000  0.243611
3  0.226962  0.338310  0.243611  1.000000
train
0:  annret:35.559,  sharpe:2.193
1:  annret:39.862,  sharpe:2.371
2:  annret:47.304,  sharpe:2.934
3:  annret:41.348,  sharpe:2.493
portfolio:  annret:55.964,  sharpe:3.638
                  0         1         2         3  portfolio
0          1.000000  0.399306  0.474686  0.405019   0.675579
1          0.399306  1.000000  0.418348  0.440447   0.730200
2          0.474686  0.418348  1.000000  0.430141   0.694200
3          0.405019  0.440447  0.430141  1.000000   0.658377
portfolio  0.675579  0.730200  0.694200  0.658377   1.000000
test
0:  annret:-2.181,  sharpe:-0.211
1:  annret:4.130,  sharpe:0.325
2:  annret:11.011,  sharpe:1.275
3:  annret:19.074,  sharpe:1.689
portfolio:  annret:13.333,  sharpe:1.460
                  0         1         2         3  portfolio
0          1.000000  0.170307  0.309608  0.226962   0.451646
1          0.170307  1.000000  0.306062  0.338310   0.665485
2          0.309608  0.306062  1.000000  0.243611   0.571777
3          0.226962  0.338310  0.243611  1.000000   0.546702
portfolio  0.451646  0.665485  0.571777  0.546702   1.000000
------------------
0:  annret:18.630,  sharpe:0.884
1:  annret:11.854,  sharpe:0.590
2:  annret:28.841,  sharpe:1.454
3:  annret:24.701,  sharpe:1.264
          0         1         2         3
0  1.000000  0.492268  0.380107  0.322126
1  0.492268  1.000000  0.304964  0.204090
2  0.380107  0.304964  1.000000  0.297965
3  0.322126  0.204090  0.297965  1.000000
Timestep 101000, Reward: 348.94752297835913, TD Loss: 13.73087009339006
test
0:  annret:10.140,  sharpe:0.521
1:  annret:10.046,  sharpe:0.516
2:  annret:10.639,  sharpe:0.783
3:  annret:15.798,  sharpe:0.773
          0         1         2         3
0  1.000000  0.748687  0.741207  0.769324
1  0.748687  1.000000  0.679628  0.829760
2  0.741207  0.679628  1.000000  0.592667
3  0.769324  0.829760  0.592667  1.000000
train
0:  annret:24.588,  sharpe:1.034
1:  annret:16.513,  sharpe:0.687
2:  annret:40.732,  sharpe:2.180
3:  annret:29.930,  sharpe:1.232
portfolio:  annret:42.963,  sharpe:2.483
                  0         1         2         3  portfolio
0          1.000000  0.668982  0.595570  0.654546   0.781913
1          0.668982  1.000000  0.483546  0.660727   0.762545
2          0.595570  0.483546  1.000000  0.399640   0.694717
3          0.654546  0.660727  0.399640  1.000000   0.722077
portfolio  0.781913  0.762545  0.694717  0.722077   1.000000
test
0:  annret:10.140,  sharpe:0.521
1:  annret:10.046,  sharpe:0.516
2:  annret:10.639,  sharpe:0.783
3:  annret:15.798,  sharpe:0.773
portfolio:  annret:16.741,  sharpe:1.345
                  0         1         2         3  portfolio
0          1.000000  0.748687  0.741207  0.769324   0.794056
1          0.748687  1.000000  0.679628  0.829760   0.799114
2          0.741207  0.679628  1.000000  0.592667   0.702988
3          0.769324  0.829760  0.592667  1.000000   0.785573
portfolio  0.794056  0.799114  0.702988  0.785573   1.000000
------------------
Timestep 102000, Reward: 348.94752297835913, TD Loss: 28.847452041325745
test
0:  annret:3.712,  sharpe:0.353
1:  annret:-2.668,  sharpe:-0.193
2:  annret:15.942,  sharpe:0.893
3:  annret:0.091,  sharpe:0.008
          0         1         2         3
0  1.000000  0.412849 -0.349515 -0.481479
1  0.412849  1.000000 -0.605990 -0.451149
2 -0.349515 -0.605990  1.000000  0.545035
3 -0.481479 -0.451149  0.545035  1.000000
train
0:  annret:34.385,  sharpe:2.185
1:  annret:32.049,  sharpe:1.748
2:  annret:31.339,  sharpe:1.434
3:  annret:29.632,  sharpe:1.698
portfolio:  annret:55.916,  sharpe:3.689
                  0         1         2         3  portfolio
0          1.000000  0.573079  0.086137  0.123467   0.673547
1          0.573079  1.000000 -0.275036 -0.018338   0.615806
2          0.086137 -0.275036  1.000000  0.401845   0.370561
3          0.123467 -0.018338  0.401845  1.000000   0.374615
portfolio  0.673547  0.615806  0.370561  0.374615   1.000000
test
0:  annret:3.712,  sharpe:0.353
1:  annret:-2.668,  sharpe:-0.193
2:  annret:15.942,  sharpe:0.893
3:  annret:0.091,  sharpe:0.008
portfolio:  annret:15.620,  sharpe:1.827
                  0         1         2         3  portfolio
0          1.000000  0.412849 -0.349515 -0.481479   0.388921
1          0.412849  1.000000 -0.605990 -0.451149   0.554911
2         -0.349515 -0.605990  1.000000  0.545035  -0.067899
3         -0.481479 -0.451149  0.545035  1.000000  -0.013072
portfolio  0.388921  0.554911 -0.067899 -0.013072   1.000000
------------------
0:  annret:31.260,  sharpe:1.516
1:  annret:20.533,  sharpe:0.981
2:  annret:28.240,  sharpe:1.376
3:  annret:26.140,  sharpe:1.312
          0         1         2         3
0  1.000000  0.396379  0.386160  0.414743
1  0.396379  1.000000  0.219994  0.324728
2  0.386160  0.219994  1.000000  0.317202
3  0.414743  0.324728  0.317202  1.000000
Timestep 103000, Reward: 391.6042843268002, TD Loss: 12.574455985581402
test
0:  annret:17.017,  sharpe:0.890
1:  annret:-0.774,  sharpe:-0.059
2:  annret:10.210,  sharpe:0.502
3:  annret:17.533,  sharpe:0.978
          0         1         2         3
0  1.000000  0.534320  0.856659  0.785664
1  0.534320  1.000000  0.601248  0.454083
2  0.856659  0.601248  1.000000  0.746072
3  0.785664  0.454083  0.746072  1.000000
train
0:  annret:26.687,  sharpe:1.126
1:  annret:28.049,  sharpe:1.544
2:  annret:25.447,  sharpe:1.050
3:  annret:29.983,  sharpe:1.383
portfolio:  annret:45.625,  sharpe:2.703
                  0         1         2         3  portfolio
0          1.000000  0.462236  0.750906  0.681505   0.760792
1          0.462236  1.000000  0.532707  0.326310   0.664895
2          0.750906  0.532707  1.000000  0.511049   0.769936
3          0.681505  0.326310  0.511049  1.000000   0.617746
portfolio  0.760792  0.664895  0.769936  0.617746   1.000000
test
0:  annret:17.017,  sharpe:0.890
1:  annret:-0.774,  sharpe:-0.059
2:  annret:10.210,  sharpe:0.502
3:  annret:17.533,  sharpe:0.978
portfolio:  annret:18.250,  sharpe:1.621
                  0         1         2         3  portfolio
0          1.000000  0.534320  0.856659  0.785664   0.815030
1          0.534320  1.000000  0.601248  0.454083   0.651365
2          0.856659  0.601248  1.000000  0.746072   0.768903
3          0.785664  0.454083  0.746072  1.000000   0.727511
portfolio  0.815030  0.651365  0.768903  0.727511   1.000000
------------------
Timestep 104000, Reward: 391.6042843268002, TD Loss: 15.579538199469017
test
0:  annret:8.029,  sharpe:0.791
1:  annret:-8.023,  sharpe:-0.406
2:  annret:10.102,  sharpe:0.946
3:  annret:8.091,  sharpe:0.611
          0         1         2         3
0  1.000000 -0.325823  0.503362  0.408218
1 -0.325823  1.000000 -0.394142 -0.464748
2  0.503362 -0.394142  1.000000  0.363039
3  0.408218 -0.464748  0.363039  1.000000
train
0:  annret:39.466,  sharpe:2.468
1:  annret:31.429,  sharpe:1.324
2:  annret:40.421,  sharpe:2.366
3:  annret:32.186,  sharpe:1.761
portfolio:  annret:53.693,  sharpe:3.516
                  0         1         2         3  portfolio
0          1.000000 -0.036292  0.644117  0.521315   0.587369
1         -0.036292  1.000000 -0.045705 -0.151494   0.602685
2          0.644117 -0.045705  1.000000  0.451228   0.554832
3          0.521315 -0.151494  0.451228  1.000000   0.394450
portfolio  0.587369  0.602685  0.554832  0.394450   1.000000
test
0:  annret:8.029,  sharpe:0.791
1:  annret:-8.023,  sharpe:-0.406
2:  annret:10.102,  sharpe:0.946
3:  annret:8.091,  sharpe:0.611
portfolio:  annret:12.277,  sharpe:1.334
                  0         1         2         3  portfolio
0          1.000000 -0.325823  0.503362  0.408218   0.265218
1         -0.325823  1.000000 -0.394142 -0.464748   0.621101
2          0.503362 -0.394142  1.000000  0.363039   0.104574
3          0.408218 -0.464748  0.363039  1.000000  -0.006626
portfolio  0.265218  0.621101  0.104574 -0.006626   1.000000
------------------
0:  annret:16.444,  sharpe:0.794
1:  annret:18.050,  sharpe:0.886
2:  annret:29.648,  sharpe:1.555
3:  annret:23.239,  sharpe:1.105
          0         1         2         3
0  1.000000  0.297633  0.289862  0.245390
1  0.297633  1.000000  0.236157  0.150762
2  0.289862  0.236157  1.000000  0.371343
3  0.245390  0.150762  0.371343  1.000000
Timestep 105000, Reward: 374.2165719655296, TD Loss: 13.683184674822174
test
0:  annret:15.051,  sharpe:1.104
1:  annret:-1.067,  sharpe:-0.074
2:  annret:7.017,  sharpe:0.823
3:  annret:9.077,  sharpe:0.907
          0         1         2         3
0  1.000000 -0.484932  0.352287  0.174985
1 -0.484932  1.000000 -0.623593 -0.299507
2  0.352287 -0.623593  1.000000  0.185289
3  0.174985 -0.299507  0.185289  1.000000
train
0:  annret:27.292,  sharpe:1.458
1:  annret:25.275,  sharpe:1.434
2:  annret:34.286,  sharpe:2.361
3:  annret:37.307,  sharpe:2.341
portfolio:  annret:56.045,  sharpe:3.880
                  0         1         2         3  portfolio
0          1.000000 -0.178257  0.251444  0.274401   0.350717
1         -0.178257  1.000000 -0.034026  0.092017   0.496743
2          0.251444 -0.034026  1.000000  0.378922   0.418952
3          0.274401  0.092017  0.378922  1.000000   0.557819
portfolio  0.350717  0.496743  0.418952  0.557819   1.000000
test
0:  annret:15.051,  sharpe:1.104
1:  annret:-1.067,  sharpe:-0.074
2:  annret:7.017,  sharpe:0.823
3:  annret:9.077,  sharpe:0.907
portfolio:  annret:15.886,  sharpe:1.857
                  0         1         2         3  portfolio
0          1.000000 -0.484932  0.352287  0.174985   0.079551
1         -0.484932  1.000000 -0.623593 -0.299507   0.411177
2          0.352287 -0.623593  1.000000  0.185289  -0.128530
3          0.174985 -0.299507  0.185289  1.000000   0.183043
portfolio  0.079551  0.411177 -0.128530  0.183043   1.000000
------------------
Timestep 106000, Reward: 374.2165719655296, TD Loss: 15.468990308463162
test
0:  annret:17.322,  sharpe:1.072
1:  annret:0.599,  sharpe:0.061
2:  annret:10.610,  sharpe:0.612
3:  annret:6.684,  sharpe:0.544
          0         1         2         3
0  1.000000  0.009494  0.815721  0.682105
1  0.009494  1.000000 -0.097969  0.169872
2  0.815721 -0.097969  1.000000  0.676769
3  0.682105  0.169872  0.676769  1.000000
train
0:  annret:33.809,  sharpe:1.607
1:  annret:34.091,  sharpe:2.227
2:  annret:37.702,  sharpe:1.759
3:  annret:33.317,  sharpe:1.919
portfolio:  annret:52.841,  sharpe:3.366
                  0         1         2         3  portfolio
0          1.000000  0.249602  0.755231  0.604719   0.619370
1          0.249602  1.000000  0.300793  0.466652   0.687174
2          0.755231  0.300793  1.000000  0.578630   0.676091
3          0.604719  0.466652  0.578630  1.000000   0.606858
portfolio  0.619370  0.687174  0.676091  0.606858   1.000000
test
0:  annret:17.322,  sharpe:1.072
1:  annret:0.599,  sharpe:0.061
2:  annret:10.610,  sharpe:0.612
3:  annret:6.684,  sharpe:0.544
portfolio:  annret:13.925,  sharpe:1.492
                  0         1         2         3  portfolio
0          1.000000  0.009494  0.815721  0.682105   0.547161
1          0.009494  1.000000 -0.097969  0.169872   0.510946
2          0.815721 -0.097969  1.000000  0.676769   0.428911
3          0.682105  0.169872  0.676769  1.000000   0.535914
portfolio  0.547161  0.510946  0.428911  0.535914   1.000000
------------------
0:  annret:19.102,  sharpe:0.922
1:  annret:14.882,  sharpe:0.749
2:  annret:23.479,  sharpe:1.162
3:  annret:25.877,  sharpe:1.275
          0         1         2         3
0  1.000000  0.463371  0.449179  0.482914
1  0.463371  1.000000  0.235908  0.334648
2  0.449179  0.235908  1.000000  0.380654
3  0.482914  0.334648  0.380654  1.000000
Timestep 107000, Reward: 353.5139155845816, TD Loss: 22.900883704475714
test
0:  annret:14.631,  sharpe:1.715
1:  annret:-6.545,  sharpe:-0.323
2:  annret:10.624,  sharpe:0.671
3:  annret:7.361,  sharpe:0.496
          0         1         2         3
0  1.000000  0.150649 -0.031974  0.044875
1  0.150649  1.000000 -0.674833 -0.564414
2 -0.031974 -0.674833  1.000000  0.475685
3  0.044875 -0.564414  0.475685  1.000000
train
0:  annret:32.831,  sharpe:2.461
1:  annret:25.446,  sharpe:1.084
2:  annret:22.377,  sharpe:1.111
3:  annret:30.564,  sharpe:1.609
portfolio:  annret:52.976,  sharpe:3.869
                  0         1         2         3  portfolio
0          1.000000  0.289119 -0.001841  0.162176   0.616324
1          0.289119  1.000000 -0.467269 -0.328325   0.444790
2         -0.001841 -0.467269  1.000000  0.225173   0.230205
3          0.162176 -0.328325  0.225173  1.000000   0.295501
portfolio  0.616324  0.444790  0.230205  0.295501   1.000000
test
0:  annret:14.631,  sharpe:1.715
1:  annret:-6.545,  sharpe:-0.323
2:  annret:10.624,  sharpe:0.671
3:  annret:7.361,  sharpe:0.496
portfolio:  annret:20.549,  sharpe:2.327
                  0         1         2         3  portfolio
0          1.000000  0.150649 -0.031974  0.044875   0.448616
1          0.150649  1.000000 -0.674833 -0.564414   0.400264
2         -0.031974 -0.674833  1.000000  0.475685   0.001237
3          0.044875 -0.564414  0.475685  1.000000   0.211135
portfolio  0.448616  0.400264  0.001237  0.211135   1.000000
------------------
Timestep 108000, Reward: 353.5139155845816, TD Loss: 73.2829284775371
test
0:  annret:2.485,  sharpe:0.200
1:  annret:-1.771,  sharpe:-0.120
2:  annret:2.295,  sharpe:0.225
3:  annret:3.062,  sharpe:0.255
          0         1         2         3
0  1.000000  0.451423  0.630757 -0.236701
1  0.451423  1.000000  0.272640 -0.230129
2  0.630757  0.272640  1.000000 -0.047894
3 -0.236701 -0.230129 -0.047894  1.000000
train
0:  annret:33.877,  sharpe:1.961
1:  annret:32.507,  sharpe:1.741
2:  annret:43.993,  sharpe:2.584
3:  annret:34.629,  sharpe:2.012
portfolio:  annret:55.175,  sharpe:3.318
                  0         1         2         3  portfolio
0          1.000000  0.599061  0.737999  0.227117   0.793142
1          0.599061  1.000000  0.504939  0.208412   0.788545
2          0.737999  0.504939  1.000000  0.377911   0.780494
3          0.227117  0.208412  0.377911  1.000000   0.428069
portfolio  0.793142  0.788545  0.780494  0.428069   1.000000
test
0:  annret:2.485,  sharpe:0.200
1:  annret:-1.771,  sharpe:-0.120
2:  annret:2.295,  sharpe:0.225
3:  annret:3.062,  sharpe:0.255
portfolio:  annret:12.869,  sharpe:1.206
                  0         1         2         3  portfolio
0          1.000000  0.451423  0.630757 -0.236701   0.679713
1          0.451423  1.000000  0.272640 -0.230129   0.726213
2          0.630757  0.272640  1.000000 -0.047894   0.551794
3         -0.236701 -0.230129 -0.047894  1.000000   0.007322
portfolio  0.679713  0.726213  0.551794  0.007322   1.000000
------------------
0:  annret:28.644,  sharpe:1.425
1:  annret:17.332,  sharpe:0.888
2:  annret:28.003,  sharpe:1.437
3:  annret:20.332,  sharpe:0.998
          0         1         2         3
0  1.000000  0.461787  0.503458  0.401563
1  0.461787  1.000000  0.212413  0.250605
2  0.503458  0.212413  1.000000  0.399717
3  0.401563  0.250605  0.399717  1.000000
Timestep 109000, Reward: 369.4554844690495, TD Loss: 8.412183396195363
test
0:  annret:14.736,  sharpe:1.538
1:  annret:9.586,  sharpe:1.057
2:  annret:8.661,  sharpe:0.463
3:  annret:10.548,  sharpe:0.664
          0         1         2         3
0  1.000000  0.217690  0.475315  0.270085
1  0.217690  1.000000  0.570985  0.448554
2  0.475315  0.570985  1.000000  0.652792
3  0.270085  0.448554  0.652792  1.000000
train
0:  annret:33.974,  sharpe:2.286
1:  annret:28.015,  sharpe:1.912
2:  annret:27.781,  sharpe:1.233
3:  annret:35.472,  sharpe:1.755
portfolio:  annret:57.255,  sharpe:3.732
                  0         1         2         3  portfolio
0          1.000000  0.241114  0.520887  0.271790   0.581384
1          0.241114  1.000000  0.452749  0.484868   0.625578
2          0.520887  0.452749  1.000000  0.461136   0.620426
3          0.271790  0.484868  0.461136  1.000000   0.520924
portfolio  0.581384  0.625578  0.620426  0.520924   1.000000
test
0:  annret:14.736,  sharpe:1.538
1:  annret:9.586,  sharpe:1.057
2:  annret:8.661,  sharpe:0.463
3:  annret:10.548,  sharpe:0.664
portfolio:  annret:19.084,  sharpe:2.051
                  0         1         2         3  portfolio
0          1.000000  0.217690  0.475315  0.270085   0.480348
1          0.217690  1.000000  0.570985  0.448554   0.460005
2          0.475315  0.570985  1.000000  0.652792   0.460517
3          0.270085  0.448554  0.652792  1.000000   0.547852
portfolio  0.480348  0.460005  0.460517  0.547852   1.000000
------------------
Timestep 110000, Reward: 369.4554844690495, TD Loss: 52.96748740357424
test
0:  annret:20.221,  sharpe:0.818
1:  annret:17.821,  sharpe:0.756
2:  annret:8.051,  sharpe:0.367
3:  annret:16.713,  sharpe:0.678
          0         1         2         3
0  1.000000  0.934269  0.926963  0.957483
1  0.934269  1.000000  0.918654  0.945570
2  0.926963  0.918654  1.000000  0.918487
3  0.957483  0.945570  0.918487  1.000000
train
0:  annret:16.707,  sharpe:0.564
1:  annret:13.719,  sharpe:0.486
2:  annret:20.294,  sharpe:0.785
3:  annret:21.005,  sharpe:0.744
portfolio:  annret:22.079,  sharpe:0.842
                  0         1         2         3  portfolio
0          1.000000  0.892880  0.812601  0.877622   0.951179
1          0.892880  1.000000  0.775884  0.838661   0.931396
2          0.812601  0.775884  1.000000  0.710327   0.867344
3          0.877622  0.838661  0.710327  1.000000   0.899379
portfolio  0.951179  0.931396  0.867344  0.899379   1.000000
test
0:  annret:20.221,  sharpe:0.818
1:  annret:17.821,  sharpe:0.756
2:  annret:8.051,  sharpe:0.367
3:  annret:16.713,  sharpe:0.678
portfolio:  annret:19.893,  sharpe:0.923
                  0         1         2         3  portfolio
0          1.000000  0.934269  0.926963  0.957483   0.968755
1          0.934269  1.000000  0.918654  0.945570   0.960107
2          0.926963  0.918654  1.000000  0.918487   0.945204
3          0.957483  0.945570  0.918487  1.000000   0.970683
portfolio  0.968755  0.960107  0.945204  0.970683   1.000000
------------------
0:  annret:15.115,  sharpe:0.691
1:  annret:13.988,  sharpe:0.661
2:  annret:28.649,  sharpe:1.424
3:  annret:24.072,  sharpe:1.182
          0         1         2         3
0  1.000000  0.582768  0.506817  0.341562
1  0.582768  1.000000  0.492495  0.319424
2  0.506817  0.492495  1.000000  0.438078
3  0.341562  0.319424  0.438078  1.000000
Timestep 111000, Reward: 360.0359672594957, TD Loss: 9.412606018673682
test
0:  annret:-2.905,  sharpe:-0.122
1:  annret:1.581,  sharpe:0.091
2:  annret:8.375,  sharpe:0.826
3:  annret:-2.016,  sharpe:-0.122
          0         1         2         3
0  1.000000  0.764766 -0.138296  0.818392
1  0.764766  1.000000  0.011316  0.729008
2 -0.138296  0.011316  1.000000 -0.036690
3  0.818392  0.729008 -0.036690  1.000000
train
0:  annret:17.401,  sharpe:0.626
1:  annret:27.553,  sharpe:1.287
2:  annret:51.158,  sharpe:3.146
3:  annret:30.878,  sharpe:1.501
portfolio:  annret:53.593,  sharpe:3.166
                  0         1         2         3  portfolio
0          1.000000  0.690730 -0.032654  0.645747   0.684727
1          0.690730  1.000000  0.217597  0.698582   0.796038
2         -0.032654  0.217597  1.000000  0.199183   0.468301
3          0.645747  0.698582  0.199183  1.000000   0.747796
portfolio  0.684727  0.796038  0.468301  0.747796   1.000000
test
0:  annret:-2.905,  sharpe:-0.122
1:  annret:1.581,  sharpe:0.091
2:  annret:8.375,  sharpe:0.826
3:  annret:-2.016,  sharpe:-0.122
portfolio:  annret:18.138,  sharpe:1.470
                  0         1         2         3  portfolio
0          1.000000  0.764766 -0.138296  0.818392   0.764000
1          0.764766  1.000000  0.011316  0.729008   0.797471
2         -0.138296  0.011316  1.000000 -0.036690   0.214381
3          0.818392  0.729008 -0.036690  1.000000   0.746027
portfolio  0.764000  0.797471  0.214381  0.746027   1.000000
------------------
Timestep 112000, Reward: 360.0359672594957, TD Loss: 5.707725602039166
test
0:  annret:16.939,  sharpe:0.786
1:  annret:10.835,  sharpe:0.593
2:  annret:10.924,  sharpe:0.500
3:  annret:18.861,  sharpe:0.964
          0         1         2         3
0  1.000000  0.722057  0.903928  0.859140
1  0.722057  1.000000  0.767003  0.745433
2  0.903928  0.767003  1.000000  0.825662
3  0.859140  0.745433  0.825662  1.000000
train
0:  annret:22.870,  sharpe:0.873
1:  annret:27.350,  sharpe:1.173
2:  annret:26.473,  sharpe:1.029
3:  annret:35.465,  sharpe:1.539
portfolio:  annret:36.991,  sharpe:1.804
                  0         1         2         3  portfolio
0          1.000000  0.641991  0.801487  0.738924   0.860378
1          0.641991  1.000000  0.628908  0.595385   0.818867
2          0.801487  0.628908  1.000000  0.566275   0.834995
3          0.738924  0.595385  0.566275  1.000000   0.739188
portfolio  0.860378  0.818867  0.834995  0.739188   1.000000
test
0:  annret:16.939,  sharpe:0.786
1:  annret:10.835,  sharpe:0.593
2:  annret:10.924,  sharpe:0.500
3:  annret:18.861,  sharpe:0.964
portfolio:  annret:19.936,  sharpe:1.290
                  0         1         2         3  portfolio
0          1.000000  0.722057  0.903928  0.859140   0.885103
1          0.722057  1.000000  0.767003  0.745433   0.839168
2          0.903928  0.767003  1.000000  0.825662   0.876461
3          0.859140  0.745433  0.825662  1.000000   0.860979
portfolio  0.885103  0.839168  0.876461  0.860979   1.000000
------------------
Timestep 113000, Reward: 360.0359672594957, TD Loss: 18.242011211060692
test
0:  annret:12.065,  sharpe:1.155
1:  annret:-0.857,  sharpe:-0.050
2:  annret:6.715,  sharpe:0.582
3:  annret:7.290,  sharpe:0.754
          0         1         2         3
0  1.000000  0.421044 -0.290262  0.045272
1  0.421044  1.000000 -0.500322  0.112183
2 -0.290262 -0.500322  1.000000 -0.009889
3  0.045272  0.112183 -0.009889  1.000000
train
0:  annret:34.227,  sharpe:2.165
1:  annret:28.338,  sharpe:1.332
2:  annret:37.590,  sharpe:2.176
3:  annret:34.515,  sharpe:2.102
portfolio:  annret:57.909,  sharpe:3.935
                  0         1         2         3  portfolio
0          1.000000  0.466561  0.242540  0.376606   0.637423
1          0.466561  1.000000 -0.077731  0.294946   0.532415
2          0.242540 -0.077731  1.000000  0.413128   0.529260
3          0.376606  0.294946  0.413128  1.000000   0.624627
portfolio  0.637423  0.532415  0.529260  0.624627   1.000000
test
0:  annret:12.065,  sharpe:1.155
1:  annret:-0.857,  sharpe:-0.050
2:  annret:6.715,  sharpe:0.582
3:  annret:7.290,  sharpe:0.754
portfolio:  annret:17.215,  sharpe:2.180
                  0         1         2         3  portfolio
0          1.000000  0.421044 -0.290262  0.045272   0.285656
1          0.421044  1.000000 -0.500322  0.112183   0.446872
2         -0.290262 -0.500322  1.000000 -0.009889   0.036125
3          0.045272  0.112183 -0.009889  1.000000   0.315911
portfolio  0.285656  0.446872  0.036125  0.315911   1.000000
------------------
0:  annret:25.509,  sharpe:1.220
1:  annret:20.414,  sharpe:0.931
2:  annret:27.293,  sharpe:1.429
3:  annret:20.160,  sharpe:1.016
          0         1         2         3
0  1.000000  0.243900  0.363984  0.380355
1  0.243900  1.000000  0.339434  0.281897
2  0.363984  0.339434  1.000000  0.357466
3  0.380355  0.281897  0.357466  1.000000
Timestep 114000, Reward: 380.76586985264714, TD Loss: 8.017454710856526
test
0:  annret:-0.448,  sharpe:-0.032
1:  annret:2.900,  sharpe:0.267
2:  annret:7.036,  sharpe:0.548
3:  annret:0.502,  sharpe:0.039
          0         1         2         3
0  1.000000 -0.074779  0.540505  0.628406
1 -0.074779  1.000000 -0.122394 -0.014554
2  0.540505 -0.122394  1.000000  0.472140
3  0.628406 -0.014554  0.472140  1.000000
train
0:  annret:16.478,  sharpe:0.940
1:  annret:36.603,  sharpe:2.258
2:  annret:42.597,  sharpe:2.528
3:  annret:34.862,  sharpe:2.123
portfolio:  annret:53.522,  sharpe:3.494
                  0         1         2         3  portfolio
0          1.000000 -0.002178  0.353019  0.372044   0.449463
1         -0.002178  1.000000  0.183645  0.192058   0.586809
2          0.353019  0.183645  1.000000  0.285704   0.594978
3          0.372044  0.192058  0.285704  1.000000   0.569979
portfolio  0.449463  0.586809  0.594978  0.569979   1.000000
test
0:  annret:-0.448,  sharpe:-0.032
1:  annret:2.900,  sharpe:0.267
2:  annret:7.036,  sharpe:0.548
3:  annret:0.502,  sharpe:0.039
portfolio:  annret:12.801,  sharpe:1.238
                  0         1         2         3  portfolio
0          1.000000 -0.074779  0.540505  0.628406   0.585808
1         -0.074779  1.000000 -0.122394 -0.014554   0.432338
2          0.540505 -0.122394  1.000000  0.472140   0.466700
3          0.628406 -0.014554  0.472140  1.000000   0.620071
portfolio  0.585808  0.432338  0.466700  0.620071   1.000000
------------------
Timestep 115000, Reward: 380.76586985264714, TD Loss: 5.28897865627684
test
0:  annret:6.797,  sharpe:0.534
1:  annret:-3.671,  sharpe:-0.273
2:  annret:5.691,  sharpe:0.689
3:  annret:10.058,  sharpe:0.799
          0         1         2         3
0  1.000000  0.589103 -0.221663 -0.291918
1  0.589103  1.000000 -0.154199 -0.129750
2 -0.221663 -0.154199  1.000000  0.411882
3 -0.291918 -0.129750  0.411882  1.000000
train
0:  annret:36.864,  sharpe:2.100
1:  annret:32.020,  sharpe:1.829
2:  annret:42.368,  sharpe:2.712
3:  annret:36.423,  sharpe:2.064
portfolio:  annret:57.676,  sharpe:3.689
                  0         1         2         3  portfolio
0          1.000000  0.632383  0.349175  0.133519   0.679674
1          0.632383  1.000000  0.389858  0.213208   0.757450
2          0.349175  0.389858  1.000000  0.473939   0.653226
3          0.133519  0.213208  0.473939  1.000000   0.510490
portfolio  0.679674  0.757450  0.653226  0.510490   1.000000
test
0:  annret:6.797,  sharpe:0.534
1:  annret:-3.671,  sharpe:-0.273
2:  annret:5.691,  sharpe:0.689
3:  annret:10.058,  sharpe:0.799
portfolio:  annret:12.514,  sharpe:1.320
                  0         1         2         3  portfolio
0          1.000000  0.589103 -0.221663 -0.291918   0.495925
1          0.589103  1.000000 -0.154199 -0.129750   0.653764
2         -0.221663 -0.154199  1.000000  0.411882   0.130178
3         -0.291918 -0.129750  0.411882  1.000000   0.240933
portfolio  0.495925  0.653764  0.130178  0.240933   1.000000
------------------
0:  annret:26.812,  sharpe:1.317
1:  annret:14.857,  sharpe:0.718
2:  annret:28.506,  sharpe:1.527
3:  annret:27.490,  sharpe:1.442
          0         1         2         3
0  1.000000  0.383886  0.509420  0.455803
1  0.383886  1.000000  0.393226  0.157556
2  0.509420  0.393226  1.000000  0.304001
3  0.455803  0.157556  0.304001  1.000000
Timestep 116000, Reward: 396.005313149896, TD Loss: 7.432201895554775
test
0:  annret:14.907,  sharpe:1.057
1:  annret:9.743,  sharpe:0.697
2:  annret:12.850,  sharpe:1.126
3:  annret:-0.283,  sharpe:-0.014
          0         1         2         3
0  1.000000  0.476151  0.657514 -0.659564
1  0.476151  1.000000  0.550781 -0.726419
2  0.657514  0.550781  1.000000 -0.624595
3 -0.659564 -0.726419 -0.624595  1.000000
train
0:  annret:32.518,  sharpe:1.740
1:  annret:25.147,  sharpe:1.401
2:  annret:34.355,  sharpe:2.187
3:  annret:30.892,  sharpe:1.350
portfolio:  annret:58.768,  sharpe:3.867
                  0         1         2         3  portfolio
0          1.000000  0.481541  0.515375 -0.362272   0.518190
1          0.481541  1.000000  0.425330 -0.399368   0.450044
2          0.515375  0.425330  1.000000 -0.098625   0.569266
3         -0.362272 -0.399368 -0.098625  1.000000   0.258717
portfolio  0.518190  0.450044  0.569266  0.258717   1.000000
test
0:  annret:14.907,  sharpe:1.057
1:  annret:9.743,  sharpe:0.697
2:  annret:12.850,  sharpe:1.126
3:  annret:-0.283,  sharpe:-0.014
portfolio:  annret:16.751,  sharpe:1.908
                  0         1         2         3  portfolio
0          1.000000  0.476151  0.657514 -0.659564   0.467481
1          0.476151  1.000000  0.550781 -0.726419   0.313785
2          0.657514  0.550781  1.000000 -0.624595   0.343007
3         -0.659564 -0.726419 -0.624595  1.000000  -0.105238
portfolio  0.467481  0.313785  0.343007 -0.105238   1.000000
------------------
Timestep 117000, Reward: 396.005313149896, TD Loss: 19.934462757796695
test
0:  annret:1.522,  sharpe:0.133
1:  annret:7.451,  sharpe:0.455
2:  annret:12.379,  sharpe:0.929
3:  annret:4.135,  sharpe:0.504
          0         1         2         3
0  1.000000 -0.500063 -0.399512  0.163212
1 -0.500063  1.000000  0.748458 -0.003810
2 -0.399512  0.748458  1.000000 -0.180378
3  0.163212 -0.003810 -0.180378  1.000000
train
0:  annret:37.312,  sharpe:2.108
1:  annret:28.162,  sharpe:1.372
2:  annret:45.432,  sharpe:2.440
3:  annret:33.872,  sharpe:2.244
portfolio:  annret:61.062,  sharpe:3.836
                  0         1         2         3  portfolio
0          1.000000 -0.174001  0.080529  0.377521   0.541518
1         -0.174001  1.000000  0.667679  0.337448   0.450183
2          0.080529  0.667679  1.000000  0.419900   0.590418
3          0.377521  0.337448  0.419900  1.000000   0.710098
portfolio  0.541518  0.450183  0.590418  0.710098   1.000000
test
0:  annret:1.522,  sharpe:0.133
1:  annret:7.451,  sharpe:0.455
2:  annret:12.379,  sharpe:0.929
3:  annret:4.135,  sharpe:0.504
portfolio:  annret:11.136,  sharpe:1.257
                  0         1         2         3  portfolio
0          1.000000 -0.500063 -0.399512  0.163212   0.437345
1         -0.500063  1.000000  0.748458 -0.003810   0.156178
2         -0.399512  0.748458  1.000000 -0.180378   0.156142
3          0.163212 -0.003810 -0.180378  1.000000   0.421784
portfolio  0.437345  0.156178  0.156142  0.421784   1.000000
------------------
0:  annret:21.917,  sharpe:1.137
1:  annret:11.078,  sharpe:0.547
2:  annret:22.511,  sharpe:1.127
3:  annret:19.815,  sharpe:1.035
          0         1         2         3
0  1.000000  0.426045  0.441719  0.390758
1  0.426045  1.000000  0.481740  0.308084
2  0.441719  0.481740  1.000000  0.357402
3  0.390758  0.308084  0.357402  1.000000
Timestep 118000, Reward: 352.8251498519371, TD Loss: 11.7051092455855
test
0:  annret:24.294,  sharpe:2.184
1:  annret:-3.619,  sharpe:-0.188
2:  annret:7.371,  sharpe:0.822
3:  annret:3.493,  sharpe:0.297
          0         1         2         3
0  1.000000 -0.124440  0.157769 -0.038700
1 -0.124440  1.000000 -0.209302  0.652098
2  0.157769 -0.209302  1.000000 -0.138774
3 -0.038700  0.652098 -0.138774  1.000000
train
0:  annret:45.697,  sharpe:2.801
1:  annret:28.617,  sharpe:1.250
2:  annret:42.113,  sharpe:2.719
3:  annret:36.952,  sharpe:2.162
portfolio:  annret:62.191,  sharpe:4.053
                  0         1         2         3  portfolio
0          1.000000  0.019997  0.450785  0.259260   0.604782
1          0.019997  1.000000 -0.002925  0.629339   0.571302
2          0.450785 -0.002925  1.000000  0.284932   0.512438
3          0.259260  0.629339  0.284932  1.000000   0.676482
portfolio  0.604782  0.571302  0.512438  0.676482   1.000000
test
0:  annret:24.294,  sharpe:2.184
1:  annret:-3.619,  sharpe:-0.188
2:  annret:7.371,  sharpe:0.822
3:  annret:3.493,  sharpe:0.297
portfolio:  annret:14.986,  sharpe:1.648
                  0         1         2         3  portfolio
0          1.000000 -0.124440  0.157769 -0.038700   0.251991
1         -0.124440  1.000000 -0.209302  0.652098   0.635263
2          0.157769 -0.209302  1.000000 -0.138774   0.013926
3         -0.038700  0.652098 -0.138774  1.000000   0.543675
portfolio  0.251991  0.635263  0.013926  0.543675   1.000000
------------------
Timestep 119000, Reward: 352.8251498519371, TD Loss: 14.348431238088693
test
0:  annret:-0.218,  sharpe:-0.021
1:  annret:11.874,  sharpe:0.569
2:  annret:14.126,  sharpe:0.755
3:  annret:-2.901,  sharpe:-0.242
          0         1         2         3
0  1.000000  0.531526  0.500260 -0.162538
1  0.531526  1.000000  0.888865 -0.582299
2  0.500260  0.888865  1.000000 -0.600067
3 -0.162538 -0.582299 -0.600067  1.000000
train
0:  annret:35.085,  sharpe:2.317
1:  annret:19.729,  sharpe:0.789
2:  annret:31.319,  sharpe:1.348
3:  annret:34.326,  sharpe:1.939
portfolio:  annret:50.672,  sharpe:3.068
                  0         1         2         3  portfolio
0          1.000000  0.413747  0.377788  0.291646   0.657846
1          0.413747  1.000000  0.721282 -0.265987   0.640736
2          0.377788  0.721282  1.000000 -0.119287   0.701122
3          0.291646 -0.265987 -0.119287  1.000000   0.340112
portfolio  0.657846  0.640736  0.701122  0.340112   1.000000
test
0:  annret:-0.218,  sharpe:-0.021
1:  annret:11.874,  sharpe:0.569
2:  annret:14.126,  sharpe:0.755
3:  annret:-2.901,  sharpe:-0.242
portfolio:  annret:12.020,  sharpe:1.145
                  0         1         2         3  portfolio
0          1.000000  0.531526  0.500260 -0.162538   0.651070
1          0.531526  1.000000  0.888865 -0.582299   0.702864
2          0.500260  0.888865  1.000000 -0.600067   0.649404
3         -0.162538 -0.582299 -0.600067  1.000000  -0.072885
portfolio  0.651070  0.702864  0.649404 -0.072885   1.000000
------------------
0:  annret:20.764,  sharpe:1.061
1:  annret:18.076,  sharpe:0.815
2:  annret:26.555,  sharpe:1.360
3:  annret:31.205,  sharpe:1.490
          0         1         2         3
0  1.000000  0.295406  0.266724  0.354490
1  0.295406  1.000000  0.478174  0.061917
2  0.266724  0.478174  1.000000  0.280854
3  0.354490  0.061917  0.280854  1.000000
Timestep 120000, Reward: 370.0101546735764, TD Loss: 18.71910309272912
test
0:  annret:0.434,  sharpe:0.041
1:  annret:2.587,  sharpe:0.218
2:  annret:14.360,  sharpe:0.758
3:  annret:5.937,  sharpe:0.332
          0         1         2         3
0  1.000000 -0.065411 -0.300263  0.008947
1 -0.065411  1.000000  0.570014  0.524221
2 -0.300263  0.570014  1.000000  0.679974
3  0.008947  0.524221  0.679974  1.000000
train
0:  annret:31.070,  sharpe:1.995
1:  annret:36.408,  sharpe:2.147
2:  annret:31.392,  sharpe:1.366
3:  annret:42.129,  sharpe:1.959
portfolio:  annret:60.380,  sharpe:3.842
                  0         1         2         3  portfolio
0          1.000000  0.141674 -0.253823  0.228407   0.428262
1          0.141674  1.000000  0.527704  0.541194   0.722009
2         -0.253823  0.527704  1.000000  0.500389   0.481472
3          0.228407  0.541194  0.500389  1.000000   0.587087
portfolio  0.428262  0.722009  0.481472  0.587087   1.000000
test
0:  annret:0.434,  sharpe:0.041
1:  annret:2.587,  sharpe:0.218
2:  annret:14.360,  sharpe:0.758
3:  annret:5.937,  sharpe:0.332
portfolio:  annret:14.175,  sharpe:1.459
                  0         1         2         3  portfolio
0          1.000000 -0.065411 -0.300263  0.008947   0.393903
1         -0.065411  1.000000  0.570014  0.524221   0.595014
2         -0.300263  0.570014  1.000000  0.679974   0.359104
3          0.008947  0.524221  0.679974  1.000000   0.506710
portfolio  0.393903  0.595014  0.359104  0.506710   1.000000
------------------
Timestep 121000, Reward: 370.0101546735764, TD Loss: 58.07544803972743
test
0:  annret:22.117,  sharpe:1.012
1:  annret:12.028,  sharpe:0.662
2:  annret:6.355,  sharpe:0.518
3:  annret:1.876,  sharpe:0.116
          0         1         2         3
0  1.000000  0.839761  0.686660  0.735800
1  0.839761  1.000000  0.736397  0.671643
2  0.686660  0.736397  1.000000  0.667000
3  0.735800  0.671643  0.667000  1.000000
train
0:  annret:21.578,  sharpe:0.802
1:  annret:21.036,  sharpe:0.923
2:  annret:33.727,  sharpe:1.812
3:  annret:30.878,  sharpe:1.510
portfolio:  annret:43.038,  sharpe:2.542
                  0         1         2         3  portfolio
0          1.000000  0.809012  0.462402  0.575269   0.711848
1          0.809012  1.000000  0.504902  0.534405   0.750089
2          0.462402  0.504902  1.000000  0.500030   0.680819
3          0.575269  0.534405  0.500030  1.000000   0.665953
portfolio  0.711848  0.750089  0.680819  0.665953   1.000000
test
0:  annret:22.117,  sharpe:1.012
1:  annret:12.028,  sharpe:0.662
2:  annret:6.355,  sharpe:0.518
3:  annret:1.876,  sharpe:0.116
portfolio:  annret:9.080,  sharpe:0.821
                  0         1         2         3  portfolio
0          1.000000  0.839761  0.686660  0.735800   0.713764
1          0.839761  1.000000  0.736397  0.671643   0.746481
2          0.686660  0.736397  1.000000  0.667000   0.693371
3          0.735800  0.671643  0.667000  1.000000   0.712629
portfolio  0.713764  0.746481  0.693371  0.712629   1.000000
------------------
0:  annret:15.580,  sharpe:0.754
1:  annret:11.305,  sharpe:0.545
2:  annret:28.404,  sharpe:1.408
3:  annret:25.955,  sharpe:1.246
          0         1         2         3
0  1.000000  0.492260  0.328440  0.305687
1  0.492260  1.000000  0.426005  0.304447
2  0.328440  0.426005  1.000000  0.490997
3  0.305687  0.304447  0.490997  1.000000
Timestep 122000, Reward: 355.5407886854017, TD Loss: 18.843400118478584
test
0:  annret:15.182,  sharpe:1.349
1:  annret:2.757,  sharpe:0.198
2:  annret:12.079,  sharpe:1.044
3:  annret:7.245,  sharpe:0.431
          0         1         2         3
0  1.000000  0.440374  0.577161  0.586661
1  0.440374  1.000000  0.459480  0.545981
2  0.577161  0.459480  1.000000  0.413170
3  0.586661  0.545981  0.413170  1.000000
train
0:  annret:36.143,  sharpe:2.249
1:  annret:31.334,  sharpe:1.626
2:  annret:32.619,  sharpe:2.032
3:  annret:38.225,  sharpe:1.855
portfolio:  annret:57.566,  sharpe:3.687
                  0         1         2         3  portfolio
0          1.000000  0.424929  0.381377  0.621486   0.650236
1          0.424929  1.000000  0.428008  0.524799   0.624001
2          0.381377  0.428008  1.000000  0.328406   0.504335
3          0.621486  0.524799  0.328406  1.000000   0.661721
portfolio  0.650236  0.624001  0.504335  0.661721   1.000000
test
0:  annret:15.182,  sharpe:1.349
1:  annret:2.757,  sharpe:0.198
2:  annret:12.079,  sharpe:1.044
3:  annret:7.245,  sharpe:0.431
portfolio:  annret:16.838,  sharpe:1.736
                  0         1         2         3  portfolio
0          1.000000  0.440374  0.577161  0.586661   0.659242
1          0.440374  1.000000  0.459480  0.545981   0.511953
2          0.577161  0.459480  1.000000  0.413170   0.436554
3          0.586661  0.545981  0.413170  1.000000   0.592014
portfolio  0.659242  0.511953  0.436554  0.592014   1.000000
------------------
Timestep 123000, Reward: 355.5407886854017, TD Loss: 21.825642550249842
test
0:  annret:22.130,  sharpe:0.972
1:  annret:17.284,  sharpe:0.750
2:  annret:15.344,  sharpe:0.690
3:  annret:12.936,  sharpe:0.587
          0         1         2         3
0  1.000000  0.871697  0.904949  0.878598
1  0.871697  1.000000  0.906680  0.895842
2  0.904949  0.906680  1.000000  0.856313
3  0.878598  0.895842  0.856313  1.000000
train
0:  annret:23.973,  sharpe:0.863
1:  annret:22.108,  sharpe:0.802
2:  annret:30.285,  sharpe:1.179
3:  annret:34.226,  sharpe:1.342
portfolio:  annret:33.588,  sharpe:1.424
                  0         1         2         3  portfolio
0          1.000000  0.830889  0.787009  0.763970   0.909542
1          0.830889  1.000000  0.766537  0.757043   0.909527
2          0.787009  0.766537  1.000000  0.647997   0.866378
3          0.763970  0.757043  0.647997  1.000000   0.840526
portfolio  0.909542  0.909527  0.866378  0.840526   1.000000
test
0:  annret:22.130,  sharpe:0.972
1:  annret:17.284,  sharpe:0.750
2:  annret:15.344,  sharpe:0.690
3:  annret:12.936,  sharpe:0.587
portfolio:  annret:20.338,  sharpe:1.059
                  0         1         2         3  portfolio
0          1.000000  0.871697  0.904949  0.878598   0.936968
1          0.871697  1.000000  0.906680  0.895842   0.935007
2          0.904949  0.906680  1.000000  0.856313   0.930590
3          0.878598  0.895842  0.856313  1.000000   0.922510
portfolio  0.936968  0.935007  0.930590  0.922510   1.000000
------------------
0:  annret:19.461,  sharpe:0.926
1:  annret:17.810,  sharpe:0.849
2:  annret:26.688,  sharpe:1.356
3:  annret:23.668,  sharpe:1.128
          0         1         2         3
0  1.000000  0.516205  0.569602  0.362701
1  0.516205  1.000000  0.526899  0.334496
2  0.569602  0.526899  1.000000  0.457691
3  0.362701  0.334496  0.457691  1.000000
Timestep 124000, Reward: 402.5443301210306, TD Loss: 32.3715971385203
test
0:  annret:3.035,  sharpe:0.211
1:  annret:0.310,  sharpe:0.020
2:  annret:13.059,  sharpe:1.277
3:  annret:-2.177,  sharpe:-0.183
          0         1         2         3
0  1.000000  0.576727 -0.465562  0.175401
1  0.576727  1.000000 -0.384781  0.029244
2 -0.465562 -0.384781  1.000000  0.071122
3  0.175401  0.029244  0.071122  1.000000
train
0:  annret:33.782,  sharpe:1.750
1:  annret:32.477,  sharpe:1.675
2:  annret:46.999,  sharpe:2.893
3:  annret:40.443,  sharpe:2.290
portfolio:  annret:57.738,  sharpe:3.803
                  0         1         2         3  portfolio
0          1.000000  0.631146  0.008380  0.234540   0.618162
1          0.631146  1.000000  0.050303  0.314494   0.725707
2          0.008380  0.050303  1.000000  0.297424   0.471966
3          0.234540  0.314494  0.297424  1.000000   0.607786
portfolio  0.618162  0.725707  0.471966  0.607786   1.000000
test
0:  annret:3.035,  sharpe:0.211
1:  annret:0.310,  sharpe:0.020
2:  annret:13.059,  sharpe:1.277
3:  annret:-2.177,  sharpe:-0.183
portfolio:  annret:13.266,  sharpe:1.431
                  0         1         2         3  portfolio
0          1.000000  0.576727 -0.465562  0.175401   0.563708
1          0.576727  1.000000 -0.384781  0.029244   0.625919
2         -0.465562 -0.384781  1.000000  0.071122  -0.041286
3          0.175401  0.029244  0.071122  1.000000   0.420601
portfolio  0.563708  0.625919 -0.041286  0.420601   1.000000
------------------
Timestep 125000, Reward: 402.5443301210306, TD Loss: 10.588411887259968
test
0:  annret:16.814,  sharpe:1.167
1:  annret:10.679,  sharpe:0.527
2:  annret:13.693,  sharpe:0.739
3:  annret:8.497,  sharpe:0.443
          0         1         2         3
0  1.000000  0.735785  0.811996  0.682352
1  0.735785  1.000000  0.776221  0.761100
2  0.811996  0.776221  1.000000  0.668037
3  0.682352  0.761100  0.668037  1.000000
train
0:  annret:33.867,  sharpe:1.847
1:  annret:23.849,  sharpe:0.951
2:  annret:37.830,  sharpe:1.669
3:  annret:44.132,  sharpe:1.945
portfolio:  annret:50.987,  sharpe:2.843
                  0         1         2         3  portfolio
0          1.000000  0.617991  0.670257  0.613035   0.728990
1          0.617991  1.000000  0.611102  0.637842   0.774112
2          0.670257  0.611102  1.000000  0.482288   0.751599
3          0.613035  0.637842  0.482288  1.000000   0.714665
portfolio  0.728990  0.774112  0.751599  0.714665   1.000000
test
0:  annret:16.814,  sharpe:1.167
1:  annret:10.679,  sharpe:0.527
2:  annret:13.693,  sharpe:0.739
3:  annret:8.497,  sharpe:0.443
portfolio:  annret:17.817,  sharpe:1.376
                  0         1         2         3  portfolio
0          1.000000  0.735785  0.811996  0.682352   0.775982
1          0.735785  1.000000  0.776221  0.761100   0.832663
2          0.811996  0.776221  1.000000  0.668037   0.781083
3          0.682352  0.761100  0.668037  1.000000   0.802248
portfolio  0.775982  0.832663  0.781083  0.802248   1.000000
------------------
Timestep 126000, Reward: 402.5443301210306, TD Loss: 31.161620282663552
test
0:  annret:13.779,  sharpe:1.658
1:  annret:0.117,  sharpe:0.009
2:  annret:8.437,  sharpe:0.670
3:  annret:-3.099,  sharpe:-0.168
          0         1         2         3
0  1.000000  0.064474 -0.049750  0.010581
1  0.064474  1.000000 -0.474895  0.711395
2 -0.049750 -0.474895  1.000000 -0.657578
3  0.010581  0.711395 -0.657578  1.000000
train
0:  annret:34.749,  sharpe:2.528
1:  annret:26.998,  sharpe:1.586
2:  annret:40.277,  sharpe:2.224
3:  annret:26.264,  sharpe:1.171
portfolio:  annret:60.267,  sharpe:3.837
                  0         1         2         3  portfolio
0          1.000000  0.362340  0.288045  0.219303   0.571082
1          0.362340  1.000000  0.002064  0.638105   0.674630
2          0.288045  0.002064  1.000000 -0.085393   0.436930
3          0.219303  0.638105 -0.085393  1.000000   0.601588
portfolio  0.571082  0.674630  0.436930  0.601588   1.000000
test
0:  annret:13.779,  sharpe:1.658
1:  annret:0.117,  sharpe:0.009
2:  annret:8.437,  sharpe:0.670
3:  annret:-3.099,  sharpe:-0.168
portfolio:  annret:13.565,  sharpe:1.407
                  0         1         2         3  portfolio
0          1.000000  0.064474 -0.049750  0.010581   0.224069
1          0.064474  1.000000 -0.474895  0.711395   0.624171
2         -0.049750 -0.474895  1.000000 -0.657578  -0.121372
3          0.010581  0.711395 -0.657578  1.000000   0.554480
portfolio  0.224069  0.624171 -0.121372  0.554480   1.000000
------------------
0:  annret:21.725,  sharpe:1.138
1:  annret:11.545,  sharpe:0.565
2:  annret:20.687,  sharpe:1.011
3:  annret:26.821,  sharpe:1.341
          0         1         2         3
0  1.000000  0.486609  0.271841  0.351278
1  0.486609  1.000000  0.310392  0.443368
2  0.271841  0.310392  1.000000  0.132574
3  0.351278  0.443368  0.132574  1.000000
Timestep 127000, Reward: 352.18040479435774, TD Loss: 31.09394238366588
test
0:  annret:13.131,  sharpe:0.685
1:  annret:14.020,  sharpe:0.708
2:  annret:13.545,  sharpe:0.812
3:  annret:14.792,  sharpe:0.760
          0         1         2         3
0  1.000000  0.807005  0.816593  0.848123
1  0.807005  1.000000  0.780068  0.812269
2  0.816593  0.780068  1.000000  0.713273
3  0.848123  0.812269  0.713273  1.000000
train
0:  annret:21.776,  sharpe:0.941
1:  annret:22.968,  sharpe:0.950
2:  annret:35.944,  sharpe:1.700
3:  annret:32.324,  sharpe:1.373
portfolio:  annret:46.618,  sharpe:2.545
                  0         1         2         3  portfolio
0          1.000000  0.728461  0.651416  0.749648   0.782718
1          0.728461  1.000000  0.615828  0.665662   0.812390
2          0.651416  0.615828  1.000000  0.540564   0.768524
3          0.749648  0.665662  0.540564  1.000000   0.737123
portfolio  0.782718  0.812390  0.768524  0.737123   1.000000
test
0:  annret:13.131,  sharpe:0.685
1:  annret:14.020,  sharpe:0.708
2:  annret:13.545,  sharpe:0.812
3:  annret:14.792,  sharpe:0.760
portfolio:  annret:21.173,  sharpe:1.567
                  0         1         2         3  portfolio
0          1.000000  0.807005  0.816593  0.848123   0.866571
1          0.807005  1.000000  0.780068  0.812269   0.850307
2          0.816593  0.780068  1.000000  0.713273   0.798537
3          0.848123  0.812269  0.713273  1.000000   0.810166
portfolio  0.866571  0.850307  0.798537  0.810166   1.000000
------------------
Timestep 128000, Reward: 352.18040479435774, TD Loss: 25.831529872952494
test
0:  annret:10.968,  sharpe:1.182
1:  annret:6.327,  sharpe:0.666
2:  annret:18.000,  sharpe:1.061
3:  annret:-5.502,  sharpe:-0.316
          0         1         2         3
0  1.000000 -0.002554 -0.177234  0.319821
1 -0.002554  1.000000  0.424113 -0.279515
2 -0.177234  0.424113  1.000000 -0.764170
3  0.319821 -0.279515 -0.764170  1.000000
train
0:  annret:38.143,  sharpe:2.517
1:  annret:36.163,  sharpe:2.297
2:  annret:38.718,  sharpe:1.806
3:  annret:31.812,  sharpe:1.498
portfolio:  annret:59.556,  sharpe:3.938
                  0         1         2         3  portfolio
0          1.000000  0.337491  0.116734  0.437013   0.670166
1          0.337491  1.000000  0.442987  0.161887   0.607948
2          0.116734  0.442987  1.000000 -0.305573   0.428611
3          0.437013  0.161887 -0.305573  1.000000   0.551378
portfolio  0.670166  0.607948  0.428611  0.551378   1.000000
test
0:  annret:10.968,  sharpe:1.182
1:  annret:6.327,  sharpe:0.666
2:  annret:18.000,  sharpe:1.061
3:  annret:-5.502,  sharpe:-0.316
portfolio:  annret:15.248,  sharpe:1.832
                  0         1         2         3  portfolio
0          1.000000 -0.002554 -0.177234  0.319821   0.567008
1         -0.002554  1.000000  0.424113 -0.279515   0.290041
2         -0.177234  0.424113  1.000000 -0.764170   0.016808
3          0.319821 -0.279515 -0.764170  1.000000   0.394030
portfolio  0.567008  0.290041  0.016808  0.394030   1.000000
------------------
0:  annret:22.724,  sharpe:1.092
1:  annret:17.229,  sharpe:0.779
2:  annret:24.024,  sharpe:1.239
3:  annret:28.784,  sharpe:1.437
          0         1         2         3
0  1.000000  0.321379  0.164724  0.404901
1  0.321379  1.000000  0.408298  0.147193
2  0.164724  0.408298  1.000000  0.114233
3  0.404901  0.147193  0.114233  1.000000
Timestep 129000, Reward: 387.22140848720585, TD Loss: 11.811933195853493
test
0:  annret:15.521,  sharpe:0.799
1:  annret:14.825,  sharpe:1.801
2:  annret:10.388,  sharpe:1.312
3:  annret:2.448,  sharpe:0.230
          0         1         2         3
0  1.000000  0.226914  0.013901 -0.499074
1  0.226914  1.000000 -0.035004 -0.045867
2  0.013901 -0.035004  1.000000 -0.142058
3 -0.499074 -0.045867 -0.142058  1.000000
train
0:  annret:21.827,  sharpe:0.919
1:  annret:32.415,  sharpe:2.231
2:  annret:32.348,  sharpe:2.349
3:  annret:31.136,  sharpe:1.923
portfolio:  annret:57.669,  sharpe:4.016
                  0         1         2         3  portfolio
0          1.000000  0.194162  0.008207 -0.168842   0.337331
1          0.194162  1.000000  0.186472  0.215111   0.581077
2          0.008207  0.186472  1.000000  0.110745   0.449581
3         -0.168842  0.215111  0.110745  1.000000   0.439476
portfolio  0.337331  0.581077  0.449581  0.439476   1.000000
test
0:  annret:15.521,  sharpe:0.799
1:  annret:14.825,  sharpe:1.801
2:  annret:10.388,  sharpe:1.312
3:  annret:2.448,  sharpe:0.230
portfolio:  annret:16.796,  sharpe:2.038
                  0         1         2         3  portfolio
0          1.000000  0.226914  0.013901 -0.499074   0.297091
1          0.226914  1.000000 -0.035004 -0.045867   0.424745
2          0.013901 -0.035004  1.000000 -0.142058   0.123481
3         -0.499074 -0.045867 -0.142058  1.000000   0.130347
portfolio  0.297091  0.424745  0.123481  0.130347   1.000000
------------------
Timestep 130000, Reward: 387.22140848720585, TD Loss: 7.1957205162088265
test
0:  annret:7.025,  sharpe:0.771
1:  annret:13.215,  sharpe:1.056
2:  annret:13.804,  sharpe:0.786
3:  annret:5.378,  sharpe:0.363
          0         1         2         3
0  1.000000  0.087220 -0.021529  0.052323
1  0.087220  1.000000  0.745617  0.724235
2 -0.021529  0.745617  1.000000  0.723228
3  0.052323  0.724235  0.723228  1.000000
train
0:  annret:35.983,  sharpe:2.397
1:  annret:31.997,  sharpe:1.781
2:  annret:35.430,  sharpe:1.658
3:  annret:32.452,  sharpe:1.674
portfolio:  annret:55.246,  sharpe:3.646
                  0         1         2         3  portfolio
0          1.000000  0.405043  0.278316  0.310012   0.702565
1          0.405043  1.000000  0.637608  0.685463   0.661154
2          0.278316  0.637608  1.000000  0.605828   0.567067
3          0.310012  0.685463  0.605828  1.000000   0.604022
portfolio  0.702565  0.661154  0.567067  0.604022   1.000000
test
0:  annret:7.025,  sharpe:0.771
1:  annret:13.215,  sharpe:1.056
2:  annret:13.804,  sharpe:0.786
3:  annret:5.378,  sharpe:0.363
portfolio:  annret:15.025,  sharpe:1.720
                  0         1         2         3  portfolio
0          1.000000  0.087220 -0.021529  0.052323   0.480488
1          0.087220  1.000000  0.745617  0.724235   0.504800
2         -0.021529  0.745617  1.000000  0.723228   0.413726
3          0.052323  0.724235  0.723228  1.000000   0.506564
portfolio  0.480488  0.504800  0.413726  0.506564   1.000000
------------------
0:  annret:20.269,  sharpe:0.979
1:  annret:14.500,  sharpe:0.767
2:  annret:27.344,  sharpe:1.374
3:  annret:29.424,  sharpe:1.451
          0         1         2         3
0  1.000000  0.491578  0.390898  0.340188
1  0.491578  1.000000  0.395831  0.399997
2  0.390898  0.395831  1.000000  0.271007
3  0.340188  0.399997  0.271007  1.000000
Timestep 131000, Reward: 362.93703172889946, TD Loss: 11.227060478679846
test
0:  annret:2.807,  sharpe:0.266
1:  annret:13.249,  sharpe:1.486
2:  annret:4.735,  sharpe:0.520
3:  annret:14.743,  sharpe:1.710
          0         1         2         3
0  1.000000 -0.137678  0.198755  0.107770
1 -0.137678  1.000000  0.267021 -0.070938
2  0.198755  0.267021  1.000000 -0.091176
3  0.107770 -0.070938 -0.091176  1.000000
train
0:  annret:34.417,  sharpe:2.303
1:  annret:36.107,  sharpe:2.492
2:  annret:39.337,  sharpe:2.628
3:  annret:29.860,  sharpe:1.920
portfolio:  annret:61.488,  sharpe:4.204
                  0         1         2         3  portfolio
0          1.000000  0.182664  0.239826  0.275925   0.600912
1          0.182664  1.000000  0.472611  0.136991   0.601254
2          0.239826  0.472611  1.000000  0.099990   0.571459
3          0.275925  0.136991  0.099990  1.000000   0.466509
portfolio  0.600912  0.601254  0.571459  0.466509   1.000000
test
0:  annret:2.807,  sharpe:0.266
1:  annret:13.249,  sharpe:1.486
2:  annret:4.735,  sharpe:0.520
3:  annret:14.743,  sharpe:1.710
portfolio:  annret:17.067,  sharpe:2.048
                  0         1         2         3  portfolio
0          1.000000 -0.137678  0.198755  0.107770   0.509368
1         -0.137678  1.000000  0.267021 -0.070938   0.323061
2          0.198755  0.267021  1.000000 -0.091176   0.401476
3          0.107770 -0.070938 -0.091176  1.000000   0.171198
portfolio  0.509368  0.323061  0.401476  0.171198   1.000000
------------------
Timestep 132000, Reward: 362.93703172889946, TD Loss: 32.616360970384136
test
0:  annret:1.764,  sharpe:0.196
1:  annret:14.212,  sharpe:0.980
2:  annret:15.743,  sharpe:0.920
3:  annret:3.624,  sharpe:0.357
          0         1         2         3
0  1.000000 -0.193544 -0.168141  0.394655
1 -0.193544  1.000000  0.801307 -0.400042
2 -0.168141  0.801307  1.000000 -0.478512
3  0.394655 -0.400042 -0.478512  1.000000
train
0:  annret:35.553,  sharpe:2.354
1:  annret:27.477,  sharpe:1.424
2:  annret:38.302,  sharpe:1.781
3:  annret:29.165,  sharpe:1.817
portfolio:  annret:57.451,  sharpe:3.732
                  0         1         2         3  portfolio
0          1.000000  0.176882  0.197052  0.468445   0.643603
1          0.176882  1.000000  0.694058  0.072110   0.504656
2          0.197052  0.694058  1.000000 -0.003242   0.582307
3          0.468445  0.072110 -0.003242  1.000000   0.529798
portfolio  0.643603  0.504656  0.582307  0.529798   1.000000
test
0:  annret:1.764,  sharpe:0.196
1:  annret:14.212,  sharpe:0.980
2:  annret:15.743,  sharpe:0.920
3:  annret:3.624,  sharpe:0.357
portfolio:  annret:14.714,  sharpe:1.722
                  0         1         2         3  portfolio
0          1.000000 -0.193544 -0.168141  0.394655   0.478011
1         -0.193544  1.000000  0.801307 -0.400042   0.243380
2         -0.168141  0.801307  1.000000 -0.478512   0.288507
3          0.394655 -0.400042 -0.478512  1.000000   0.294261
portfolio  0.478011  0.243380  0.288507  0.294261   1.000000
------------------
0:  annret:22.812,  sharpe:1.113
1:  annret:10.348,  sharpe:0.500
2:  annret:28.992,  sharpe:1.521
3:  annret:21.902,  sharpe:1.133
          0         1         2         3
0  1.000000  0.387460  0.380463  0.333919
1  0.387460  1.000000  0.505233  0.150489
2  0.380463  0.505233  1.000000  0.169610
3  0.333919  0.150489  0.169610  1.000000
Timestep 133000, Reward: 372.6739969461084, TD Loss: 17.0946195720468
test
0:  annret:15.605,  sharpe:0.759
1:  annret:16.154,  sharpe:0.767
2:  annret:14.566,  sharpe:0.812
3:  annret:14.227,  sharpe:0.737
          0         1         2         3
0  1.000000  0.804551  0.840732  0.802209
1  0.804551  1.000000  0.885945  0.808971
2  0.840732  0.885945  1.000000  0.821891
3  0.802209  0.808971  0.821891  1.000000
train
0:  annret:24.327,  sharpe:0.964
1:  annret:18.324,  sharpe:0.706
2:  annret:39.300,  sharpe:1.779
3:  annret:34.470,  sharpe:1.510
portfolio:  annret:49.185,  sharpe:2.631
                  0         1         2         3  portfolio
0          1.000000  0.782125  0.644188  0.676470   0.756858
1          0.782125  1.000000  0.701525  0.642602   0.775740
2          0.644188  0.701525  1.000000  0.623501   0.823588
3          0.676470  0.642602  0.623501  1.000000   0.697425
portfolio  0.756858  0.775740  0.823588  0.697425   1.000000
test
0:  annret:15.605,  sharpe:0.759
1:  annret:16.154,  sharpe:0.767
2:  annret:14.566,  sharpe:0.812
3:  annret:14.227,  sharpe:0.737
portfolio:  annret:19.603,  sharpe:1.507
                  0         1         2         3  portfolio
0          1.000000  0.804551  0.840732  0.802209   0.836396
1          0.804551  1.000000  0.885945  0.808971   0.803369
2          0.840732  0.885945  1.000000  0.821891   0.850949
3          0.802209  0.808971  0.821891  1.000000   0.804406
portfolio  0.836396  0.803369  0.850949  0.804406   1.000000
------------------
Timestep 134000, Reward: 372.6739969461084, TD Loss: 106.65270837679574
test
0:  annret:1.647,  sharpe:0.082
1:  annret:-3.891,  sharpe:-0.297
2:  annret:-5.355,  sharpe:-0.457
3:  annret:-1.884,  sharpe:-0.095
          0         1         2         3
0  1.000000  0.637669  0.346149  0.804042
1  0.637669  1.000000  0.532071  0.803432
2  0.346149  0.532071  1.000000  0.438825
3  0.804042  0.803432  0.438825  1.000000
train
0:  annret:19.518,  sharpe:0.803
1:  annret:27.571,  sharpe:1.600
2:  annret:43.200,  sharpe:2.368
3:  annret:26.826,  sharpe:1.136
portfolio:  annret:47.451,  sharpe:2.473
                  0         1         2         3  portfolio
0          1.000000  0.513122  0.404016  0.687828   0.759887
1          0.513122  1.000000  0.588910  0.663886   0.765105
2          0.404016  0.588910  1.000000  0.426113   0.732292
3          0.687828  0.663886  0.426113  1.000000   0.810176
portfolio  0.759887  0.765105  0.732292  0.810176   1.000000
test
0:  annret:1.647,  sharpe:0.082
1:  annret:-3.891,  sharpe:-0.297
2:  annret:-5.355,  sharpe:-0.457
3:  annret:-1.884,  sharpe:-0.095
portfolio:  annret:3.531,  sharpe:0.247
                  0         1         2         3  portfolio
0          1.000000  0.637669  0.346149  0.804042   0.806028
1          0.637669  1.000000  0.532071  0.803432   0.813677
2          0.346149  0.532071  1.000000  0.438825   0.638097
3          0.804042  0.803432  0.438825  1.000000   0.867875
portfolio  0.806028  0.813677  0.638097  0.867875   1.000000
------------------
0:  annret:21.817,  sharpe:1.067
1:  annret:22.992,  sharpe:1.106
2:  annret:17.814,  sharpe:0.892
3:  annret:18.574,  sharpe:0.929
          0         1         2         3
0  1.000000  0.434392  0.308624  0.421326
1  0.434392  1.000000  0.487730  0.406455
2  0.308624  0.487730  1.000000  0.410323
3  0.421326  0.406455  0.410323  1.000000
Timestep 135000, Reward: 375.85165017951545, TD Loss: 29.884547944389947
test
0:  annret:14.478,  sharpe:0.946
1:  annret:3.075,  sharpe:0.283
2:  annret:9.466,  sharpe:0.473
3:  annret:15.182,  sharpe:0.791
          0         1         2         3
0  1.000000  0.469025  0.766400  0.655956
1  0.469025  1.000000  0.449747  0.464111
2  0.766400  0.449747  1.000000  0.756656
3  0.655956  0.464111  0.756656  1.000000
train
0:  annret:37.993,  sharpe:1.992
1:  annret:33.926,  sharpe:2.062
2:  annret:34.774,  sharpe:1.487
3:  annret:40.597,  sharpe:1.772
portfolio:  annret:55.505,  sharpe:3.269
                  0         1         2         3  portfolio
0          1.000000  0.463996  0.649816  0.635778   0.719192
1          0.463996  1.000000  0.400299  0.443051   0.720226
2          0.649816  0.400299  1.000000  0.526137   0.688960
3          0.635778  0.443051  0.526137  1.000000   0.659524
portfolio  0.719192  0.720226  0.688960  0.659524   1.000000
test
0:  annret:14.478,  sharpe:0.946
1:  annret:3.075,  sharpe:0.283
2:  annret:9.466,  sharpe:0.473
3:  annret:15.182,  sharpe:0.791
portfolio:  annret:19.499,  sharpe:1.742
                  0         1         2         3  portfolio
0          1.000000  0.469025  0.766400  0.655956   0.773498
1          0.469025  1.000000  0.449747  0.464111   0.667870
2          0.766400  0.449747  1.000000  0.756656   0.725727
3          0.655956  0.464111  0.756656  1.000000   0.728983
portfolio  0.773498  0.667870  0.725727  0.728983   1.000000
------------------
Timestep 136000, Reward: 375.85165017951545, TD Loss: 29.72003645736637
test
0:  annret:18.375,  sharpe:0.793
1:  annret:15.929,  sharpe:0.750
2:  annret:16.268,  sharpe:0.706
3:  annret:11.906,  sharpe:0.570
          0         1         2         3
0  1.000000  0.838180  0.928819  0.858350
1  0.838180  1.000000  0.904027  0.829390
2  0.928819  0.904027  1.000000  0.896088
3  0.858350  0.829390  0.896088  1.000000
train
0:  annret:23.317,  sharpe:0.834
1:  annret:20.323,  sharpe:0.771
2:  annret:28.501,  sharpe:1.077
3:  annret:29.076,  sharpe:1.205
portfolio:  annret:35.947,  sharpe:1.629
                  0         1         2         3  portfolio
0          1.000000  0.797036  0.833569  0.739710   0.889498
1          0.797036  1.000000  0.763340  0.693063   0.871805
2          0.833569  0.763340  1.000000  0.736645   0.892653
3          0.739710  0.693063  0.736645  1.000000   0.803703
portfolio  0.889498  0.871805  0.892653  0.803703   1.000000
test
0:  annret:18.375,  sharpe:0.793
1:  annret:15.929,  sharpe:0.750
2:  annret:16.268,  sharpe:0.706
3:  annret:11.906,  sharpe:0.570
portfolio:  annret:22.731,  sharpe:1.308
                  0         1         2         3  portfolio
0          1.000000  0.838180  0.928819  0.858350   0.920017
1          0.838180  1.000000  0.904027  0.829390   0.901133
2          0.928819  0.904027  1.000000  0.896088   0.944235
3          0.858350  0.829390  0.896088  1.000000   0.897570
portfolio  0.920017  0.901133  0.944235  0.897570   1.000000
------------------
0:  annret:25.781,  sharpe:1.222
1:  annret:13.030,  sharpe:0.644
2:  annret:34.397,  sharpe:1.765
3:  annret:18.615,  sharpe:0.920
          0         1         2         3
0  1.000000  0.277116  0.462311  0.326514
1  0.277116  1.000000  0.420297  0.407021
2  0.462311  0.420297  1.000000  0.452604
3  0.326514  0.407021  0.452604  1.000000
Timestep 137000, Reward: 403.20737496559525, TD Loss: 8.946052750731468
test
0:  annret:19.322,  sharpe:2.291
1:  annret:0.179,  sharpe:0.015
2:  annret:8.827,  sharpe:0.804
3:  annret:7.004,  sharpe:0.498
          0         1         2         3
0  1.000000 -0.186904  0.377056  0.193062
1 -0.186904  1.000000 -0.240332 -0.136029
2  0.377056 -0.240332  1.000000  0.492308
3  0.193062 -0.136029  0.492308  1.000000
train
0:  annret:39.616,  sharpe:2.629
1:  annret:34.144,  sharpe:1.952
2:  annret:51.708,  sharpe:2.961
3:  annret:37.932,  sharpe:2.037
portfolio:  annret:59.275,  sharpe:3.960
                  0         1         2         3  portfolio
0          1.000000  0.004322  0.503307  0.442494   0.562740
1          0.004322  1.000000  0.150715  0.108804   0.510168
2          0.503307  0.150715  1.000000  0.517621   0.753092
3          0.442494  0.108804  0.517621  1.000000   0.593077
portfolio  0.562740  0.510168  0.753092  0.593077   1.000000
test
0:  annret:19.322,  sharpe:2.291
1:  annret:0.179,  sharpe:0.015
2:  annret:8.827,  sharpe:0.804
3:  annret:7.004,  sharpe:0.498
portfolio:  annret:16.380,  sharpe:1.875
                  0         1         2         3  portfolio
0          1.000000 -0.186904  0.377056  0.193062   0.362074
1         -0.186904  1.000000 -0.240332 -0.136029   0.390556
2          0.377056 -0.240332  1.000000  0.492308   0.521557
3          0.193062 -0.136029  0.492308  1.000000   0.449488
portfolio  0.362074  0.390556  0.521557  0.449488   1.000000
------------------
Timestep 138000, Reward: 403.20737496559525, TD Loss: 11.475652032578312
test
0:  annret:17.866,  sharpe:0.799
1:  annret:9.739,  sharpe:0.545
2:  annret:14.333,  sharpe:0.648
3:  annret:11.343,  sharpe:0.572
          0         1         2         3
0  1.000000  0.809649  0.915182  0.809239
1  0.809649  1.000000  0.883938  0.780480
2  0.915182  0.883938  1.000000  0.807794
3  0.809239  0.780480  0.807794  1.000000
train
0:  annret:23.331,  sharpe:0.862
1:  annret:25.871,  sharpe:1.233
2:  annret:37.433,  sharpe:1.470
3:  annret:36.734,  sharpe:1.532
portfolio:  annret:44.602,  sharpe:2.215
                  0         1         2         3  portfolio
0          1.000000  0.706239  0.813798  0.680393   0.838491
1          0.706239  1.000000  0.726230  0.639097   0.780294
2          0.813798  0.726230  1.000000  0.624264   0.867939
3          0.680393  0.639097  0.624264  1.000000   0.739002
portfolio  0.838491  0.780294  0.867939  0.739002   1.000000
test
0:  annret:17.866,  sharpe:0.799
1:  annret:9.739,  sharpe:0.545
2:  annret:14.333,  sharpe:0.648
3:  annret:11.343,  sharpe:0.572
portfolio:  annret:18.811,  sharpe:1.245
                  0         1         2         3  portfolio
0          1.000000  0.809649  0.915182  0.809239   0.875570
1          0.809649  1.000000  0.883938  0.780480   0.847035
2          0.915182  0.883938  1.000000  0.807794   0.887660
3          0.809239  0.780480  0.807794  1.000000   0.852344
portfolio  0.875570  0.847035  0.887660  0.852344   1.000000
------------------
Timestep 139000, Reward: 403.20737496559525, TD Loss: 22.565576758588712
test
0:  annret:16.590,  sharpe:0.889
1:  annret:12.683,  sharpe:0.620
2:  annret:13.998,  sharpe:0.760
3:  annret:12.425,  sharpe:0.659
          0         1         2         3
0  1.000000  0.833077  0.875428  0.855446
1  0.833077  1.000000  0.891353  0.851180
2  0.875428  0.891353  1.000000  0.839746
3  0.855446  0.851180  0.839746  1.000000
train
0:  annret:32.772,  sharpe:1.458
1:  annret:22.983,  sharpe:0.935
2:  annret:40.574,  sharpe:1.786
3:  annret:38.180,  sharpe:1.679
portfolio:  annret:51.339,  sharpe:2.749
                  0         1         2         3  portfolio
0          1.000000  0.739802  0.761168  0.757789   0.776953
1          0.739802  1.000000  0.696577  0.656091   0.784099
2          0.761168  0.696577  1.000000  0.698760   0.849752
3          0.757789  0.656091  0.698760  1.000000   0.754626
portfolio  0.776953  0.784099  0.849752  0.754626   1.000000
test
0:  annret:16.590,  sharpe:0.889
1:  annret:12.683,  sharpe:0.620
2:  annret:13.998,  sharpe:0.760
3:  annret:12.425,  sharpe:0.659
portfolio:  annret:15.139,  sharpe:1.113
                  0         1         2         3  portfolio
0          1.000000  0.833077  0.875428  0.855446   0.852081
1          0.833077  1.000000  0.891353  0.851180   0.845926
2          0.875428  0.891353  1.000000  0.839746   0.865244
3          0.855446  0.851180  0.839746  1.000000   0.851733
portfolio  0.852081  0.845926  0.865244  0.851733   1.000000
------------------
0:  annret:15.829,  sharpe:0.676
1:  annret:14.487,  sharpe:0.742
2:  annret:38.261,  sharpe:1.920
3:  annret:29.373,  sharpe:1.322
          0         1         2         3
0  1.000000  0.498929  0.473229  0.261624
1  0.498929  1.000000  0.490775  0.278830
2  0.473229  0.490775  1.000000  0.487282
3  0.261624  0.278830  0.487282  1.000000
Timestep 140000, Reward: 474.95579840348614, TD Loss: 17.133633054116373
test
0:  annret:15.721,  sharpe:0.747
1:  annret:13.859,  sharpe:0.719
2:  annret:11.897,  sharpe:0.596
3:  annret:16.415,  sharpe:0.798
          0         1         2         3
0  1.000000  0.760047  0.862550  0.838298
1  0.760047  1.000000  0.868201  0.829443
2  0.862550  0.868201  1.000000  0.837223
3  0.838298  0.829443  0.837223  1.000000
train
0:  annret:22.985,  sharpe:0.901
1:  annret:26.013,  sharpe:1.112
2:  annret:34.395,  sharpe:1.451
3:  annret:37.869,  sharpe:1.549
portfolio:  annret:44.742,  sharpe:2.303
                  0         1         2         3  portfolio
0          1.000000  0.705691  0.736772  0.655627   0.781574
1          0.705691  1.000000  0.730508  0.649462   0.822795
2          0.736772  0.730508  1.000000  0.611088   0.838443
3          0.655627  0.649462  0.611088  1.000000   0.732568
portfolio  0.781574  0.822795  0.838443  0.732568   1.000000
test
0:  annret:15.721,  sharpe:0.747
1:  annret:13.859,  sharpe:0.719
2:  annret:11.897,  sharpe:0.596
3:  annret:16.415,  sharpe:0.798
portfolio:  annret:16.589,  sharpe:1.169
                  0         1         2         3  portfolio
0          1.000000  0.760047  0.862550  0.838298   0.861082
1          0.760047  1.000000  0.868201  0.829443   0.847035
2          0.862550  0.868201  1.000000  0.837223   0.871086
3          0.838298  0.829443  0.837223  1.000000   0.867768
portfolio  0.861082  0.847035  0.871086  0.867768   1.000000
------------------
Timestep 141000, Reward: 474.95579840348614, TD Loss: 9.225162535587032
test
0:  annret:14.125,  sharpe:0.727
1:  annret:2.015,  sharpe:0.203
2:  annret:13.644,  sharpe:0.683
3:  annret:5.214,  sharpe:0.367
          0         1         2         3
0  1.000000 -0.474737  0.894322  0.710201
1 -0.474737  1.000000 -0.439681 -0.219034
2  0.894322 -0.439681  1.000000  0.713552
3  0.710201 -0.219034  0.713552  1.000000
train
0:  annret:34.777,  sharpe:1.496
1:  annret:29.392,  sharpe:1.899
2:  annret:33.164,  sharpe:1.425
3:  annret:34.371,  sharpe:1.834
portfolio:  annret:53.285,  sharpe:3.361
                  0         1         2         3  portfolio
0          1.000000 -0.165253  0.777101  0.576604   0.615266
1         -0.165253  1.000000 -0.052635  0.191912   0.384812
2          0.777101 -0.052635  1.000000  0.581735   0.661184
3          0.576604  0.191912  0.581735  1.000000   0.664322
portfolio  0.615266  0.384812  0.661184  0.664322   1.000000
test
0:  annret:14.125,  sharpe:0.727
1:  annret:2.015,  sharpe:0.203
2:  annret:13.644,  sharpe:0.683
3:  annret:5.214,  sharpe:0.367
portfolio:  annret:11.362,  sharpe:1.089
                  0         1         2         3  portfolio
0          1.000000 -0.474737  0.894322  0.710201   0.671610
1         -0.474737  1.000000 -0.439681 -0.219034  -0.028705
2          0.894322 -0.439681  1.000000  0.713552   0.610200
3          0.710201 -0.219034  0.713552  1.000000   0.649514
portfolio  0.671610 -0.028705  0.610200  0.649514   1.000000
------------------
0:  annret:17.576,  sharpe:0.766
1:  annret:9.658,  sharpe:0.463
2:  annret:27.304,  sharpe:1.349
3:  annret:23.337,  sharpe:1.137
          0         1         2         3
0  1.000000  0.227093  0.446887  0.323950
1  0.227093  1.000000  0.442446  0.493044
2  0.446887  0.442446  1.000000  0.408997
3  0.323950  0.493044  0.408997  1.000000
Timestep 142000, Reward: 372.5404379043008, TD Loss: 6.677840997347266
test
0:  annret:19.620,  sharpe:1.848
1:  annret:12.674,  sharpe:0.840
2:  annret:15.169,  sharpe:0.779
3:  annret:14.979,  sharpe:0.722
          0         1         2         3
0  1.000000  0.387372  0.571230  0.453708
1  0.387372  1.000000  0.780988  0.718560
2  0.571230  0.780988  1.000000  0.803659
3  0.453708  0.718560  0.803659  1.000000
train
0:  annret:41.467,  sharpe:2.554
1:  annret:29.804,  sharpe:1.532
2:  annret:36.556,  sharpe:1.606
3:  annret:45.327,  sharpe:1.860
portfolio:  annret:54.991,  sharpe:3.168
                  0         1         2         3  portfolio
0          1.000000  0.467558  0.578890  0.445928   0.719461
1          0.467558  1.000000  0.667219  0.564674   0.765420
2          0.578890  0.667219  1.000000  0.620759   0.751080
3          0.445928  0.564674  0.620759  1.000000   0.678734
portfolio  0.719461  0.765420  0.751080  0.678734   1.000000
test
0:  annret:19.620,  sharpe:1.848
1:  annret:12.674,  sharpe:0.840
2:  annret:15.169,  sharpe:0.779
3:  annret:14.979,  sharpe:0.722
portfolio:  annret:15.572,  sharpe:1.303
                  0         1         2         3  portfolio
0          1.000000  0.387372  0.571230  0.453708   0.618993
1          0.387372  1.000000  0.780988  0.718560   0.753451
2          0.571230  0.780988  1.000000  0.803659   0.779584
3          0.453708  0.718560  0.803659  1.000000   0.787135
portfolio  0.618993  0.753451  0.779584  0.787135   1.000000
------------------
Timestep 143000, Reward: 372.5404379043008, TD Loss: 17.20301048377982
test
0:  annret:4.421,  sharpe:0.502
1:  annret:14.228,  sharpe:0.744
2:  annret:14.391,  sharpe:0.884
3:  annret:10.018,  sharpe:0.557
          0         1         2         3
0  1.000000  0.075103  0.234857  0.172029
1  0.075103  1.000000  0.837671  0.821210
2  0.234857  0.837671  1.000000  0.760133
3  0.172029  0.821210  0.760133  1.000000
train
0:  annret:36.811,  sharpe:2.475
1:  annret:26.485,  sharpe:1.152
2:  annret:34.606,  sharpe:1.671
3:  annret:39.212,  sharpe:1.798
portfolio:  annret:60.609,  sharpe:3.755
                  0         1         2         3  portfolio
0          1.000000  0.236429  0.504487  0.333894   0.621295
1          0.236429  1.000000  0.632772  0.678207   0.565239
2          0.504487  0.632772  1.000000  0.646688   0.635762
3          0.333894  0.678207  0.646688  1.000000   0.650717
portfolio  0.621295  0.565239  0.635762  0.650717   1.000000
test
0:  annret:4.421,  sharpe:0.502
1:  annret:14.228,  sharpe:0.744
2:  annret:14.391,  sharpe:0.884
3:  annret:10.018,  sharpe:0.557
portfolio:  annret:13.418,  sharpe:1.347
                  0         1         2         3  portfolio
0          1.000000  0.075103  0.234857  0.172029   0.377835
1          0.075103  1.000000  0.837671  0.821210   0.528144
2          0.234857  0.837671  1.000000  0.760133   0.518713
3          0.172029  0.821210  0.760133  1.000000   0.645891
portfolio  0.377835  0.528144  0.518713  0.645891   1.000000
------------------
0:  annret:29.436,  sharpe:1.482
1:  annret:13.999,  sharpe:0.639
2:  annret:30.271,  sharpe:1.415
3:  annret:21.504,  sharpe:1.035
          0         1         2         3
0  1.000000  0.203407  0.227706  0.429572
1  0.203407  1.000000  0.548085  0.316758
2  0.227706  0.548085  1.000000  0.375588
3  0.429572  0.316758  0.375588  1.000000
Timestep 144000, Reward: 423.3214125766792, TD Loss: 6.3736844057129405
test
0:  annret:13.798,  sharpe:0.856
1:  annret:10.426,  sharpe:0.796
2:  annret:2.565,  sharpe:0.242
3:  annret:13.736,  sharpe:0.864
          0         1         2         3
0  1.000000  0.580424 -0.331239  0.726595
1  0.580424  1.000000 -0.262259  0.650842
2 -0.331239 -0.262259  1.000000 -0.462665
3  0.726595  0.650842 -0.462665  1.000000
train
0:  annret:36.637,  sharpe:1.825
1:  annret:29.949,  sharpe:1.672
2:  annret:14.851,  sharpe:0.885
3:  annret:26.993,  sharpe:1.355
portfolio:  annret:57.114,  sharpe:3.810
                  0         1         2         3  portfolio
0          1.000000  0.576945 -0.135864  0.628125   0.693579
1          0.576945  1.000000 -0.194506  0.480497   0.647327
2         -0.135864 -0.194506  1.000000 -0.183108   0.052836
3          0.628125  0.480497 -0.183108  1.000000   0.547750
portfolio  0.693579  0.647327  0.052836  0.547750   1.000000
test
0:  annret:13.798,  sharpe:0.856
1:  annret:10.426,  sharpe:0.796
2:  annret:2.565,  sharpe:0.242
3:  annret:13.736,  sharpe:0.864
portfolio:  annret:13.811,  sharpe:1.518
                  0         1         2         3  portfolio
0          1.000000  0.580424 -0.331239  0.726595   0.700080
1          0.580424  1.000000 -0.262259  0.650842   0.551964
2         -0.331239 -0.262259  1.000000 -0.462665  -0.274903
3          0.726595  0.650842 -0.462665  1.000000   0.559307
portfolio  0.700080  0.551964 -0.274903  0.559307   1.000000
------------------
Timestep 145000, Reward: 423.3214125766792, TD Loss: 19.419689441680937
test
0:  annret:12.210,  sharpe:0.937
1:  annret:10.174,  sharpe:0.883
2:  annret:15.936,  sharpe:1.500
3:  annret:8.099,  sharpe:0.533
          0         1         2         3
0  1.000000  0.454296 -0.049210 -0.351544
1  0.454296  1.000000 -0.096325 -0.346947
2 -0.049210 -0.096325  1.000000  0.597447
3 -0.351544 -0.346947  0.597447  1.000000
train
0:  annret:37.815,  sharpe:2.152
1:  annret:31.850,  sharpe:1.984
2:  annret:49.005,  sharpe:2.796
3:  annret:31.815,  sharpe:1.597
portfolio:  annret:58.402,  sharpe:3.688
                  0         1         2         3  portfolio
0          1.000000  0.580753  0.417470  0.063814   0.709301
1          0.580753  1.000000  0.340135  0.068455   0.632400
2          0.417470  0.340135  1.000000  0.494974   0.772884
3          0.063814  0.068455  0.494974  1.000000   0.452521
portfolio  0.709301  0.632400  0.772884  0.452521   1.000000
test
0:  annret:12.210,  sharpe:0.937
1:  annret:10.174,  sharpe:0.883
2:  annret:15.936,  sharpe:1.500
3:  annret:8.099,  sharpe:0.533
portfolio:  annret:17.222,  sharpe:1.974
                  0         1         2         3  portfolio
0          1.000000  0.454296 -0.049210 -0.351544   0.510798
1          0.454296  1.000000 -0.096325 -0.346947   0.368855
2         -0.049210 -0.096325  1.000000  0.597447   0.549675
3         -0.351544 -0.346947  0.597447  1.000000   0.225932
portfolio  0.510798  0.368855  0.549675  0.225932   1.000000
------------------
0:  annret:22.546,  sharpe:1.034
1:  annret:9.577,  sharpe:0.454
2:  annret:28.763,  sharpe:1.472
3:  annret:23.263,  sharpe:1.155
          0         1         2         3
0  1.000000  0.518175  0.435831  0.481069
1  0.518175  1.000000  0.451906  0.396208
2  0.435831  0.451906  1.000000  0.377420
3  0.481069  0.396208  0.377420  1.000000
Timestep 146000, Reward: 424.37300594325234, TD Loss: 23.119610096670428
test
0:  annret:14.237,  sharpe:0.986
1:  annret:14.402,  sharpe:1.012
2:  annret:20.831,  sharpe:1.012
3:  annret:19.250,  sharpe:0.965
          0         1         2         3
0  1.000000  0.535110  0.735459  0.707132
1  0.535110  1.000000  0.780682  0.743808
2  0.735459  0.780682  1.000000  0.853032
3  0.707132  0.743808  0.853032  1.000000
train
0:  annret:36.039,  sharpe:1.958
1:  annret:37.094,  sharpe:1.951
2:  annret:35.656,  sharpe:1.456
3:  annret:38.694,  sharpe:1.643
portfolio:  annret:56.324,  sharpe:3.156
                  0         1         2         3  portfolio
0          1.000000  0.594995  0.694376  0.670582   0.776636
1          0.594995  1.000000  0.688338  0.656918   0.794863
2          0.694376  0.688338  1.000000  0.682887   0.800050
3          0.670582  0.656918  0.682887  1.000000   0.688878
portfolio  0.776636  0.794863  0.800050  0.688878   1.000000
test
0:  annret:14.237,  sharpe:0.986
1:  annret:14.402,  sharpe:1.012
2:  annret:20.831,  sharpe:1.012
3:  annret:19.250,  sharpe:0.965
portfolio:  annret:21.719,  sharpe:1.778
                  0         1         2         3  portfolio
0          1.000000  0.535110  0.735459  0.707132   0.766519
1          0.535110  1.000000  0.780682  0.743808   0.752810
2          0.735459  0.780682  1.000000  0.853032   0.823483
3          0.707132  0.743808  0.853032  1.000000   0.776610
portfolio  0.766519  0.752810  0.823483  0.776610   1.000000
------------------
Timestep 147000, Reward: 424.37300594325234, TD Loss: 157.5090060261005
test
0:  annret:18.933,  sharpe:0.783
1:  annret:9.742,  sharpe:0.686
2:  annret:14.809,  sharpe:0.754
3:  annret:14.809,  sharpe:0.679
          0         1         2         3
0  1.000000  0.751856  0.911226  0.948714
1  0.751856  1.000000  0.798986  0.765338
2  0.911226  0.798986  1.000000  0.910009
3  0.948714  0.765338  0.910009  1.000000
train
0:  annret:14.435,  sharpe:0.494
1:  annret:23.205,  sharpe:1.225
2:  annret:31.357,  sharpe:1.336
3:  annret:26.712,  sharpe:1.080
portfolio:  annret:39.348,  sharpe:1.985
                  0         1         2         3  portfolio
0          1.000000  0.570404  0.733595  0.814056   0.834624
1          0.570404  1.000000  0.628367  0.595472   0.747399
2          0.733595  0.628367  1.000000  0.701417   0.848156
3          0.814056  0.595472  0.701417  1.000000   0.827423
portfolio  0.834624  0.747399  0.848156  0.827423   1.000000
test
0:  annret:18.933,  sharpe:0.783
1:  annret:9.742,  sharpe:0.686
2:  annret:14.809,  sharpe:0.754
3:  annret:14.809,  sharpe:0.679
portfolio:  annret:14.380,  sharpe:0.906
                  0         1         2         3  portfolio
0          1.000000  0.751856  0.911226  0.948714   0.920863
1          0.751856  1.000000  0.798986  0.765338   0.809654
2          0.911226  0.798986  1.000000  0.910009   0.931734
3          0.948714  0.765338  0.910009  1.000000   0.914273
portfolio  0.920863  0.809654  0.931734  0.914273   1.000000
------------------
0:  annret:18.943,  sharpe:0.857
1:  annret:17.272,  sharpe:0.844
2:  annret:28.095,  sharpe:1.283
3:  annret:27.908,  sharpe:1.316
          0         1         2         3
0  1.000000  0.532340  0.537490  0.357587
1  0.532340  1.000000  0.491197  0.474634
2  0.537490  0.491197  1.000000  0.504964
3  0.357587  0.474634  0.504964  1.000000
Timestep 148000, Reward: 482.6518831613926, TD Loss: 9.196639251923436
test
0:  annret:8.865,  sharpe:0.566
1:  annret:18.147,  sharpe:1.391
2:  annret:18.657,  sharpe:0.931
3:  annret:15.165,  sharpe:0.835
          0         1         2         3
0  1.000000 -0.499690 -0.739201 -0.658189
1 -0.499690  1.000000  0.692925  0.649560
2 -0.739201  0.692925  1.000000  0.789438
3 -0.658189  0.649560  0.789438  1.000000
train
0:  annret:37.045,  sharpe:1.875
1:  annret:38.461,  sharpe:2.031
2:  annret:42.107,  sharpe:1.740
3:  annret:45.909,  sharpe:2.074
portfolio:  annret:60.875,  sharpe:3.603
                  0         1         2         3  portfolio
0          1.000000 -0.188274 -0.383208 -0.325604   0.035602
1         -0.188274  1.000000  0.612729  0.578654   0.769665
2         -0.383208  0.612729  1.000000  0.614264   0.736681
3         -0.325604  0.578654  0.614264  1.000000   0.654442
portfolio  0.035602  0.769665  0.736681  0.654442   1.000000
test
0:  annret:8.865,  sharpe:0.566
1:  annret:18.147,  sharpe:1.391
2:  annret:18.657,  sharpe:0.931
3:  annret:15.165,  sharpe:0.835
portfolio:  annret:20.493,  sharpe:1.853
                  0         1         2         3  portfolio
0          1.000000 -0.499690 -0.739201 -0.658189  -0.410372
1         -0.499690  1.000000  0.692925  0.649560   0.725957
2         -0.739201  0.692925  1.000000  0.789438   0.740260
3         -0.658189  0.649560  0.789438  1.000000   0.774155
portfolio -0.410372  0.725957  0.740260  0.774155   1.000000
------------------
Timestep 149000, Reward: 482.6518831613926, TD Loss: 15.757018676235322
test
0:  annret:17.171,  sharpe:0.753
1:  annret:16.610,  sharpe:0.763
2:  annret:16.504,  sharpe:0.815
3:  annret:15.225,  sharpe:0.634
          0         1         2         3
0  1.000000  0.848370  0.906109  0.897876
1  0.848370  1.000000  0.893268  0.911839
2  0.906109  0.893268  1.000000  0.909851
3  0.897876  0.911839  0.909851  1.000000
train
0:  annret:23.404,  sharpe:0.848
1:  annret:23.684,  sharpe:0.911
2:  annret:39.247,  sharpe:1.616
3:  annret:24.884,  sharpe:0.909
portfolio:  annret:37.804,  sharpe:1.670
                  0         1         2         3  portfolio
0          1.000000  0.810615  0.775737  0.795818   0.878267
1          0.810615  1.000000  0.747576  0.798412   0.887839
2          0.775737  0.747576  1.000000  0.714882   0.880805
3          0.795818  0.798412  0.714882  1.000000   0.838121
portfolio  0.878267  0.887839  0.880805  0.838121   1.000000
test
0:  annret:17.171,  sharpe:0.753
1:  annret:16.610,  sharpe:0.763
2:  annret:16.504,  sharpe:0.815
3:  annret:15.225,  sharpe:0.634
portfolio:  annret:18.984,  sharpe:1.069
                  0         1         2         3  portfolio
0          1.000000  0.848370  0.906109  0.897876   0.911874
1          0.848370  1.000000  0.893268  0.911839   0.913569
2          0.906109  0.893268  1.000000  0.909851   0.941106
3          0.897876  0.911839  0.909851  1.000000   0.926804
portfolio  0.911874  0.913569  0.941106  0.926804   1.000000
------------------
Timestep 150000, Reward: 482.6518831613926, TD Loss: 16.615288715116108
test
0:  annret:10.528,  sharpe:0.944
1:  annret:14.117,  sharpe:0.795
2:  annret:9.899,  sharpe:1.040
3:  annret:10.975,  sharpe:0.660
          0         1         2         3
0  1.000000 -0.083663 -0.156555  0.130196
1 -0.083663  1.000000  0.557852  0.727017
2 -0.156555  0.557852  1.000000  0.376723
3  0.130196  0.727017  0.376723  1.000000
train
0:  annret:33.299,  sharpe:2.118
1:  annret:29.577,  sharpe:1.363
2:  annret:42.559,  sharpe:2.570
3:  annret:40.927,  sharpe:1.955
portfolio:  annret:56.302,  sharpe:3.553
                  0         1         2         3  portfolio
0          1.000000  0.055856  0.275487  0.301529   0.501738
1          0.055856  1.000000  0.433509  0.554492   0.683962
2          0.275487  0.433509  1.000000  0.430957   0.709814
3          0.301529  0.554492  0.430957  1.000000   0.672593
portfolio  0.501738  0.683962  0.709814  0.672593   1.000000
test
0:  annret:10.528,  sharpe:0.944
1:  annret:14.117,  sharpe:0.795
2:  annret:9.899,  sharpe:1.040
3:  annret:10.975,  sharpe:0.660
portfolio:  annret:17.004,  sharpe:1.711
                  0         1         2         3  portfolio
0          1.000000 -0.083663 -0.156555  0.130196   0.241121
1         -0.083663  1.000000  0.557852  0.727017   0.737372
2         -0.156555  0.557852  1.000000  0.376723   0.530628
3          0.130196  0.727017  0.376723  1.000000   0.733772
portfolio  0.241121  0.737372  0.530628  0.733772   1.000000
------------------
0:  annret:20.407,  sharpe:0.955
1:  annret:15.550,  sharpe:0.728
2:  annret:29.701,  sharpe:1.434
3:  annret:28.007,  sharpe:1.285
          0         1         2         3
0  1.000000  0.518580  0.499853  0.432675
1  0.518580  1.000000  0.504291  0.480983
2  0.499853  0.504291  1.000000  0.474252
3  0.432675  0.480983  0.474252  1.000000
Timestep 151000, Reward: 465.8265821773513, TD Loss: 21.480955912823067
test
0:  annret:18.607,  sharpe:0.862
1:  annret:18.530,  sharpe:0.834
2:  annret:16.455,  sharpe:0.786
3:  annret:15.348,  sharpe:0.678
          0         1         2         3
0  1.000000  0.844951  0.905709  0.860646
1  0.844951  1.000000  0.914953  0.890444
2  0.905709  0.914953  1.000000  0.866692
3  0.860646  0.890444  0.866692  1.000000
train
0:  annret:24.536,  sharpe:0.928
1:  annret:26.367,  sharpe:0.997
2:  annret:37.029,  sharpe:1.507
3:  annret:37.842,  sharpe:1.463
portfolio:  annret:40.265,  sharpe:1.802
                  0         1         2         3  portfolio
0          1.000000  0.795815  0.806240  0.739752   0.877395
1          0.795815  1.000000  0.781011  0.704982   0.880260
2          0.806240  0.781011  1.000000  0.692037   0.890521
3          0.739752  0.704982  0.692037  1.000000   0.799828
portfolio  0.877395  0.880260  0.890521  0.799828   1.000000
test
0:  annret:18.607,  sharpe:0.862
1:  annret:18.530,  sharpe:0.834
2:  annret:16.455,  sharpe:0.786
3:  annret:15.348,  sharpe:0.678
portfolio:  annret:24.161,  sharpe:1.390
                  0         1         2         3  portfolio
0          1.000000  0.844951  0.905709  0.860646   0.909260
1          0.844951  1.000000  0.914953  0.890444   0.920553
2          0.905709  0.914953  1.000000  0.866692   0.927206
3          0.860646  0.890444  0.866692  1.000000   0.912233
portfolio  0.909260  0.920553  0.927206  0.912233   1.000000
------------------
Timestep 152000, Reward: 465.8265821773513, TD Loss: 32.01665543852796
test
0:  annret:13.064,  sharpe:0.958
1:  annret:14.877,  sharpe:0.799
2:  annret:12.977,  sharpe:0.785
3:  annret:13.826,  sharpe:1.010
          0         1         2         3
0  1.000000  0.678177  0.809573  0.649553
1  0.678177  1.000000  0.844520  0.677175
2  0.809573  0.844520  1.000000  0.697182
3  0.649553  0.677175  0.697182  1.000000
train
0:  annret:35.552,  sharpe:1.994
1:  annret:27.810,  sharpe:1.218
2:  annret:44.490,  sharpe:2.082
3:  annret:42.024,  sharpe:2.150
portfolio:  annret:58.121,  sharpe:3.503
                  0         1         2         3  portfolio
0          1.000000  0.626809  0.732417  0.592187   0.666280
1          0.626809  1.000000  0.699615  0.500064   0.664201
2          0.732417  0.699615  1.000000  0.617613   0.822329
3          0.592187  0.500064  0.617613  1.000000   0.715843
portfolio  0.666280  0.664201  0.822329  0.715843   1.000000
test
0:  annret:13.064,  sharpe:0.958
1:  annret:14.877,  sharpe:0.799
2:  annret:12.977,  sharpe:0.785
3:  annret:13.826,  sharpe:1.010
portfolio:  annret:18.719,  sharpe:1.775
                  0         1         2         3  portfolio
0          1.000000  0.678177  0.809573  0.649553   0.667570
1          0.678177  1.000000  0.844520  0.677175   0.648828
2          0.809573  0.844520  1.000000  0.697182   0.736886
3          0.649553  0.677175  0.697182  1.000000   0.760257
portfolio  0.667570  0.648828  0.736886  0.760257   1.000000
------------------
0:  annret:20.948,  sharpe:0.977
1:  annret:17.913,  sharpe:0.771
2:  annret:36.284,  sharpe:1.792
3:  annret:34.850,  sharpe:1.677
          0         1         2         3
0  1.000000  0.318043  0.582363  0.515701
1  0.318043  1.000000  0.372178  0.397765
2  0.582363  0.372178  1.000000  0.465141
3  0.515701  0.397765  0.465141  1.000000
Timestep 153000, Reward: 506.0914915689052, TD Loss: 26.354715202111436
test
0:  annret:19.321,  sharpe:0.903
1:  annret:16.922,  sharpe:0.760
2:  annret:18.729,  sharpe:0.853
3:  annret:13.557,  sharpe:0.618
          0         1         2         3
0  1.000000  0.873601  0.925842  0.875727
1  0.873601  1.000000  0.942329  0.895813
2  0.925842  0.942329  1.000000  0.897054
3  0.875727  0.895813  0.897054  1.000000
train
0:  annret:22.159,  sharpe:0.838
1:  annret:19.503,  sharpe:0.731
2:  annret:29.618,  sharpe:1.142
3:  annret:34.327,  sharpe:1.360
portfolio:  annret:39.700,  sharpe:1.811
                  0         1         2         3  portfolio
0          1.000000  0.824474  0.834766  0.766579   0.876705
1          0.824474  1.000000  0.815479  0.723886   0.881957
2          0.834766  0.815479  1.000000  0.736827   0.900177
3          0.766579  0.723886  0.736827  1.000000   0.795620
portfolio  0.876705  0.881957  0.900177  0.795620   1.000000
test
0:  annret:19.321,  sharpe:0.903
1:  annret:16.922,  sharpe:0.760
2:  annret:18.729,  sharpe:0.853
3:  annret:13.557,  sharpe:0.618
portfolio:  annret:24.781,  sharpe:1.469
                  0         1         2         3  portfolio
0          1.000000  0.873601  0.925842  0.875727   0.910850
1          0.873601  1.000000  0.942329  0.895813   0.913673
2          0.925842  0.942329  1.000000  0.897054   0.930264
3          0.875727  0.895813  0.897054  1.000000   0.908758
portfolio  0.910850  0.913673  0.930264  0.908758   1.000000
------------------
Timestep 154000, Reward: 506.0914915689052, TD Loss: 23.815744252925434
test
0:  annret:17.961,  sharpe:1.149
1:  annret:5.741,  sharpe:0.626
2:  annret:12.866,  sharpe:1.038
3:  annret:8.174,  sharpe:0.509
          0         1         2         3
0  1.000000  0.262725  0.750549  0.771037
1  0.262725  1.000000  0.349855  0.355263
2  0.750549  0.349855  1.000000  0.645776
3  0.771037  0.355263  0.645776  1.000000
train
0:  annret:37.536,  sharpe:1.869
1:  annret:33.939,  sharpe:2.182
2:  annret:44.818,  sharpe:2.421
3:  annret:35.423,  sharpe:1.715
portfolio:  annret:58.753,  sharpe:3.865
                  0         1         2         3  portfolio
0          1.000000  0.403990  0.650554  0.699031   0.584842
1          0.403990  1.000000  0.578872  0.478922   0.687727
2          0.650554  0.578872  1.000000  0.511340   0.661143
3          0.699031  0.478922  0.511340  1.000000   0.574179
portfolio  0.584842  0.687727  0.661143  0.574179   1.000000
test
0:  annret:17.961,  sharpe:1.149
1:  annret:5.741,  sharpe:0.626
2:  annret:12.866,  sharpe:1.038
3:  annret:8.174,  sharpe:0.509
portfolio:  annret:16.532,  sharpe:1.955
                  0         1         2         3  portfolio
0          1.000000  0.262725  0.750549  0.771037   0.408509
1          0.262725  1.000000  0.349855  0.355263   0.271834
2          0.750549  0.349855  1.000000  0.645776   0.342515
3          0.771037  0.355263  0.645776  1.000000   0.371493
portfolio  0.408509  0.271834  0.342515  0.371493   1.000000
------------------
0:  annret:23.840,  sharpe:1.077
1:  annret:16.559,  sharpe:0.782
2:  annret:31.456,  sharpe:1.503
3:  annret:29.808,  sharpe:1.397
          0         1         2         3
0  1.000000  0.422041  0.442461  0.396060
1  0.422041  1.000000  0.542486  0.492723
2  0.442461  0.542486  1.000000  0.434054
3  0.396060  0.492723  0.434054  1.000000
Timestep 155000, Reward: 477.9974483627036, TD Loss: 7.529547480193941
test
0:  annret:8.648,  sharpe:0.825
1:  annret:12.722,  sharpe:1.172
2:  annret:12.602,  sharpe:1.260
3:  annret:11.209,  sharpe:0.626
          0         1         2         3
0  1.000000 -0.032987  0.398825  0.503798
1 -0.032987  1.000000  0.202472  0.409780
2  0.398825  0.202472  1.000000  0.391015
3  0.503798  0.409780  0.391015  1.000000
train
0:  annret:36.469,  sharpe:2.361
1:  annret:27.584,  sharpe:1.817
2:  annret:49.609,  sharpe:3.145
3:  annret:46.891,  sharpe:2.172
portfolio:  annret:66.388,  sharpe:4.525
                  0         1         2         3  portfolio
0          1.000000  0.227591  0.339138  0.441510   0.576156
1          0.227591  1.000000  0.262042  0.416696   0.464280
2          0.339138  0.262042  1.000000  0.301694   0.609882
3          0.441510  0.416696  0.301694  1.000000   0.489252
portfolio  0.576156  0.464280  0.609882  0.489252   1.000000
test
0:  annret:8.648,  sharpe:0.825
1:  annret:12.722,  sharpe:1.172
2:  annret:12.602,  sharpe:1.260
3:  annret:11.209,  sharpe:0.626
portfolio:  annret:21.030,  sharpe:2.393
                  0         1         2         3  portfolio
0          1.000000 -0.032987  0.398825  0.503798   0.538171
1         -0.032987  1.000000  0.202472  0.409780   0.114884
2          0.398825  0.202472  1.000000  0.391015   0.366983
3          0.503798  0.409780  0.391015  1.000000   0.361663
portfolio  0.538171  0.114884  0.366983  0.361663   1.000000
------------------
Timestep 156000, Reward: 477.9974483627036, TD Loss: 10.30735457557899
test
0:  annret:10.065,  sharpe:0.811
1:  annret:17.565,  sharpe:0.824
2:  annret:14.348,  sharpe:0.774
3:  annret:13.689,  sharpe:0.755
          0         1         2         3
0  1.000000  0.686459  0.695139  0.693724
1  0.686459  1.000000  0.902109  0.848317
2  0.695139  0.902109  1.000000  0.815613
3  0.693724  0.848317  0.815613  1.000000
train
0:  annret:42.597,  sharpe:2.393
1:  annret:17.827,  sharpe:0.695
2:  annret:37.362,  sharpe:1.685
3:  annret:32.004,  sharpe:1.416
portfolio:  annret:51.751,  sharpe:2.902
                  0         1         2         3  portfolio
0          1.000000  0.604622  0.682883  0.612990   0.823644
1          0.604622  1.000000  0.714870  0.618250   0.721227
2          0.682883  0.714870  1.000000  0.645095   0.800574
3          0.612990  0.618250  0.645095  1.000000   0.693017
portfolio  0.823644  0.721227  0.800574  0.693017   1.000000
test
0:  annret:10.065,  sharpe:0.811
1:  annret:17.565,  sharpe:0.824
2:  annret:14.348,  sharpe:0.774
3:  annret:13.689,  sharpe:0.755
portfolio:  annret:18.460,  sharpe:1.470
                  0         1         2         3  portfolio
0          1.000000  0.686459  0.695139  0.693724   0.797677
1          0.686459  1.000000  0.902109  0.848317   0.809051
2          0.695139  0.902109  1.000000  0.815613   0.806284
3          0.693724  0.848317  0.815613  1.000000   0.820096
portfolio  0.797677  0.809051  0.806284  0.820096   1.000000
------------------
0:  annret:25.783,  sharpe:1.241
1:  annret:19.092,  sharpe:0.858
2:  annret:31.839,  sharpe:1.585
3:  annret:19.684,  sharpe:0.928
          0         1         2         3
0  1.000000  0.448119  0.433004  0.474981
1  0.448119  1.000000  0.446114  0.366200
2  0.433004  0.446114  1.000000  0.404638
3  0.474981  0.366200  0.404638  1.000000
Timestep 157000, Reward: 463.3218759243162, TD Loss: 28.59739093411748
test
0:  annret:18.978,  sharpe:1.141
1:  annret:7.782,  sharpe:0.701
2:  annret:14.767,  sharpe:1.422
3:  annret:10.972,  sharpe:0.784
          0         1         2         3
0  1.000000 -0.537362  0.620892  0.691387
1 -0.537362  1.000000 -0.147929 -0.529002
2  0.620892 -0.147929  1.000000  0.451687
3  0.691387 -0.529002  0.451687  1.000000
train
0:  annret:31.905,  sharpe:1.578
1:  annret:39.592,  sharpe:2.483
2:  annret:47.123,  sharpe:2.882
3:  annret:35.364,  sharpe:1.790
portfolio:  annret:61.913,  sharpe:4.188
                  0         1         2         3  portfolio
0          1.000000 -0.213502  0.435265  0.587038   0.433174
1         -0.213502  1.000000  0.233635 -0.013909   0.542448
2          0.435265  0.233635  1.000000  0.422020   0.661658
3          0.587038 -0.013909  0.422020  1.000000   0.537313
portfolio  0.433174  0.542448  0.661658  0.537313   1.000000
test
0:  annret:18.978,  sharpe:1.141
1:  annret:7.782,  sharpe:0.701
2:  annret:14.767,  sharpe:1.422
3:  annret:10.972,  sharpe:0.784
portfolio:  annret:18.613,  sharpe:2.107
                  0         1         2         3  portfolio
0          1.000000 -0.537362  0.620892  0.691387   0.349113
1         -0.537362  1.000000 -0.147929 -0.529002   0.212268
2          0.620892 -0.147929  1.000000  0.451687   0.502059
3          0.691387 -0.529002  0.451687  1.000000   0.408252
portfolio  0.349113  0.212268  0.502059  0.408252   1.000000
------------------
Timestep 158000, Reward: 463.3218759243162, TD Loss: 61.67026940758233
test
0:  annret:6.513,  sharpe:0.501
1:  annret:18.343,  sharpe:0.824
2:  annret:-0.407,  sharpe:-0.032
3:  annret:-7.467,  sharpe:-0.358
          0         1         2         3
0  1.000000 -0.640124  0.571005  0.665724
1 -0.640124  1.000000 -0.731025 -0.908245
2  0.571005 -0.731025  1.000000  0.748557
3  0.665724 -0.908245  0.748557  1.000000
train
0:  annret:32.032,  sharpe:1.804
1:  annret:16.589,  sharpe:0.625
2:  annret:37.278,  sharpe:2.001
3:  annret:21.760,  sharpe:0.872
portfolio:  annret:57.961,  sharpe:3.729
                  0         1         2         3  portfolio
0          1.000000 -0.374451  0.626924  0.535749   0.650606
1         -0.374451  1.000000 -0.440069 -0.707818  -0.000274
2          0.626924 -0.440069  1.000000  0.597496   0.721378
3          0.535749 -0.707818  0.597496  1.000000   0.464789
portfolio  0.650606 -0.000274  0.721378  0.464789   1.000000
test
0:  annret:6.513,  sharpe:0.501
1:  annret:18.343,  sharpe:0.824
2:  annret:-0.407,  sharpe:-0.032
3:  annret:-7.467,  sharpe:-0.358
portfolio:  annret:15.505,  sharpe:1.821
                  0         1         2         3  portfolio
0          1.000000 -0.640124  0.571005  0.665724   0.518630
1         -0.640124  1.000000 -0.731025 -0.908245  -0.271813
2          0.571005 -0.731025  1.000000  0.748557   0.626624
3          0.665724 -0.908245  0.748557  1.000000   0.475783
portfolio  0.518630 -0.271813  0.626624  0.475783   1.000000
------------------
0:  annret:19.742,  sharpe:0.898
1:  annret:18.719,  sharpe:0.839
2:  annret:32.415,  sharpe:1.589
3:  annret:24.421,  sharpe:1.074
          0         1         2         3
0  1.000000  0.362041  0.486520  0.336567
1  0.362041  1.000000  0.468346  0.017262
2  0.486520  0.468346  1.000000  0.282117
3  0.336567  0.017262  0.282117  1.000000
Timestep 159000, Reward: 471.03060907354137, TD Loss: 7.4798379615777355
test
0:  annret:19.691,  sharpe:1.032
1:  annret:14.229,  sharpe:0.695
2:  annret:19.854,  sharpe:1.116
3:  annret:14.251,  sharpe:0.888
          0         1         2         3
0  1.000000  0.786378  0.822854  0.737075
1  0.786378  1.000000  0.852120  0.694777
2  0.822854  0.852120  1.000000  0.663640
3  0.737075  0.694777  0.663640  1.000000
train
0:  annret:30.552,  sharpe:1.347
1:  annret:21.666,  sharpe:0.884
2:  annret:41.157,  sharpe:1.878
3:  annret:39.853,  sharpe:1.952
portfolio:  annret:53.224,  sharpe:3.148
                  0         1         2         3  portfolio
0          1.000000  0.758706  0.683937  0.620649   0.737602
1          0.758706  1.000000  0.709684  0.505561   0.737397
2          0.683937  0.709684  1.000000  0.456842   0.752631
3          0.620649  0.505561  0.456842  1.000000   0.622708
portfolio  0.737602  0.737397  0.752631  0.622708   1.000000
test
0:  annret:19.691,  sharpe:1.032
1:  annret:14.229,  sharpe:0.695
2:  annret:19.854,  sharpe:1.116
3:  annret:14.251,  sharpe:0.888
portfolio:  annret:19.796,  sharpe:1.719
                  0         1         2         3  portfolio
0          1.000000  0.786378  0.822854  0.737075   0.802157
1          0.786378  1.000000  0.852120  0.694777   0.745789
2          0.822854  0.852120  1.000000  0.663640   0.775329
3          0.737075  0.694777  0.663640  1.000000   0.715355
portfolio  0.802157  0.745789  0.775329  0.715355   1.000000
------------------
Timestep 160000, Reward: 471.03060907354137, TD Loss: 81.75380522574858
test
0:  annret:21.119,  sharpe:0.896
1:  annret:19.030,  sharpe:0.794
2:  annret:17.931,  sharpe:0.809
3:  annret:15.794,  sharpe:0.655
          0         1         2         3
0  1.000000  0.949281  0.953747  0.945144
1  0.949281  1.000000  0.969153  0.957468
2  0.953747  0.969153  1.000000  0.944580
3  0.945144  0.957468  0.944580  1.000000
train
0:  annret:16.476,  sharpe:0.574
1:  annret:12.841,  sharpe:0.451
2:  annret:25.852,  sharpe:0.990
3:  annret:26.312,  sharpe:0.958
portfolio:  annret:24.504,  sharpe:0.909
                  0         1         2         3  portfolio
0          1.000000  0.917570  0.847090  0.860629   0.959359
1          0.917570  1.000000  0.848299  0.851871   0.962627
2          0.847090  0.848299  1.000000  0.781873   0.902764
3          0.860629  0.851871  0.781873  1.000000   0.903279
portfolio  0.959359  0.962627  0.902764  0.903279   1.000000
test
0:  annret:21.119,  sharpe:0.896
1:  annret:19.030,  sharpe:0.794
2:  annret:17.931,  sharpe:0.809
3:  annret:15.794,  sharpe:0.655
portfolio:  annret:20.690,  sharpe:0.913
                  0         1         2         3  portfolio
0          1.000000  0.949281  0.953747  0.945144   0.970783
1          0.949281  1.000000  0.969153  0.957468   0.978909
2          0.953747  0.969153  1.000000  0.944580   0.979152
3          0.945144  0.957468  0.944580  1.000000   0.968327
portfolio  0.970783  0.978909  0.979152  0.968327   1.000000
------------------
0:  annret:21.591,  sharpe:1.038
1:  annret:14.832,  sharpe:0.672
2:  annret:35.147,  sharpe:1.752
3:  annret:21.671,  sharpe:0.984
          0         1         2         3
0  1.000000  0.464251  0.321036  0.477230
1  0.464251  1.000000  0.454249  0.453167
2  0.321036  0.454249  1.000000  0.375054
3  0.477230  0.453167  0.375054  1.000000
Timestep 161000, Reward: 451.599729931674, TD Loss: 22.1806287859678
test
0:  annret:-3.983,  sharpe:-0.178
1:  annret:10.847,  sharpe:1.030
2:  annret:0.276,  sharpe:0.030
3:  annret:11.802,  sharpe:0.787
          0         1         2         3
0  1.000000 -0.563435  0.524778 -0.617411
1 -0.563435  1.000000 -0.192716  0.497327
2  0.524778 -0.192716  1.000000 -0.323267
3 -0.617411  0.497327 -0.323267  1.000000
train
0:  annret:21.096,  sharpe:0.810
1:  annret:39.733,  sharpe:2.515
2:  annret:37.176,  sharpe:2.236
3:  annret:55.028,  sharpe:2.737
portfolio:  annret:63.709,  sharpe:4.309
                  0         1         2         3  portfolio
0          1.000000 -0.244976  0.413931 -0.332319   0.287899
1         -0.244976  1.000000  0.179835  0.541615   0.592195
2          0.413931  0.179835  1.000000  0.056566   0.550552
3         -0.332319  0.541615  0.056566  1.000000   0.581008
portfolio  0.287899  0.592195  0.550552  0.581008   1.000000
test
0:  annret:-3.983,  sharpe:-0.178
1:  annret:10.847,  sharpe:1.030
2:  annret:0.276,  sharpe:0.030
3:  annret:11.802,  sharpe:0.787
portfolio:  annret:13.306,  sharpe:1.633
                  0         1         2         3  portfolio
0          1.000000 -0.563435  0.524778 -0.617411   0.085006
1         -0.563435  1.000000 -0.192716  0.497327   0.295440
2          0.524778 -0.192716  1.000000 -0.323267   0.233223
3         -0.617411  0.497327 -0.323267  1.000000   0.468147
portfolio  0.085006  0.295440  0.233223  0.468147   1.000000
------------------
Timestep 162000, Reward: 451.599729931674, TD Loss: 7.584893228101902
test
0:  annret:18.792,  sharpe:0.886
1:  annret:14.525,  sharpe:0.676
2:  annret:17.420,  sharpe:0.815
3:  annret:16.238,  sharpe:0.724
          0         1         2         3
0  1.000000  0.845192  0.899067  0.872228
1  0.845192  1.000000  0.906046  0.881410
2  0.899067  0.906046  1.000000  0.877688
3  0.872228  0.881410  0.877688  1.000000
train
0:  annret:28.213,  sharpe:1.086
1:  annret:25.323,  sharpe:0.988
2:  annret:35.736,  sharpe:1.408
3:  annret:34.598,  sharpe:1.359
portfolio:  annret:42.563,  sharpe:2.015
                  0         1         2         3  portfolio
0          1.000000  0.808024  0.786473  0.768462   0.882560
1          0.808024  1.000000  0.762488  0.718100   0.872314
2          0.786473  0.762488  1.000000  0.682956   0.873039
3          0.768462  0.718100  0.682956  1.000000   0.801309
portfolio  0.882560  0.872314  0.873039  0.801309   1.000000
test
0:  annret:18.792,  sharpe:0.886
1:  annret:14.525,  sharpe:0.676
2:  annret:17.420,  sharpe:0.815
3:  annret:16.238,  sharpe:0.724
portfolio:  annret:22.495,  sharpe:1.363
                  0         1         2         3  portfolio
0          1.000000  0.845192  0.899067  0.872228   0.897865
1          0.845192  1.000000  0.906046  0.881410   0.908550
2          0.899067  0.906046  1.000000  0.877688   0.920856
3          0.872228  0.881410  0.877688  1.000000   0.902744
portfolio  0.897865  0.908550  0.920856  0.902744   1.000000
------------------
Timestep 163000, Reward: 451.599729931674, TD Loss: 20.906240502074375
test
0:  annret:7.847,  sharpe:0.714
1:  annret:10.610,  sharpe:1.197
2:  annret:14.290,  sharpe:0.777
3:  annret:13.560,  sharpe:0.848
          0         1         2         3
0  1.000000 -0.035651 -0.390734 -0.179293
1 -0.035651  1.000000  0.242770  0.243545
2 -0.390734  0.242770  1.000000  0.697370
3 -0.179293  0.243545  0.697370  1.000000
train
0:  annret:39.138,  sharpe:2.512
1:  annret:37.476,  sharpe:2.424
2:  annret:41.773,  sharpe:1.816
3:  annret:41.171,  sharpe:2.000
portfolio:  annret:63.551,  sharpe:4.222
                  0         1         2         3  portfolio
0          1.000000  0.298357 -0.032126  0.100072   0.555100
1          0.298357  1.000000  0.284821  0.457584   0.632001
2         -0.032126  0.284821  1.000000  0.459160   0.493104
3          0.100072  0.457584  0.459160  1.000000   0.538283
portfolio  0.555100  0.632001  0.493104  0.538283   1.000000
test
0:  annret:7.847,  sharpe:0.714
1:  annret:10.610,  sharpe:1.197
2:  annret:14.290,  sharpe:0.777
3:  annret:13.560,  sharpe:0.848
portfolio:  annret:15.978,  sharpe:2.028
                  0         1         2         3  portfolio
0          1.000000 -0.035651 -0.390734 -0.179293   0.350588
1         -0.035651  1.000000  0.242770  0.243545   0.429310
2         -0.390734  0.242770  1.000000  0.697370   0.245418
3         -0.179293  0.243545  0.697370  1.000000   0.369958
portfolio  0.350588  0.429310  0.245418  0.369958   1.000000
------------------
0:  annret:23.124,  sharpe:1.055
1:  annret:19.670,  sharpe:0.949
2:  annret:24.355,  sharpe:1.099
3:  annret:26.435,  sharpe:1.200
          0         1         2         3
0  1.000000  0.565667  0.379889  0.491717
1  0.565667  1.000000  0.421486  0.511687
2  0.379889  0.421486  1.000000  0.508946
3  0.491717  0.511687  0.508946  1.000000
Timestep 164000, Reward: 494.8975196901516, TD Loss: 21.37099665680166
test
0:  annret:23.465,  sharpe:1.071
1:  annret:16.148,  sharpe:0.745
2:  annret:15.046,  sharpe:0.704
3:  annret:17.667,  sharpe:0.778
          0         1         2         3
0  1.000000  0.840856  0.899577  0.878739
1  0.840856  1.000000  0.902337  0.895819
2  0.899577  0.902337  1.000000  0.868088
3  0.878739  0.895819  0.868088  1.000000
train
0:  annret:27.345,  sharpe:1.017
1:  annret:22.594,  sharpe:0.871
2:  annret:41.144,  sharpe:1.627
3:  annret:35.177,  sharpe:1.350
portfolio:  annret:41.065,  sharpe:1.875
                  0         1         2         3  portfolio
0          1.000000  0.813653  0.774388  0.794648   0.885931
1          0.813653  1.000000  0.745110  0.756167   0.877526
2          0.774388  0.745110  1.000000  0.667170   0.854332
3          0.794648  0.756167  0.667170  1.000000   0.849323
portfolio  0.885931  0.877526  0.854332  0.849323   1.000000
test
0:  annret:23.465,  sharpe:1.071
1:  annret:16.148,  sharpe:0.745
2:  annret:15.046,  sharpe:0.704
3:  annret:17.667,  sharpe:0.778
portfolio:  annret:20.549,  sharpe:1.196
                  0         1         2         3  portfolio
0          1.000000  0.840856  0.899577  0.878739   0.909407
1          0.840856  1.000000  0.902337  0.895819   0.910517
2          0.899577  0.902337  1.000000  0.868088   0.915605
3          0.878739  0.895819  0.868088  1.000000   0.923447
portfolio  0.909407  0.910517  0.915605  0.923447   1.000000
------------------
Timestep 165000, Reward: 494.8975196901516, TD Loss: 5.045886999231884
test
0:  annret:6.811,  sharpe:0.710
1:  annret:0.733,  sharpe:0.091
2:  annret:15.752,  sharpe:0.872
3:  annret:11.221,  sharpe:0.634
          0         1         2         3
0  1.000000  0.098413  0.460845  0.429669
1  0.098413  1.000000 -0.035166  0.033759
2  0.460845 -0.035166  1.000000  0.738036
3  0.429669  0.033759  0.738036  1.000000
train
0:  annret:36.045,  sharpe:2.412
1:  annret:31.670,  sharpe:2.113
2:  annret:42.737,  sharpe:1.893
3:  annret:37.000,  sharpe:1.686
portfolio:  annret:58.441,  sharpe:3.940
                  0         1         2         3  portfolio
0          1.000000  0.432659  0.470718  0.441618   0.678509
1          0.432659  1.000000  0.134486  0.296282   0.626687
2          0.470718  0.134486  1.000000  0.531309   0.571427
3          0.441618  0.296282  0.531309  1.000000   0.540014
portfolio  0.678509  0.626687  0.571427  0.540014   1.000000
test
0:  annret:6.811,  sharpe:0.710
1:  annret:0.733,  sharpe:0.091
2:  annret:15.752,  sharpe:0.872
3:  annret:11.221,  sharpe:0.634
portfolio:  annret:12.364,  sharpe:1.457
                  0         1         2         3  portfolio
0          1.000000  0.098413  0.460845  0.429669   0.566100
1          0.098413  1.000000 -0.035166  0.033759   0.435746
2          0.460845 -0.035166  1.000000  0.738036   0.385929
3          0.429669  0.033759  0.738036  1.000000   0.447163
portfolio  0.566100  0.435746  0.385929  0.447163   1.000000
------------------
0:  annret:22.071,  sharpe:1.051
1:  annret:21.940,  sharpe:1.039
2:  annret:30.639,  sharpe:1.350
3:  annret:26.366,  sharpe:1.194
          0         1         2         3
0  1.000000  0.456249  0.336703  0.493189
1  0.456249  1.000000  0.356961  0.443310
2  0.336703  0.356961  1.000000  0.453057
3  0.493189  0.443310  0.453057  1.000000
Timestep 166000, Reward: 496.6019744949022, TD Loss: 12.7386579812127
test
0:  annret:20.390,  sharpe:1.116
1:  annret:15.224,  sharpe:0.784
2:  annret:16.832,  sharpe:0.802
3:  annret:17.685,  sharpe:0.891
          0         1         2         3
0  1.000000  0.783328  0.880518  0.794914
1  0.783328  1.000000  0.883595  0.784168
2  0.880518  0.883595  1.000000  0.807175
3  0.794914  0.784168  0.807175  1.000000
train
0:  annret:32.455,  sharpe:1.470
1:  annret:27.494,  sharpe:1.164
2:  annret:37.405,  sharpe:1.485
3:  annret:40.434,  sharpe:1.722
portfolio:  annret:50.502,  sharpe:2.693
                  0         1         2         3  portfolio
0          1.000000  0.720177  0.763153  0.749389   0.806023
1          0.720177  1.000000  0.754265  0.637097   0.801726
2          0.763153  0.754265  1.000000  0.608338   0.820068
3          0.749389  0.637097  0.608338  1.000000   0.731698
portfolio  0.806023  0.801726  0.820068  0.731698   1.000000
test
0:  annret:20.390,  sharpe:1.116
1:  annret:15.224,  sharpe:0.784
2:  annret:16.832,  sharpe:0.802
3:  annret:17.685,  sharpe:0.891
portfolio:  annret:19.894,  sharpe:1.478
                  0         1         2         3  portfolio
0          1.000000  0.783328  0.880518  0.794914   0.859487
1          0.783328  1.000000  0.883595  0.784168   0.826098
2          0.880518  0.883595  1.000000  0.807175   0.854281
3          0.794914  0.784168  0.807175  1.000000   0.835471
portfolio  0.859487  0.826098  0.854281  0.835471   1.000000
------------------
Timestep 167000, Reward: 496.6019744949022, TD Loss: 25.524217810518326
test
0:  annret:4.795,  sharpe:0.543
1:  annret:12.930,  sharpe:0.722
2:  annret:13.120,  sharpe:0.648
3:  annret:7.598,  sharpe:0.476
          0         1         2         3
0  1.000000  0.199863  0.219099  0.145816
1  0.199863  1.000000  0.893621  0.769279
2  0.219099  0.893621  1.000000  0.741592
3  0.145816  0.769279  0.741592  1.000000
train
0:  annret:31.344,  sharpe:2.141
1:  annret:26.919,  sharpe:1.245
2:  annret:37.628,  sharpe:1.585
3:  annret:31.684,  sharpe:1.507
portfolio:  annret:56.964,  sharpe:3.504
                  0         1         2         3  portfolio
0          1.000000  0.364034  0.276921  0.325630   0.600211
1          0.364034  1.000000  0.749188  0.663821   0.666270
2          0.276921  0.749188  1.000000  0.568037   0.678588
3          0.325630  0.663821  0.568037  1.000000   0.646745
portfolio  0.600211  0.666270  0.678588  0.646745   1.000000
test
0:  annret:4.795,  sharpe:0.543
1:  annret:12.930,  sharpe:0.722
2:  annret:13.120,  sharpe:0.648
3:  annret:7.598,  sharpe:0.476
portfolio:  annret:14.407,  sharpe:1.396
                  0         1         2         3  portfolio
0          1.000000  0.199863  0.219099  0.145816   0.412689
1          0.199863  1.000000  0.893621  0.769279   0.634815
2          0.219099  0.893621  1.000000  0.741592   0.669249
3          0.145816  0.769279  0.741592  1.000000   0.694976
portfolio  0.412689  0.634815  0.669249  0.694976   1.000000
------------------
0:  annret:27.632,  sharpe:1.306
1:  annret:9.160,  sharpe:0.421
2:  annret:32.977,  sharpe:1.491
3:  annret:29.797,  sharpe:1.377
          0         1         2         3
0  1.000000  0.510458  0.465286  0.509768
1  0.510458  1.000000  0.506261  0.450422
2  0.465286  0.506261  1.000000  0.420023
3  0.509768  0.450422  0.420023  1.000000
Timestep 168000, Reward: 502.9849782740953, TD Loss: 12.333509879489643
test
0:  annret:-4.280,  sharpe:-0.303
1:  annret:17.823,  sharpe:0.857
2:  annret:10.546,  sharpe:0.584
3:  annret:18.031,  sharpe:0.906
          0         1         2         3
0  1.000000 -0.815921 -0.729435 -0.763686
1 -0.815921  1.000000  0.818590  0.774311
2 -0.729435  0.818590  1.000000  0.739707
3 -0.763686  0.774311  0.739707  1.000000
train
0:  annret:28.853,  sharpe:1.510
1:  annret:23.765,  sharpe:0.936
2:  annret:42.484,  sharpe:1.938
3:  annret:39.811,  sharpe:1.662
portfolio:  annret:62.168,  sharpe:3.830
                  0         1         2         3  portfolio
0          1.000000 -0.594290 -0.346092 -0.444517   0.025162
1         -0.594290  1.000000  0.646595  0.609906   0.592882
2         -0.346092  0.646595  1.000000  0.556407   0.657210
3         -0.444517  0.609906  0.556407  1.000000   0.583968
portfolio  0.025162  0.592882  0.657210  0.583968   1.000000
test
0:  annret:-4.280,  sharpe:-0.303
1:  annret:17.823,  sharpe:0.857
2:  annret:10.546,  sharpe:0.584
3:  annret:18.031,  sharpe:0.906
portfolio:  annret:18.411,  sharpe:1.890
                  0         1         2         3  portfolio
0          1.000000 -0.815921 -0.729435 -0.763686  -0.410144
1         -0.815921  1.000000  0.818590  0.774311   0.658872
2         -0.729435  0.818590  1.000000  0.739707   0.659550
3         -0.763686  0.774311  0.739707  1.000000   0.666539
portfolio -0.410144  0.658872  0.659550  0.666539   1.000000
------------------
Timestep 169000, Reward: 502.9849782740953, TD Loss: 19.354819735658207
test
0:  annret:2.746,  sharpe:0.286
1:  annret:17.557,  sharpe:0.951
2:  annret:14.660,  sharpe:0.730
3:  annret:8.366,  sharpe:0.576
          0         1         2         3
0  1.000000 -0.220734 -0.262269  0.013558
1 -0.220734  1.000000  0.870669  0.657361
2 -0.262269  0.870669  1.000000  0.725725
3  0.013558  0.657361  0.725725  1.000000
train
0:  annret:31.165,  sharpe:2.064
1:  annret:27.379,  sharpe:1.220
2:  annret:34.091,  sharpe:1.407
3:  annret:37.023,  sharpe:1.905
portfolio:  annret:56.456,  sharpe:3.403
                  0         1         2         3  portfolio
0          1.000000  0.087576  0.069462  0.389638   0.572128
1          0.087576  1.000000  0.718624  0.647450   0.638805
2          0.069462  0.718624  1.000000  0.621121   0.645663
3          0.389638  0.647450  0.621121  1.000000   0.744710
portfolio  0.572128  0.638805  0.645663  0.744710   1.000000
test
0:  annret:2.746,  sharpe:0.286
1:  annret:17.557,  sharpe:0.951
2:  annret:14.660,  sharpe:0.730
3:  annret:8.366,  sharpe:0.576
portfolio:  annret:16.106,  sharpe:1.668
                  0         1         2         3  portfolio
0          1.000000 -0.220734 -0.262269  0.013558   0.265729
1         -0.220734  1.000000  0.870669  0.657361   0.629716
2         -0.262269  0.870669  1.000000  0.725725   0.587657
3          0.013558  0.657361  0.725725  1.000000   0.668048
portfolio  0.265729  0.629716  0.587657  0.668048   1.000000
------------------
0:  annret:22.660,  sharpe:1.134
1:  annret:18.375,  sharpe:0.776
2:  annret:30.619,  sharpe:1.421
3:  annret:24.234,  sharpe:1.161
          0         1         2         3
0  1.000000  0.276208  0.330513  0.386753
1  0.276208  1.000000  0.480309  0.516957
2  0.330513  0.480309  1.000000  0.435865
3  0.386753  0.516957  0.435865  1.000000
Timestep 170000, Reward: 484.18041269057574, TD Loss: 13.81943681077315
test
0:  annret:19.202,  sharpe:1.444
1:  annret:12.777,  sharpe:1.100
2:  annret:10.343,  sharpe:0.911
3:  annret:16.653,  sharpe:1.074
          0         1         2         3
0  1.000000  0.358678  0.712996  0.727957
1  0.358678  1.000000  0.611860  0.404511
2  0.712996  0.611860  1.000000  0.616769
3  0.727957  0.404511  0.616769  1.000000
train
0:  annret:33.625,  sharpe:1.908
1:  annret:31.923,  sharpe:1.964
2:  annret:37.912,  sharpe:2.219
3:  annret:38.235,  sharpe:1.897
portfolio:  annret:58.264,  sharpe:3.777
                  0         1         2         3  portfolio
0          1.000000  0.324154  0.566457  0.659867   0.640294
1          0.324154  1.000000  0.508761  0.420017   0.579030
2          0.566457  0.508761  1.000000  0.493580   0.685483
3          0.659867  0.420017  0.493580  1.000000   0.671606
portfolio  0.640294  0.579030  0.685483  0.671606   1.000000
test
0:  annret:19.202,  sharpe:1.444
1:  annret:12.777,  sharpe:1.100
2:  annret:10.343,  sharpe:0.911
3:  annret:16.653,  sharpe:1.074
portfolio:  annret:18.126,  sharpe:1.940
                  0         1         2         3  portfolio
0          1.000000  0.358678  0.712996  0.727957   0.610493
1          0.358678  1.000000  0.611860  0.404511   0.499289
2          0.712996  0.611860  1.000000  0.616769   0.655989
3          0.727957  0.404511  0.616769  1.000000   0.649736
portfolio  0.610493  0.499289  0.655989  0.649736   1.000000
------------------
Timestep 171000, Reward: 484.18041269057574, TD Loss: 41.49226787265477
test
0:  annret:21.255,  sharpe:0.989
1:  annret:10.923,  sharpe:1.026
2:  annret:13.774,  sharpe:0.732
3:  annret:-6.438,  sharpe:-0.577
          0         1         2         3
0  1.000000  0.468110  0.915313  0.317804
1  0.468110  1.000000  0.526949  0.255995
2  0.915313  0.526949  1.000000  0.392590
3  0.317804  0.255995  0.392590  1.000000
train
0:  annret:28.105,  sharpe:1.073
1:  annret:27.757,  sharpe:1.643
2:  annret:35.316,  sharpe:1.507
3:  annret:29.661,  sharpe:1.690
portfolio:  annret:48.359,  sharpe:3.112
                  0         1         2         3  portfolio
0          1.000000  0.389639  0.812945  0.183415   0.537420
1          0.389639  1.000000  0.504566  0.457757   0.611736
2          0.812945  0.504566  1.000000  0.355845   0.724117
3          0.183415  0.457757  0.355845  1.000000   0.608404
portfolio  0.537420  0.611736  0.724117  0.608404   1.000000
test
0:  annret:21.255,  sharpe:0.989
1:  annret:10.923,  sharpe:1.026
2:  annret:13.774,  sharpe:0.732
3:  annret:-6.438,  sharpe:-0.577
portfolio:  annret:7.358,  sharpe:0.840
                  0         1         2         3  portfolio
0          1.000000  0.468110  0.915313  0.317804   0.523826
1          0.468110  1.000000  0.526949  0.255995   0.430467
2          0.915313  0.526949  1.000000  0.392590   0.625813
3          0.317804  0.255995  0.392590  1.000000   0.508299
portfolio  0.523826  0.430467  0.625813  0.508299   1.000000
------------------
0:  annret:21.315,  sharpe:0.983
1:  annret:10.708,  sharpe:0.509
2:  annret:31.084,  sharpe:1.564
3:  annret:22.527,  sharpe:1.075
          0         1         2         3
0  1.000000  0.524026  0.599539  0.382893
1  0.524026  1.000000  0.489708  0.535044
2  0.599539  0.489708  1.000000  0.339066
3  0.382893  0.535044  0.339066  1.000000
Timestep 172000, Reward: 446.4548522913995, TD Loss: 25.566031463966798
test
0:  annret:20.272,  sharpe:1.058
1:  annret:14.861,  sharpe:0.734
2:  annret:18.116,  sharpe:1.140
3:  annret:15.199,  sharpe:0.953
          0         1         2         3
0  1.000000  0.752696  0.807127  0.685670
1  0.752696  1.000000  0.771393  0.653315
2  0.807127  0.771393  1.000000  0.578545
3  0.685670  0.653315  0.578545  1.000000
train
0:  annret:31.362,  sharpe:1.342
1:  annret:27.186,  sharpe:1.109
2:  annret:48.451,  sharpe:2.364
3:  annret:40.075,  sharpe:1.904
portfolio:  annret:50.646,  sharpe:2.778
                  0         1         2         3  portfolio
0          1.000000  0.691315  0.704301  0.536092   0.775067
1          0.691315  1.000000  0.571890  0.424233   0.740906
2          0.704301  0.571890  1.000000  0.432698   0.795447
3          0.536092  0.424233  0.432698  1.000000   0.681632
portfolio  0.775067  0.740906  0.795447  0.681632   1.000000
test
0:  annret:20.272,  sharpe:1.058
1:  annret:14.861,  sharpe:0.734
2:  annret:18.116,  sharpe:1.140
3:  annret:15.199,  sharpe:0.953
portfolio:  annret:21.631,  sharpe:1.683
                  0         1         2         3  portfolio
0          1.000000  0.752696  0.807127  0.685670   0.828858
1          0.752696  1.000000  0.771393  0.653315   0.815401
2          0.807127  0.771393  1.000000  0.578545   0.831842
3          0.685670  0.653315  0.578545  1.000000   0.778540
portfolio  0.828858  0.815401  0.831842  0.778540   1.000000
------------------
Timestep 173000, Reward: 446.4548522913995, TD Loss: 21.391515067931728
test
0:  annret:21.963,  sharpe:0.974
1:  annret:20.497,  sharpe:0.886
2:  annret:18.285,  sharpe:0.833
3:  annret:18.613,  sharpe:0.805
          0         1         2         3
0  1.000000  0.919359  0.946935  0.932816
1  0.919359  1.000000  0.952496  0.936932
2  0.946935  0.952496  1.000000  0.937257
3  0.932816  0.936932  0.937257  1.000000
train
0:  annret:18.973,  sharpe:0.680
1:  annret:16.955,  sharpe:0.610
2:  annret:28.168,  sharpe:1.071
3:  annret:29.722,  sharpe:1.124
portfolio:  annret:28.626,  sharpe:1.126
                  0         1         2         3  portfolio
0          1.000000  0.890814  0.841259  0.831360   0.938392
1          0.890814  1.000000  0.836990  0.806687   0.941632
2          0.841259  0.836990  1.000000  0.765943   0.911890
3          0.831360  0.806687  0.765943  1.000000   0.878310
portfolio  0.938392  0.941632  0.911890  0.878310   1.000000
test
0:  annret:21.963,  sharpe:0.974
1:  annret:20.497,  sharpe:0.886
2:  annret:18.285,  sharpe:0.833
3:  annret:18.613,  sharpe:0.805
portfolio:  annret:23.315,  sharpe:1.127
                  0         1         2         3  portfolio
0          1.000000  0.919359  0.946935  0.932816   0.956059
1          0.919359  1.000000  0.952496  0.936932   0.959803
2          0.946935  0.952496  1.000000  0.937257   0.972209
3          0.932816  0.936932  0.937257  1.000000   0.961978
portfolio  0.956059  0.959803  0.972209  0.961978   1.000000
------------------
0:  annret:27.213,  sharpe:1.242
1:  annret:20.638,  sharpe:0.908
2:  annret:30.055,  sharpe:1.421
3:  annret:22.605,  sharpe:1.010
          0         1         2         3
0  1.000000  0.315896  0.454963  0.486393
1  0.315896  1.000000  0.550614  0.450915
2  0.454963  0.550614  1.000000  0.595904
3  0.486393  0.450915  0.595904  1.000000
Timestep 174000, Reward: 531.4845184753312, TD Loss: 40.090920543078404
test
0:  annret:9.042,  sharpe:0.907
1:  annret:14.123,  sharpe:1.417
2:  annret:15.712,  sharpe:0.859
3:  annret:11.422,  sharpe:0.705
          0         1         2         3
0  1.000000 -0.116916 -0.050578 -0.126663
1 -0.116916  1.000000  0.578609  0.521140
2 -0.050578  0.578609  1.000000  0.601217
3 -0.126663  0.521140  0.601217  1.000000
train
0:  annret:40.197,  sharpe:2.658
1:  annret:31.759,  sharpe:1.865
2:  annret:48.558,  sharpe:2.184
3:  annret:43.465,  sharpe:2.096
portfolio:  annret:62.692,  sharpe:3.897
                  0         1         2         3  portfolio
0          1.000000  0.194156  0.231453  0.184219   0.626561
1          0.194156  1.000000  0.370000  0.399551   0.588105
2          0.231453  0.370000  1.000000  0.430170   0.600353
3          0.184219  0.399551  0.430170  1.000000   0.595340
portfolio  0.626561  0.588105  0.600353  0.595340   1.000000
test
0:  annret:9.042,  sharpe:0.907
1:  annret:14.123,  sharpe:1.417
2:  annret:15.712,  sharpe:0.859
3:  annret:11.422,  sharpe:0.705
portfolio:  annret:16.634,  sharpe:1.720
                  0         1         2         3  portfolio
0          1.000000 -0.116916 -0.050578 -0.126663   0.298707
1         -0.116916  1.000000  0.578609  0.521140   0.559428
2         -0.050578  0.578609  1.000000  0.601217   0.591569
3         -0.126663  0.521140  0.601217  1.000000   0.644013
portfolio  0.298707  0.559428  0.591569  0.644013   1.000000
------------------
Timestep 175000, Reward: 531.4845184753312, TD Loss: 18.64910725945273
test
0:  annret:21.930,  sharpe:1.040
1:  annret:16.347,  sharpe:0.821
2:  annret:18.552,  sharpe:0.976
3:  annret:16.384,  sharpe:0.753
          0         1         2         3
0  1.000000  0.840437  0.898955  0.849067
1  0.840437  1.000000  0.853912  0.812108
2  0.898955  0.853912  1.000000  0.797840
3  0.849067  0.812108  0.797840  1.000000
train
0:  annret:30.210,  sharpe:1.193
1:  annret:28.487,  sharpe:1.212
2:  annret:47.686,  sharpe:2.088
3:  annret:44.076,  sharpe:1.791
portfolio:  annret:50.431,  sharpe:2.667
                  0         1         2         3  portfolio
0          1.000000  0.763876  0.779061  0.729689   0.803697
1          0.763876  1.000000  0.667806  0.651520   0.800646
2          0.779061  0.667806  1.000000  0.586941   0.835317
3          0.729689  0.651520  0.586941  1.000000   0.741898
portfolio  0.803697  0.800646  0.835317  0.741898   1.000000
test
0:  annret:21.930,  sharpe:1.040
1:  annret:16.347,  sharpe:0.821
2:  annret:18.552,  sharpe:0.976
3:  annret:16.384,  sharpe:0.753
portfolio:  annret:19.901,  sharpe:1.404
                  0         1         2         3  portfolio
0          1.000000  0.840437  0.898955  0.849067   0.860722
1          0.840437  1.000000  0.853912  0.812108   0.847182
2          0.898955  0.853912  1.000000  0.797840   0.885410
3          0.849067  0.812108  0.797840  1.000000   0.853847
portfolio  0.860722  0.847182  0.885410  0.853847   1.000000
------------------
Timestep 176000, Reward: 531.4845184753312, TD Loss: 18.577024990897158
test
0:  annret:20.035,  sharpe:1.178
1:  annret:8.604,  sharpe:0.740
2:  annret:7.728,  sharpe:0.600
3:  annret:12.000,  sharpe:0.599
          0         1         2         3
0  1.000000  0.596162  0.512375  0.698813
1  0.596162  1.000000  0.520593  0.588898
2  0.512375  0.520593  1.000000  0.336266
3  0.698813  0.588898  0.336266  1.000000
train
0:  annret:40.783,  sharpe:1.926
1:  annret:37.532,  sharpe:2.183
2:  annret:56.669,  sharpe:3.038
3:  annret:41.316,  sharpe:1.804
portfolio:  annret:60.984,  sharpe:3.723
                  0         1         2         3  portfolio
0          1.000000  0.514230  0.466272  0.597575   0.632677
1          0.514230  1.000000  0.568111  0.447373   0.729972
2          0.466272  0.568111  1.000000  0.326464   0.732624
3          0.597575  0.447373  0.326464  1.000000   0.588694
portfolio  0.632677  0.729972  0.732624  0.588694   1.000000
test
0:  annret:20.035,  sharpe:1.178
1:  annret:8.604,  sharpe:0.740
2:  annret:7.728,  sharpe:0.600
3:  annret:12.000,  sharpe:0.599
portfolio:  annret:17.122,  sharpe:1.627
                  0         1         2         3  portfolio
0          1.000000  0.596162  0.512375  0.698813   0.657482
1          0.596162  1.000000  0.520593  0.588898   0.633694
2          0.512375  0.520593  1.000000  0.336266   0.576335
3          0.698813  0.588898  0.336266  1.000000   0.614768
portfolio  0.657482  0.633694  0.576335  0.614768   1.000000
------------------
0:  annret:17.471,  sharpe:0.783
1:  annret:14.709,  sharpe:0.710
2:  annret:33.784,  sharpe:1.578
3:  annret:31.256,  sharpe:1.367
          0         1         2         3
0  1.000000  0.519952  0.593711  0.458927
1  0.519952  1.000000  0.548109  0.372460
2  0.593711  0.548109  1.000000  0.458538
3  0.458927  0.372460  0.458538  1.000000
Timestep 177000, Reward: 508.23810602560343, TD Loss: 29.06882931458081
test
0:  annret:21.734,  sharpe:1.117
1:  annret:20.135,  sharpe:0.995
2:  annret:19.629,  sharpe:1.063
3:  annret:17.612,  sharpe:0.837
          0         1         2         3
0  1.000000  0.829925  0.868175  0.852873
1  0.829925  1.000000  0.859831  0.873966
2  0.868175  0.859831  1.000000  0.817589
3  0.852873  0.873966  0.817589  1.000000
train
0:  annret:31.007,  sharpe:1.300
1:  annret:31.948,  sharpe:1.335
2:  annret:47.546,  sharpe:2.123
3:  annret:35.337,  sharpe:1.475
portfolio:  annret:55.954,  sharpe:2.972
                  0         1         2         3  portfolio
0          1.000000  0.762782  0.758461  0.722715   0.777297
1          0.762782  1.000000  0.681082  0.690817   0.789620
2          0.758461  0.681082  1.000000  0.597718   0.824663
3          0.722715  0.690817  0.597718  1.000000   0.702549
portfolio  0.777297  0.789620  0.824663  0.702549   1.000000
test
0:  annret:21.734,  sharpe:1.117
1:  annret:20.135,  sharpe:0.995
2:  annret:19.629,  sharpe:1.063
3:  annret:17.612,  sharpe:0.837
portfolio:  annret:22.004,  sharpe:1.544
                  0         1         2         3  portfolio
0          1.000000  0.829925  0.868175  0.852873   0.843215
1          0.829925  1.000000  0.859831  0.873966   0.837850
2          0.868175  0.859831  1.000000  0.817589   0.866181
3          0.852873  0.873966  0.817589  1.000000   0.849682
portfolio  0.843215  0.837850  0.866181  0.849682   1.000000
------------------
Timestep 178000, Reward: 508.23810602560343, TD Loss: 17.37674599290777
test
0:  annret:19.118,  sharpe:0.929
1:  annret:16.902,  sharpe:0.891
2:  annret:14.546,  sharpe:0.751
3:  annret:12.743,  sharpe:0.644
          0         1         2         3
0  1.000000  0.804539  0.889623  0.814904
1  0.804539  1.000000  0.854458  0.837057
2  0.889623  0.854458  1.000000  0.820284
3  0.814904  0.837057  0.820284  1.000000
train
0:  annret:27.832,  sharpe:1.113
1:  annret:32.941,  sharpe:1.428
2:  annret:41.159,  sharpe:1.714
3:  annret:37.627,  sharpe:1.620
portfolio:  annret:50.127,  sharpe:2.669
                  0         1         2         3  portfolio
0          1.000000  0.762831  0.747373  0.727975   0.810594
1          0.762831  1.000000  0.680293  0.687470   0.808451
2          0.747373  0.680293  1.000000  0.583564   0.799725
3          0.727975  0.687470  0.583564  1.000000   0.725035
portfolio  0.810594  0.808451  0.799725  0.725035   1.000000
test
0:  annret:19.118,  sharpe:0.929
1:  annret:16.902,  sharpe:0.891
2:  annret:14.546,  sharpe:0.751
3:  annret:12.743,  sharpe:0.644
portfolio:  annret:14.777,  sharpe:1.054
                  0         1         2         3  portfolio
0          1.000000  0.804539  0.889623  0.814904   0.834937
1          0.804539  1.000000  0.854458  0.837057   0.838995
2          0.889623  0.854458  1.000000  0.820284   0.867553
3          0.814904  0.837057  0.820284  1.000000   0.845467
portfolio  0.834937  0.838995  0.867553  0.845467   1.000000
------------------
0:  annret:13.864,  sharpe:0.652
1:  annret:21.141,  sharpe:1.117
2:  annret:31.117,  sharpe:1.490
3:  annret:26.975,  sharpe:1.242
          0         1         2         3
0  1.000000  0.454753  0.551787  0.525365
1  0.454753  1.000000  0.434308  0.358599
2  0.551787  0.434308  1.000000  0.514225
3  0.525365  0.358599  0.514225  1.000000
Timestep 179000, Reward: 493.1700684747426, TD Loss: 19.183637163213643
test
0:  annret:20.620,  sharpe:1.088
1:  annret:15.310,  sharpe:0.902
2:  annret:18.922,  sharpe:1.117
3:  annret:21.501,  sharpe:0.992
          0         1         2         3
0  1.000000  0.693450  0.825006  0.771211
1  0.693450  1.000000  0.764660  0.799722
2  0.825006  0.764660  1.000000  0.786897
3  0.771211  0.799722  0.786897  1.000000
train
0:  annret:35.588,  sharpe:1.588
1:  annret:35.094,  sharpe:1.673
2:  annret:37.343,  sharpe:1.839
3:  annret:39.117,  sharpe:1.544
portfolio:  annret:56.473,  sharpe:3.127
                  0         1         2         3  portfolio
0          1.000000  0.681620  0.760070  0.713294   0.800777
1          0.681620  1.000000  0.625370  0.631045   0.753743
2          0.760070  0.625370  1.000000  0.609457   0.749901
3          0.713294  0.631045  0.609457  1.000000   0.713757
portfolio  0.800777  0.753743  0.749901  0.713757   1.000000
test
0:  annret:20.620,  sharpe:1.088
1:  annret:15.310,  sharpe:0.902
2:  annret:18.922,  sharpe:1.117
3:  annret:21.501,  sharpe:0.992
portfolio:  annret:22.508,  sharpe:1.836
                  0         1         2         3  portfolio
0          1.000000  0.693450  0.825006  0.771211   0.811776
1          0.693450  1.000000  0.764660  0.799722   0.757462
2          0.825006  0.764660  1.000000  0.786897   0.792019
3          0.771211  0.799722  0.786897  1.000000   0.802424
portfolio  0.811776  0.757462  0.792019  0.802424   1.000000
------------------
/home/zpgong/RL/MARL_Fin/main.py
#!/usr/bin/env python3
import argparse
import logging
import math
import os
import random
from copy import deepcopy
from pathlib import Path

import numpy as np
import torch
import torch.optim as optim

from env import StockEnv
from helpers import ReplayBuffer
from models import DQN

USE_CUDA = torch.cuda.is_available()
if USE_CUDA:
    print("Using GPU: GPU requested and available.")
    # dtype = torch.cuda.FloatTensor
    # dtypelong = torch.cuda.LongTensor
    device = torch.device("cuda")
else:
    print("NOT Using GPU: GPU not requested or not available.")
    # dtype = torch.FloatTensor
    # dtypelong = torch.LongTensor
    device = torch.device("cpu")


def get_logger(logpath,
               filepath,
               package_files=[],
               displaying=False,
               saving=True,
               debug=False):
    logger = logging.getLogger()
    if debug:
        level = logging.DEBUG
    else:
        level = logging.INFO
    logger.setLevel(level)
    if saving:
        info_file_handler = logging.FileHandler(logpath, mode="a")
        info_file_handler.setLevel(level)
        logger.addHandler(info_file_handler)
    if displaying:
        console_handler = logging.StreamHandler()
        console_handler.setLevel(level)
        logger.addHandler(console_handler)
    logger.info(filepath)
    with open(filepath, "r") as f:
        logger.info(f.read())

    for f in package_files:
        logger.info(f)
        with open(f, "r") as package_f:
            logger.info(package_f.read())

    return logger


class Agent:
    def __init__(self, q_network, target_q_network, lr):
        self.q_network = q_network
        self.target_q_network = target_q_network
        self.num_actions = 3
        self.optimizer = optim.Adam(self.q_network.parameters(), lr=lr)

    def act(self, state, epsilon):
        """DQN action - max q-value w/ epsilon greedy exploration."""
        state = torch.tensor(np.float32(state)).to(device)
        if random.random() > epsilon:
            q_value = self.q_network.forward(state)
            return q_value.max(1)[1].data
        return torch.randint(low=0, high=3,
                             size=(state.shape[0], 1)).squeeze(1)

    def save(self, agent_id, save_dir):
        save_f = Path(f'{save_dir}/model/agent_{agent_id}.pth')
        save_f.parent.mkdir(parents=True, exist_ok=True)
        torch.save(self.q_network.state_dict(), save_f)
        # print("Model has been saved...")

    def load(self, agent_id, save_dir):
        self.q_network.load_state_dict(
            torch.load(f'{save_dir}/model/agent_{agent_id}.pth'))
        self.target_q_network = deepcopy(self.q_network)
        # print("Model has been loaded...")


def corrcoef(x, y):
    vx = x - torch.mean(x)
    vy = y - torch.mean(y)
    corr = torch.sum(vx * vy) / (torch.sqrt(torch.sum(vx**2)) *
                                 torch.sqrt(torch.sum(vy**2)))
    return corr


def compute_local_loss(agent, batch_size, replay_buffer, gamma):
    state, action, reward, next_state, done = replay_buffer.sample(batch_size)
    state = torch.tensor(np.float32(state)).to(device)
    next_state = torch.tensor(np.float32(next_state)).to(device)
    action = torch.tensor(action).to(device)
    reward = torch.tensor(reward).to(device)
    done = torch.tensor(np.float32(done)).to(device)
    # Normal DDQN update
    q_values = agent.q_network(state)
    q_value = q_values.gather(1, action.unsqueeze(1)).squeeze(1)
    # double q-learning
    online_next_q_values = agent.q_network(next_state)
    _, max_indices = torch.max(online_next_q_values, dim=1)
    target_q_values = agent.target_q_network(next_state)
    next_q_value = torch.gather(target_q_values, 1, max_indices.unsqueeze(1))
    expected_q_value = reward + gamma * next_q_value.squeeze(1) * (1 - done)
    loss = (q_value - expected_q_value.data).pow(2).mean()
    agent.optimizer.zero_grad()
    loss.backward()
    agent.optimizer.step()
    return loss


def compute_global_loss(agent_ls, batch_size, replay_buffer, global_optimizer,
                        global_loss_scale):
    state, action, reward, next_state, done = replay_buffer.sample(batch_size)
    state = torch.tensor(np.float32(state)).to(device)
    q_values = [agent.q_network(state) for agent in agent_ls]
    eta_values = [q_value[:, -1] - q_value[:, 0] for q_value in q_values]

    q_target_values = [agent.target_q_network(state) for agent in agent_ls]
    eta_target_values = [
        q_target_value[:, -1] - q_target_value[:, 0]
        for q_target_value in q_target_values
    ]

    corrcoef_ls = [
        corrcoef(eta_values[i], eta_target_values[j])**2
        for i in range(len(eta_values)) for j in range(len(eta_target_values))
        if i != j
    ]

    global_loss = torch.tensor(0.0).to(device)
    for corr in corrcoef_ls:
        global_loss += corr
    global_loss *= global_loss_scale

    global_optimizer.zero_grad()
    global_loss.backward()
    global_optimizer.step()

    return global_loss


def get_epsilon(epsilon_start, epsilon_final, epsilon_decay, frame_idx):
    return epsilon_final + (epsilon_start - epsilon_final) * math.exp(
        -1.0 * frame_idx / epsilon_decay)


def soft_update(q_network, target_q_network, tau):
    for t_param, param in zip(target_q_network.parameters(),
                              q_network.parameters()):
        if t_param is param:
            continue
        new_param = tau * param.data + (1.0 - tau) * t_param.data
        t_param.data.copy_(new_param)


def hard_update(q_network, target_q_network):
    for t_param, param in zip(target_q_network.parameters(),
                              q_network.parameters()):
        if t_param is param:
            continue
        new_param = param.data
        t_param.data.copy_(new_param)


def test_agent(test_env, agent_ls, logger):
    state = test_env.reset()

    while True:
        for idx, agent in enumerate(agent_ls):
            action = agent.act(state, epsilon=0)
            _, _, done, _ = test_env.predict(action.cpu().numpy(),
                                             agent_id=idx)
        if done.all():
            logger.info('test')
            test_env.stats()
            break
        state = test_env.step()


def test_portfolio(train_env, test_env, agent_ls, logger):
    for env in [train_env, test_env]:
        state = env.reset()
        while True:
            with torch.no_grad():
                q_values = [
                    agent.q_network(
                        torch.as_tensor(state,
                                        device=device,
                                        dtype=torch.float32))
                    for agent in agent_ls
                ]
                eta_values = [
                    q_value[:, -1] - q_value[:, 0] for q_value in q_values
                ]
                eta_values = [
                    eta_value / eta_value.abs().sum()
                    for eta_value in eta_values
                ]

                [
                    env.predict(action.cpu().numpy(), agent_id=idx)
                    for idx, action in enumerate(eta_values)
                ]

                portfolio = torch.row_stack(eta_values).mean(axis=0)
                portfolio /= portfolio.abs().sum()
                portfolio += 1

                _, _, done, _ = env.predict(portfolio.cpu().numpy(),
                                            agent_id='portfolio')

            if done.all():
                logger.info(env.name)
                env.stats()
                break

            state = env.step()


def make_agent(params, hidden_dims=-1):
    if hidden_dims == -1:
        hidden_dims = params.hidden_dims
    q_network = DQN(num_days=params.ts_window, hidden_dims=hidden_dims)
    target_q_network = deepcopy(q_network)

    if USE_CUDA:
        q_network = q_network.to(device)
        target_q_network = target_q_network.to(device)

    agent = Agent(q_network, target_q_network, lr=params.learning_rate)

    return agent


def run_gym(params):
    logpath = Path(os.path.join(params.save_dir, 'logs'))
    logpath.parent.mkdir(parents=True, exist_ok=True)

    logger = get_logger(logpath=logpath, filepath=os.path.abspath(__file__))
    logger.info(params)

    env = StockEnv(ts_window=params.ts_window,
                   start_date='20100101',
                   end_date='20190101',
                   logger=logger,
                   agent_num=params.agent_num,
                   ic_coef=params.ic_scale,
                   name='train')

    train_env = deepcopy(env)
    test_env = StockEnv(ts_window=params.ts_window,
                        start_date='20190102',
                        end_date='20210603',
                        logger=logger,
                        agent_num=params.agent_num,
                        ic_coef=params.ic_scale,
                        name='test')

    agent_ls = [
        make_agent(params, hidden_dims=(2**(6 + i), 2**(6 + i)))
        for i in range(params.agent_num)
    ]
    
    [agent.load(idx,'experiments/v1_10d_10') for idx,agent in enumerate(agent_ls)]
    
    global_optimizer = optim.Adam([{
        'params': agent.q_network.parameters()
    } for agent in agent_ls],
                                  lr=params.learning_rate)

    replay_buffer = ReplayBuffer(params.replay_size)

    losses, all_rewards = [], []
    episode_reward = 0

    state = env.reset()
    # state shape: [num_stocks, ts_window]

    for ts in range(1, params.max_ts + 1):

        epsilon = get_epsilon(params.epsilon_start, params.epsilon_end,
                              params.epsilon_decay, ts)

        for idx, agent in enumerate(agent_ls):
            action = agent.act(state, epsilon)
            next_state, reward, done, _ = env.predict(action.cpu().numpy(),
                                                      agent_id=idx)
            reward *= params.reward_scale
            replay_buffer.push_batch(state, action, reward, next_state, done)
            episode_reward += reward.mean()

        if done.all():
            env.stats()
            state = env.reset()
            all_rewards.append(episode_reward / params.agent_num)
            episode_reward = 0

        state = env.step()

        if len(replay_buffer
               ) > params.start_train_ts and ts % params.update_every == 0:
            # Update the q-network & the target network
            for _ in range(params.gradient_step):
                all_loss = 0
                for agent in agent_ls:
                    loss = compute_local_loss(agent, params.batch_size,
                                              replay_buffer, params.gamma)
                    all_loss += loss.data

                global_loss = compute_global_loss(agent_ls, params.batch_size,
                                                  replay_buffer,
                                                  global_optimizer,
                                                  params.global_loss_scale)
                all_loss += global_loss.data
                losses.append(all_loss)

            if ts % params.target_network_update_f == 0:
                for agent in agent_ls:
                    hard_update(agent.q_network, agent.target_q_network)

        if ts % params.log_every == 0:
            out_str = "Timestep {}".format(ts)
            if len(all_rewards) > 0:
                out_str += ", Reward: {}".format(all_rewards[-1])
            if len(losses) > 0:
                out_str += ", TD Loss: {}".format(losses[-1])
            logger.info(out_str)
            [
                agent.save(agent_id=i, save_dir=params.save_dir)
                for i, agent in enumerate(agent_ls)
            ]

            test_agent(test_env, agent_ls, logger)

            if ts > 50000:
                test_portfolio(train_env, test_env, agent_ls, logger)

            logger.info('------------------')


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("--learning_rate", type=float, default=1e-4)
    parser.add_argument("--target_update_rate", type=float, default=0.1)
    parser.add_argument("--replay_size", type=int, default=100000)
    parser.add_argument("--start_train_ts", type=int, default=100)
    parser.add_argument("--epsilon_start", type=float, default=1.0)
    parser.add_argument("--epsilon_end", type=float, default=0.1)
    parser.add_argument("--epsilon_decay", type=int, default=1000)
    parser.add_argument("--max_ts", type=int, default=1000000)
    parser.add_argument("--batch_size", type=int, default=32)
    parser.add_argument("--gamma", type=float, default=0.9)
    parser.add_argument("--log_every", type=int, default=1000)
    parser.add_argument("--target_network_update_f", type=int, default=1000)
    parser.add_argument("--save_dir", type=str, default='experiments/v1')

    parser.add_argument("--ts_window", type=int, default=10)
    parser.add_argument("--reward_scale", type=float, default=1.0)
    parser.add_argument("--update_every", type=int, default=1)
    parser.add_argument("--gradient_step", type=int, default=1)
    parser.add_argument("--hidden_dims", type=tuple, default=(256, 256))
    parser.add_argument("--agent_num", type=int, default=4)
    parser.add_argument("--ic_scale", type=float, default=10.0)
    parser.add_argument("--global_loss_scale", type=float, default=1)

    run_gym(parser.parse_args())

Namespace(agent_num=4, batch_size=32, epsilon_decay=1000, epsilon_end=0.1, epsilon_start=1.0, gamma=0.9, global_loss_scale=1, gradient_step=1, hidden_dims=(256, 256), ic_scale=10.0, learning_rate=0.0001, log_every=1000, max_ts=1000000, replay_size=100000, reward_scale=1.0, save_dir='experiments/v1_10d_10', start_train_ts=100, target_network_update_f=1000, target_update_rate=0.1, ts_window=10, update_every=1)
init env:firstday:20100119 tradedays:2186,tickers:3599
init env:firstday:20190102 tradedays:597,tickers:4400
Timestep 1000, TD Loss: 26.975846474969053
test
0:  annret:22.294,  sharpe:0.962
1:  annret:19.801,  sharpe:0.892
2:  annret:13.923,  sharpe:0.625
3:  annret:22.248,  sharpe:0.941
          0         1         2         3
0  1.000000  0.882596  0.941940  0.901197
1  0.882596  1.000000  0.911129  0.912235
2  0.941940  0.911129  1.000000  0.906794
3  0.901197  0.912235  0.906794  1.000000
------------------
Timestep 2000, TD Loss: 32.080253709396295
test
0:  annret:19.868,  sharpe:0.911
1:  annret:15.203,  sharpe:0.995
2:  annret:12.661,  sharpe:0.624
3:  annret:14.781,  sharpe:0.817
          0         1         2         3
0  1.000000  0.713935  0.916901  0.828111
1  0.713935  1.000000  0.768166  0.727417
2  0.916901  0.768166  1.000000  0.818721
3  0.828111  0.727417  0.818721  1.000000
------------------
0:  annret:8.500,  sharpe:0.416
1:  annret:7.570,  sharpe:0.413
2:  annret:10.789,  sharpe:0.646
3:  annret:11.701,  sharpe:0.618
          0         1         2         3
0  1.000000  0.461171  0.419819  0.504284
1  0.461171  1.000000  0.385129  0.375592
2  0.419819  0.385129  1.000000  0.432226
3  0.504284  0.375592  0.432226  1.000000
Timestep 3000, Reward: 267.1081147807517, TD Loss: 23.783104677949503
test
0:  annret:19.192,  sharpe:0.879
1:  annret:19.449,  sharpe:0.922
2:  annret:15.048,  sharpe:0.687
3:  annret:19.543,  sharpe:0.910
          0         1         2         3
0  1.000000  0.835332  0.925738  0.878017
1  0.835332  1.000000  0.894635  0.860479
2  0.925738  0.894635  1.000000  0.920075
3  0.878017  0.860479  0.920075  1.000000
------------------
Timestep 4000, Reward: 267.1081147807517, TD Loss: 25.997563619071258
test
0:  annret:19.794,  sharpe:0.958
1:  annret:13.881,  sharpe:0.824
2:  annret:11.911,  sharpe:0.634
3:  annret:16.194,  sharpe:0.926
          0         1         2         3
0  1.000000  0.692397  0.885834  0.818829
1  0.692397  1.000000  0.774001  0.763636
2  0.885834  0.774001  1.000000  0.812432
3  0.818829  0.763636  0.812432  1.000000
------------------
0:  annret:13.700,  sharpe:0.597
1:  annret:25.281,  sharpe:1.175
2:  annret:23.516,  sharpe:1.073
3:  annret:24.189,  sharpe:1.097
          0         1         2         3
0  1.000000  0.581948  0.602501  0.354221
1  0.581948  1.000000  0.569014  0.289197
2  0.602501  0.569014  1.000000  0.358244
3  0.354221  0.289197  0.358244  1.000000
Timestep 5000, Reward: 466.907196774139, TD Loss: 16.692081797871854
test
0:  annret:15.396,  sharpe:0.915
1:  annret:14.361,  sharpe:0.781
2:  annret:11.330,  sharpe:0.831
3:  annret:15.979,  sharpe:1.362
          0         1         2         3
0  1.000000  0.638374  0.787807  0.557868
1  0.638374  1.000000  0.622992  0.411912
2  0.787807  0.622992  1.000000  0.489108
3  0.557868  0.411912  0.489108  1.000000
------------------
Timestep 6000, Reward: 466.907196774139, TD Loss: 11.873837867769378
test
0:  annret:17.367,  sharpe:0.920
1:  annret:18.776,  sharpe:1.004
2:  annret:13.637,  sharpe:0.858
3:  annret:14.995,  sharpe:0.828
          0         1         2         3
0  1.000000  0.815027  0.865478  0.858875
1  0.815027  1.000000  0.858119  0.857721
2  0.865478  0.858119  1.000000  0.845630
3  0.858875  0.857721  0.845630  1.000000
------------------
0:  annret:17.577,  sharpe:0.753
1:  annret:23.811,  sharpe:1.099
2:  annret:32.546,  sharpe:1.562
3:  annret:29.701,  sharpe:1.418
          0         1         2         3
0  1.000000  0.416133  0.585665  0.555670
1  0.416133  1.000000  0.364026  0.436261
2  0.585665  0.364026  1.000000  0.396353
3  0.555670  0.436261  0.396353  1.000000
Timestep 7000, Reward: 526.9410077758931, TD Loss: 24.833223291292885
test
0:  annret:16.701,  sharpe:0.923
1:  annret:-0.672,  sharpe:-0.060
2:  annret:6.486,  sharpe:0.791
3:  annret:19.110,  sharpe:1.225
          0         1         2         3
0  1.000000 -0.341594  0.255331  0.653029
1 -0.341594  1.000000 -0.016465 -0.407165
2  0.255331 -0.016465  1.000000  0.022557
3  0.653029 -0.407165  0.022557  1.000000
------------------
Timestep 8000, Reward: 526.9410077758931, TD Loss: 51.563290200333384
test
0:  annret:9.663,  sharpe:0.959
1:  annret:8.858,  sharpe:0.829
2:  annret:1.212,  sharpe:0.115
3:  annret:-9.857,  sharpe:-0.485
          0         1         2         3
0  1.000000  0.428040  0.406348 -0.094898
1  0.428040  1.000000 -0.025093 -0.613479
2  0.406348 -0.025093  1.000000  0.481426
3 -0.094898 -0.613479  0.481426  1.000000
------------------
0:  annret:17.540,  sharpe:0.756
1:  annret:9.882,  sharpe:0.466
2:  annret:31.166,  sharpe:1.515
3:  annret:21.145,  sharpe:0.951
          0         1         2         3
0  1.000000  0.532750  0.570260  0.490045
1  0.532750  1.000000  0.372988  0.379972
2  0.570260  0.372988  1.000000  0.550941
3  0.490045  0.379972  0.550941  1.000000
Timestep 9000, Reward: 458.45423253499416, TD Loss: 11.417595792272838
test
0:  annret:19.213,  sharpe:0.884
1:  annret:12.907,  sharpe:0.721
2:  annret:13.894,  sharpe:0.794
3:  annret:20.721,  sharpe:0.961
          0         1         2         3
0  1.000000  0.787100  0.838444  0.876080
1  0.787100  1.000000  0.828096  0.877223
2  0.838444  0.828096  1.000000  0.838282
3  0.876080  0.877223  0.838282  1.000000
------------------
Timestep 10000, Reward: 458.45423253499416, TD Loss: 91.21281784505209
test
0:  annret:19.980,  sharpe:0.876
1:  annret:18.913,  sharpe:0.784
2:  annret:16.630,  sharpe:0.730
3:  annret:19.040,  sharpe:0.781
          0         1         2         3
0  1.000000  0.963306  0.961023  0.966961
1  0.963306  1.000000  0.985382  0.987578
2  0.961023  0.985382  1.000000  0.980898
3  0.966961  0.987578  0.980898  1.000000
------------------
0:  annret:20.975,  sharpe:0.878
1:  annret:11.871,  sharpe:0.568
2:  annret:31.077,  sharpe:1.504
3:  annret:21.180,  sharpe:0.928
          0         1         2         3
0  1.000000  0.465277  0.412544  0.623118
1  0.465277  1.000000  0.451103  0.480739
2  0.412544  0.451103  1.000000  0.464226
3  0.623118  0.480739  0.464226  1.000000
Timestep 11000, Reward: 489.05871602616673, TD Loss: 6.9016262541332285
test
0:  annret:19.866,  sharpe:1.116
1:  annret:0.062,  sharpe:0.004
2:  annret:5.898,  sharpe:0.451
3:  annret:10.183,  sharpe:1.059
          0         1         2         3
0  1.000000 -0.606807  0.682445  0.264050
1 -0.606807  1.000000 -0.476786  0.034612
2  0.682445 -0.476786  1.000000  0.211540
3  0.264050  0.034612  0.211540  1.000000
------------------
Timestep 12000, Reward: 489.05871602616673, TD Loss: 8.837849572856133
test
0:  annret:21.026,  sharpe:0.918
1:  annret:18.465,  sharpe:0.915
2:  annret:18.127,  sharpe:0.876
3:  annret:21.598,  sharpe:0.980
          0         1         2         3
0  1.000000  0.832857  0.925816  0.899692
1  0.832857  1.000000  0.880428  0.855884
2  0.925816  0.880428  1.000000  0.915933
3  0.899692  0.855884  0.915933  1.000000
------------------
Timestep 13000, Reward: 489.05871602616673, TD Loss: 26.28170033437546
test
0:  annret:17.098,  sharpe:1.125
1:  annret:8.254,  sharpe:0.786
2:  annret:10.273,  sharpe:0.591
3:  annret:16.577,  sharpe:1.293
          0         1         2         3
0  1.000000 -0.167794  0.758896  0.553814
1 -0.167794  1.000000 -0.367359 -0.126187
2  0.758896 -0.367359  1.000000  0.540292
3  0.553814 -0.126187  0.540292  1.000000
------------------
0:  annret:19.705,  sharpe:0.840
1:  annret:13.556,  sharpe:0.668
2:  annret:30.392,  sharpe:1.399
3:  annret:20.995,  sharpe:0.935
          0         1         2         3
0  1.000000  0.503405  0.549416  0.629057
1  0.503405  1.000000  0.467029  0.561745
2  0.549416  0.467029  1.000000  0.536557
3  0.629057  0.561745  0.536557  1.000000
Timestep 14000, Reward: 511.70830047039885, TD Loss: 15.397157041876461
test
0:  annret:21.267,  sharpe:0.977
1:  annret:18.064,  sharpe:0.813
2:  annret:15.546,  sharpe:0.724
3:  annret:22.675,  sharpe:1.009
          0         1         2         3
0  1.000000  0.874154  0.906945  0.894469
1  0.874154  1.000000  0.934490  0.918877
2  0.906945  0.934490  1.000000  0.926421
3  0.894469  0.918877  0.926421  1.000000
------------------
Timestep 15000, Reward: 511.70830047039885, TD Loss: 14.835926052902076
test
0:  annret:16.615,  sharpe:0.860
1:  annret:12.565,  sharpe:0.686
2:  annret:14.402,  sharpe:0.837
3:  annret:17.535,  sharpe:0.974
          0         1         2         3
0  1.000000  0.728845  0.857231  0.793674
1  0.728845  1.000000  0.756547  0.780914
2  0.857231  0.756547  1.000000  0.752051
3  0.793674  0.780914  0.752051  1.000000
------------------
0:  annret:20.516,  sharpe:0.899
1:  annret:20.299,  sharpe:0.903
2:  annret:33.232,  sharpe:1.510
3:  annret:17.058,  sharpe:0.792
          0         1         2         3
0  1.000000  0.478709  0.598793  0.463784
1  0.478709  1.000000  0.577680  0.446156
2  0.598793  0.577680  1.000000  0.467218
3  0.463784  0.446156  0.467218  1.000000
Timestep 16000, Reward: 541.7111858029419, TD Loss: 16.675320533497732
test
0:  annret:21.750,  sharpe:1.086
1:  annret:17.316,  sharpe:0.836
2:  annret:15.872,  sharpe:0.931
3:  annret:22.439,  sharpe:1.048
          0         1         2         3
0  1.000000  0.760705  0.820286  0.823216
1  0.760705  1.000000  0.836904  0.863578
2  0.820286  0.836904  1.000000  0.841420
3  0.823216  0.863578  0.841420  1.000000
------------------
Timestep 17000, Reward: 541.7111858029419, TD Loss: 25.576552616024173
test
0:  annret:18.968,  sharpe:0.904
1:  annret:5.748,  sharpe:0.747
2:  annret:14.601,  sharpe:0.783
3:  annret:14.981,  sharpe:0.792
          0         1         2         3
0  1.000000  0.136848  0.902560  0.839819
1  0.136848  1.000000  0.207461  0.195309
2  0.902560  0.207461  1.000000  0.806943
3  0.839819  0.195309  0.806943  1.000000
------------------
0:  annret:28.041,  sharpe:1.272
1:  annret:17.272,  sharpe:0.790
2:  annret:37.884,  sharpe:1.709
3:  annret:24.577,  sharpe:1.124
          0         1         2         3
0  1.000000  0.237932  0.591383  0.559498
1  0.237932  1.000000  0.281426  0.304595
2  0.591383  0.281426  1.000000  0.495294
3  0.559498  0.304595  0.495294  1.000000
Timestep 18000, Reward: 543.7620229203658, TD Loss: 16.01838618234762
test
0:  annret:-1.120,  sharpe:-0.063
1:  annret:-6.332,  sharpe:-0.323
2:  annret:7.873,  sharpe:0.555
3:  annret:21.078,  sharpe:0.984
          0         1         2         3
0  1.000000  0.829480 -0.704512 -0.860270
1  0.829480  1.000000 -0.747190 -0.856033
2 -0.704512 -0.747190  1.000000  0.736457
3 -0.860270 -0.856033  0.736457  1.000000
------------------
Timestep 19000, Reward: 543.7620229203658, TD Loss: 13.343034660561493
test
0:  annret:14.813,  sharpe:0.745
1:  annret:15.417,  sharpe:0.789
2:  annret:14.944,  sharpe:0.774
3:  annret:-1.290,  sharpe:-0.085
          0         1         2         3
0  1.000000  0.851869  0.917755 -0.721506
1  0.851869  1.000000  0.897692 -0.758344
2  0.917755  0.897692  1.000000 -0.730391
3 -0.721506 -0.758344 -0.730391  1.000000
------------------
0:  annret:15.138,  sharpe:0.682
1:  annret:12.311,  sharpe:0.567
2:  annret:27.765,  sharpe:1.231
3:  annret:20.098,  sharpe:0.920
          0         1         2         3
0  1.000000  0.498252  0.592737  0.436138
1  0.498252  1.000000  0.436863  0.202871
2  0.592737  0.436863  1.000000  0.420230
3  0.436138  0.202871  0.420230  1.000000
Timestep 20000, Reward: 452.3929698037867, TD Loss: 17.766075566092088
test
0:  annret:18.534,  sharpe:0.914
1:  annret:11.390,  sharpe:0.886
2:  annret:11.333,  sharpe:0.613
3:  annret:21.511,  sharpe:1.106
          0         1         2         3
0  1.000000  0.649918  0.863775  0.848049
1  0.649918  1.000000  0.669727  0.778388
2  0.863775  0.669727  1.000000  0.821442
3  0.848049  0.778388  0.821442  1.000000
------------------
Timestep 21000, Reward: 452.3929698037867, TD Loss: 45.685145973306085
test
0:  annret:21.515,  sharpe:0.938
1:  annret:16.512,  sharpe:0.959
2:  annret:13.839,  sharpe:0.713
3:  annret:3.970,  sharpe:0.307
          0         1         2         3
0  1.000000  0.904767  0.939111  0.635792
1  0.904767  1.000000  0.882213  0.571261
2  0.939111  0.882213  1.000000  0.691448
3  0.635792  0.571261  0.691448  1.000000
------------------
0:  annret:16.458,  sharpe:0.678
1:  annret:7.139,  sharpe:0.348
2:  annret:28.167,  sharpe:1.251
3:  annret:16.507,  sharpe:0.778
          0         1         2         3
0  1.000000  0.539540  0.653581  0.497847
1  0.539540  1.000000  0.442917  0.405477
2  0.653581  0.442917  1.000000  0.450433
3  0.497847  0.405477  0.450433  1.000000
Timestep 22000, Reward: 432.18086103608323, TD Loss: 8.403435677315159
test
0:  annret:19.488,  sharpe:1.354
1:  annret:12.641,  sharpe:0.822
2:  annret:12.424,  sharpe:0.664
3:  annret:21.406,  sharpe:1.043
          0         1         2         3
0  1.000000  0.516788  0.741108  0.678756
1  0.516788  1.000000  0.770131  0.789455
2  0.741108  0.770131  1.000000  0.813396
3  0.678756  0.789455  0.813396  1.000000
------------------
Timestep 23000, Reward: 432.18086103608323, TD Loss: 27.94959005073675
test
0:  annret:21.236,  sharpe:0.912
1:  annret:19.722,  sharpe:0.851
2:  annret:16.038,  sharpe:0.717
3:  annret:21.660,  sharpe:0.945
          0         1         2         3
0  1.000000  0.968471  0.972009  0.961789
1  0.968471  1.000000  0.977576  0.968003
2  0.972009  0.977576  1.000000  0.962406
3  0.961789  0.968003  0.962406  1.000000
------------------
0:  annret:15.703,  sharpe:0.716
1:  annret:16.223,  sharpe:0.784
2:  annret:31.107,  sharpe:1.330
3:  annret:27.053,  sharpe:1.212
          0         1         2         3
0  1.000000  0.517895  0.595073  0.542687
1  0.517895  1.000000  0.378807  0.515117
2  0.595073  0.378807  1.000000  0.490350
3  0.542687  0.515117  0.490350  1.000000
Timestep 24000, Reward: 495.8153555880058, TD Loss: 30.955726143247933
test
0:  annret:10.304,  sharpe:0.969
1:  annret:7.496,  sharpe:0.743
2:  annret:10.170,  sharpe:0.609
3:  annret:19.150,  sharpe:1.132
          0         1         2         3
0  1.000000 -0.007419 -0.206873 -0.358882
1 -0.007419  1.000000  0.058056  0.007200
2 -0.206873  0.058056  1.000000  0.668336
3 -0.358882  0.007200  0.668336  1.000000
------------------
Timestep 25000, Reward: 495.8153555880058, TD Loss: 12.892260812090456
test
0:  annret:20.846,  sharpe:0.972
1:  annret:16.088,  sharpe:0.756
2:  annret:16.530,  sharpe:0.804
3:  annret:21.888,  sharpe:1.006
          0         1         2         3
0  1.000000  0.866566  0.929904  0.908292
1  0.866566  1.000000  0.898695  0.884592
2  0.929904  0.898695  1.000000  0.894496
3  0.908292  0.884592  0.894496  1.000000
------------------
Timestep 26000, Reward: 495.8153555880058, TD Loss: 23.16434344382408
test
0:  annret:18.173,  sharpe:1.027
1:  annret:14.476,  sharpe:0.934
2:  annret:11.310,  sharpe:0.664
3:  annret:15.221,  sharpe:1.223
          0         1         2         3
0  1.000000  0.650128  0.860246  0.719551
1  0.650128  1.000000  0.729416  0.536721
2  0.860246  0.729416  1.000000  0.628513
3  0.719551  0.536721  0.628513  1.000000
------------------
0:  annret:20.383,  sharpe:0.939
1:  annret:15.263,  sharpe:0.734
2:  annret:27.717,  sharpe:1.232
3:  annret:28.559,  sharpe:1.286
          0         1         2         3
0  1.000000  0.531930  0.564794  0.416143
1  0.531930  1.000000  0.600718  0.331812
2  0.564794  0.600718  1.000000  0.403393
3  0.416143  0.331812  0.403393  1.000000
Timestep 27000, Reward: 524.7207967704841, TD Loss: 27.013609444047262
test
0:  annret:19.305,  sharpe:0.921
1:  annret:21.345,  sharpe:0.980
2:  annret:14.681,  sharpe:0.692
3:  annret:19.234,  sharpe:0.892
          0         1         2         3
0  1.000000  0.910007  0.939194  0.927133
1  0.910007  1.000000  0.937406  0.925965
2  0.939194  0.937406  1.000000  0.919009
3  0.927133  0.925965  0.919009  1.000000
------------------
Timestep 28000, Reward: 524.7207967704841, TD Loss: 25.656253709784608
test
0:  annret:19.955,  sharpe:0.993
1:  annret:18.590,  sharpe:1.053
2:  annret:17.631,  sharpe:0.965
3:  annret:14.876,  sharpe:0.799
          0         1         2         3
0  1.000000  0.796231  0.890573  0.850174
1  0.796231  1.000000  0.866134  0.843930
2  0.890573  0.866134  1.000000  0.842532
3  0.850174  0.843930  0.842532  1.000000
------------------
0:  annret:25.663,  sharpe:1.146
1:  annret:19.087,  sharpe:0.898
2:  annret:29.897,  sharpe:1.421
3:  annret:20.684,  sharpe:0.940
          0         1         2         3
0  1.000000  0.597588  0.352477  0.449164
1  0.597588  1.000000  0.401656  0.539924
2  0.352477  0.401656  1.000000  0.478284
3  0.449164  0.539924  0.478284  1.000000
Timestep 29000, Reward: 527.1486296197226, TD Loss: 11.7028696241626
test
0:  annret:20.788,  sharpe:0.947
1:  annret:17.966,  sharpe:0.932
2:  annret:15.507,  sharpe:0.791
3:  annret:15.965,  sharpe:0.738
          0         1         2         3
0  1.000000  0.866330  0.920592  0.923545
1  0.866330  1.000000  0.871776  0.882439
2  0.920592  0.871776  1.000000  0.875050
3  0.923545  0.882439  0.875050  1.000000
------------------
Timestep 30000, Reward: 527.1486296197226, TD Loss: 7.357353447814965
test
0:  annret:14.700,  sharpe:1.015
1:  annret:18.775,  sharpe:0.981
2:  annret:11.786,  sharpe:0.663
3:  annret:6.388,  sharpe:0.491
          0         1         2         3
0  1.000000  0.687782  0.807307  0.729740
1  0.687782  1.000000  0.866959  0.673090
2  0.807307  0.866959  1.000000  0.714873
3  0.729740  0.673090  0.714873  1.000000
------------------
0:  annret:21.357,  sharpe:0.990
1:  annret:15.955,  sharpe:0.798
2:  annret:33.321,  sharpe:1.497
3:  annret:26.216,  sharpe:1.190
          0         1         2         3
0  1.000000  0.574868  0.518222  0.641901
1  0.574868  1.000000  0.508638  0.575841
2  0.518222  0.508638  1.000000  0.573060
3  0.641901  0.575841  0.573060  1.000000
Timestep 31000, Reward: 535.698518051672, TD Loss: 11.79773512541093
test
0:  annret:4.359,  sharpe:0.242
1:  annret:7.562,  sharpe:0.658
2:  annret:9.653,  sharpe:0.665
3:  annret:12.073,  sharpe:0.674
          0         1         2         3
0  1.000000 -0.498993 -0.767095 -0.777630
1 -0.498993  1.000000  0.513492  0.457300
2 -0.767095  0.513492  1.000000  0.685791
3 -0.777630  0.457300  0.685791  1.000000
------------------
Timestep 32000, Reward: 535.698518051672, TD Loss: 30.393660385923624
test
0:  annret:15.151,  sharpe:1.108
1:  annret:16.213,  sharpe:0.882
2:  annret:17.380,  sharpe:1.043
3:  annret:-5.150,  sharpe:-0.289
          0         1         2         3
0  1.000000  0.663418  0.834673 -0.660623
1  0.663418  1.000000  0.839116 -0.852614
2  0.834673  0.839116  1.000000 -0.770728
3 -0.660623 -0.852614 -0.770728  1.000000
------------------
0:  annret:17.220,  sharpe:0.810
1:  annret:14.444,  sharpe:0.667
2:  annret:27.458,  sharpe:1.363
3:  annret:30.433,  sharpe:1.460
          0         1         2         3
0  1.000000  0.427939  0.432034  0.437297
1  0.427939  1.000000  0.483883  0.308683
2  0.432034  0.483883  1.000000  0.377659
3  0.437297  0.308683  0.377659  1.000000
Timestep 33000, Reward: 475.580797111091, TD Loss: 8.564487291323811
test
0:  annret:19.731,  sharpe:0.945
1:  annret:17.785,  sharpe:0.933
2:  annret:11.795,  sharpe:0.597
3:  annret:15.256,  sharpe:0.753
          0         1         2         3
0  1.000000  0.778712  0.898844  0.855943
1  0.778712  1.000000  0.853135  0.822292
2  0.898844  0.853135  1.000000  0.854443
3  0.855943  0.822292  0.854443  1.000000
------------------
Timestep 34000, Reward: 475.580797111091, TD Loss: 106.59434259267522
test
0:  annret:13.647,  sharpe:0.904
1:  annret:1.516,  sharpe:0.138
2:  annret:4.254,  sharpe:0.356
3:  annret:-12.851,  sharpe:-0.568
          0         1         2         3
0  1.000000 -0.330116  0.705985 -0.866022
1 -0.330116  1.000000 -0.301528  0.571364
2  0.705985 -0.301528  1.000000 -0.662613
3 -0.866022  0.571364 -0.662613  1.000000
------------------
0:  annret:17.893,  sharpe:0.745
1:  annret:17.728,  sharpe:0.833
2:  annret:23.225,  sharpe:1.075
3:  annret:23.511,  sharpe:1.067
          0         1         2         3
0  1.000000  0.427777  0.615988  0.286453
1  0.427777  1.000000  0.468195  0.458520
2  0.615988  0.468195  1.000000  0.430611
3  0.286453  0.458520  0.430611  1.000000
Timestep 35000, Reward: 488.19784164985936, TD Loss: 21.891355426570705
test
0:  annret:18.468,  sharpe:0.950
1:  annret:17.536,  sharpe:1.008
2:  annret:11.802,  sharpe:0.773
3:  annret:15.181,  sharpe:0.797
          0         1         2         3
0  1.000000  0.663041  0.817023  0.813321
1  0.663041  1.000000  0.695675  0.749906
2  0.817023  0.695675  1.000000  0.714774
3  0.813321  0.749906  0.714774  1.000000
------------------
Timestep 36000, Reward: 488.19784164985936, TD Loss: 18.134147309243772
test
0:  annret:19.856,  sharpe:0.902
1:  annret:22.714,  sharpe:1.034
2:  annret:17.327,  sharpe:0.774
3:  annret:15.832,  sharpe:0.736
          0         1         2         3
0  1.000000  0.883723  0.920659  0.888106
1  0.883723  1.000000  0.961616  0.924301
2  0.920659  0.961616  1.000000  0.939488
3  0.888106  0.924301  0.939488  1.000000
------------------
0:  annret:20.600,  sharpe:0.926
1:  annret:17.969,  sharpe:0.839
2:  annret:29.946,  sharpe:1.406
3:  annret:18.035,  sharpe:0.843
          0         1         2         3
0  1.000000  0.451713  0.557399  0.468802
1  0.451713  1.000000  0.526475  0.336272
2  0.557399  0.526475  1.000000  0.462625
3  0.468802  0.336272  0.462625  1.000000
Timestep 37000, Reward: 490.9504565541023, TD Loss: 7.322978558157135
test
0:  annret:16.798,  sharpe:0.799
1:  annret:23.672,  sharpe:1.334
2:  annret:11.682,  sharpe:0.706
3:  annret:10.179,  sharpe:0.816
          0         1         2         3
0  1.000000  0.734647  0.825012  0.227926
1  0.734647  1.000000  0.768555  0.128621
2  0.825012  0.768555  1.000000  0.267266
3  0.227926  0.128621  0.267266  1.000000
------------------
Timestep 38000, Reward: 490.9504565541023, TD Loss: 22.476293391501333
test
0:  annret:20.256,  sharpe:0.929
1:  annret:21.161,  sharpe:1.006
2:  annret:15.274,  sharpe:0.690
3:  annret:15.917,  sharpe:0.823
          0         1         2         3
0  1.000000  0.875885  0.921809  0.861082
1  0.875885  1.000000  0.909230  0.839846
2  0.921809  0.909230  1.000000  0.852562
3  0.861082  0.839846  0.852562  1.000000
------------------
Timestep 39000, Reward: 490.9504565541023, TD Loss: 24.30347922705107
test
0:  annret:18.820,  sharpe:0.920
1:  annret:20.570,  sharpe:1.059
2:  annret:17.926,  sharpe:0.826
3:  annret:13.577,  sharpe:0.668
          0         1         2         3
0  1.000000  0.765253  0.901273  0.836954
1  0.765253  1.000000  0.882133  0.829407
2  0.901273  0.882133  1.000000  0.890793
3  0.836954  0.829407  0.890793  1.000000
------------------
0:  annret:21.986,  sharpe:0.936
1:  annret:15.293,  sharpe:0.701
2:  annret:29.604,  sharpe:1.263
3:  annret:24.954,  sharpe:1.156
          0         1         2         3
0  1.000000  0.653521  0.668350  0.419862
1  0.653521  1.000000  0.601014  0.380913
2  0.668350  0.601014  1.000000  0.342534
3  0.419862  0.380913  0.342534  1.000000
Timestep 40000, Reward: 550.4878049070705, TD Loss: 21.18906201733085
test
0:  annret:21.047,  sharpe:0.981
1:  annret:19.367,  sharpe:0.878
2:  annret:18.527,  sharpe:0.866
3:  annret:18.192,  sharpe:0.842
          0         1         2         3
0  1.000000  0.890012  0.921500  0.900822
1  0.890012  1.000000  0.936373  0.913227
2  0.921500  0.936373  1.000000  0.906280
3  0.900822  0.913227  0.906280  1.000000
------------------
Timestep 41000, Reward: 550.4878049070705, TD Loss: 14.353487515538918
test
0:  annret:17.736,  sharpe:0.883
1:  annret:19.514,  sharpe:0.987
2:  annret:14.159,  sharpe:0.845
3:  annret:12.516,  sharpe:0.717
          0         1         2         3
0  1.000000  0.829186  0.876753  0.828668
1  0.829186  1.000000  0.814352  0.796499
2  0.876753  0.814352  1.000000  0.805039
3  0.828668  0.796499  0.805039  1.000000
------------------
0:  annret:16.668,  sharpe:0.661
1:  annret:22.826,  sharpe:0.973
2:  annret:30.091,  sharpe:1.350
3:  annret:20.220,  sharpe:0.908
          0         1         2         3
0  1.000000  0.687031  0.615654  0.185624
1  0.687031  1.000000  0.602870  0.304906
2  0.615654  0.602870  1.000000  0.335409
3  0.185624  0.304906  0.335409  1.000000
Timestep 42000, Reward: 538.2965425701204, TD Loss: 10.682749548041562
test
0:  annret:18.956,  sharpe:1.226
1:  annret:20.973,  sharpe:1.128
2:  annret:13.831,  sharpe:0.691
3:  annret:16.182,  sharpe:0.817
          0         1         2         3
0  1.000000  0.637731  0.815907  0.706596
1  0.637731  1.000000  0.796034  0.762453
2  0.815907  0.796034  1.000000  0.795913
3  0.706596  0.762453  0.795913  1.000000
------------------
Timestep 43000, Reward: 538.2965425701204, TD Loss: 7.527023064598369
test
0:  annret:18.765,  sharpe:0.902
1:  annret:17.775,  sharpe:0.900
2:  annret:12.217,  sharpe:0.636
3:  annret:15.418,  sharpe:0.849
          0         1         2         3
0  1.000000  0.837951  0.894450  0.851590
1  0.837951  1.000000  0.897446  0.847191
2  0.894450  0.897446  1.000000  0.867424
3  0.851590  0.847191  0.867424  1.000000
------------------
0:  annret:12.767,  sharpe:0.550
1:  annret:20.548,  sharpe:0.916
2:  annret:29.567,  sharpe:1.292
3:  annret:28.817,  sharpe:1.277
          0         1         2         3
0  1.000000  0.609503  0.566744  0.630386
1  0.609503  1.000000  0.585528  0.488973
2  0.566744  0.585528  1.000000  0.465398
3  0.630386  0.488973  0.465398  1.000000
Timestep 44000, Reward: 537.8714748058178, TD Loss: 21.595807353482925
test
0:  annret:16.098,  sharpe:0.966
1:  annret:19.172,  sharpe:0.948
2:  annret:8.552,  sharpe:0.443
3:  annret:9.996,  sharpe:0.814
          0         1         2         3
0  1.000000  0.588097  0.744648  0.528755
1  0.588097  1.000000  0.859248  0.603429
2  0.744648  0.859248  1.000000  0.666842
3  0.528755  0.603429  0.666842  1.000000
------------------
Timestep 45000, Reward: 537.8714748058178, TD Loss: 28.028743834867207
test
0:  annret:19.039,  sharpe:0.911
1:  annret:-2.964,  sharpe:-0.195
2:  annret:13.735,  sharpe:0.761
3:  annret:12.959,  sharpe:0.697
          0         1         2         3
0  1.000000 -0.794946  0.907489  0.882472
1 -0.794946  1.000000 -0.779592 -0.736773
2  0.907489 -0.779592  1.000000  0.839118
3  0.882472 -0.736773  0.839118  1.000000
------------------
0:  annret:14.697,  sharpe:0.594
1:  annret:18.285,  sharpe:0.817
2:  annret:21.674,  sharpe:0.974
3:  annret:25.767,  sharpe:1.177
          0         1         2         3
0  1.000000  0.239953  0.524905  0.548632
1  0.239953  1.000000  0.486493  0.400216
2  0.524905  0.486493  1.000000  0.461080
3  0.548632  0.400216  0.461080  1.000000
Timestep 46000, Reward: 485.25077632779505, TD Loss: 9.299644337136897
test
0:  annret:17.823,  sharpe:0.846
1:  annret:16.547,  sharpe:1.377
2:  annret:16.122,  sharpe:0.816
3:  annret:17.712,  sharpe:0.817
          0         1         2         3
0  1.000000  0.594883  0.850650  0.820277
1  0.594883  1.000000  0.692587  0.712127
2  0.850650  0.692587  1.000000  0.855857
3  0.820277  0.712127  0.855857  1.000000
------------------
Timestep 47000, Reward: 485.25077632779505, TD Loss: 127.10386202050177
test
0:  annret:20.886,  sharpe:0.913
1:  annret:15.005,  sharpe:0.760
2:  annret:8.173,  sharpe:0.464
3:  annret:-8.764,  sharpe:-0.468
          0         1         2         3
0  1.000000  0.913393  0.867493 -0.867996
1  0.913393  1.000000  0.879352 -0.833552
2  0.867493  0.879352  1.000000 -0.743312
3 -0.867996 -0.833552 -0.743312  1.000000
------------------
0:  annret:14.680,  sharpe:0.613
1:  annret:20.100,  sharpe:0.950
2:  annret:28.158,  sharpe:1.240
3:  annret:21.253,  sharpe:0.904
          0         1         2         3
0  1.000000  0.530064  0.614798  0.414736
1  0.530064  1.000000  0.582669  0.280142
2  0.614798  0.582669  1.000000  0.406712
3  0.414736  0.280142  0.406712  1.000000
Timestep 48000, Reward: 499.860790289523, TD Loss: 16.9862446766897
test
0:  annret:20.644,  sharpe:0.979
1:  annret:17.320,  sharpe:1.097
2:  annret:15.940,  sharpe:0.834
3:  annret:20.213,  sharpe:0.985
          0         1         2         3
0  1.000000  0.651249  0.860807  0.833165
1  0.651249  1.000000  0.764290  0.724449
2  0.860807  0.764290  1.000000  0.784256
3  0.833165  0.724449  0.784256  1.000000
------------------
Timestep 49000, Reward: 499.860790289523, TD Loss: 18.715540365979564
test
0:  annret:19.810,  sharpe:0.874
1:  annret:17.890,  sharpe:0.812
2:  annret:16.341,  sharpe:0.738
3:  annret:19.067,  sharpe:0.836
          0         1         2         3
0  1.000000  0.932516  0.946085  0.938413
1  0.932516  1.000000  0.956919  0.949210
2  0.946085  0.956919  1.000000  0.940777
3  0.938413  0.949210  0.940777  1.000000
------------------
Timestep 50000, Reward: 499.860790289523, TD Loss: 20.61787950337951
test
0:  annret:3.244,  sharpe:0.346
1:  annret:15.017,  sharpe:0.797
2:  annret:16.338,  sharpe:0.865
3:  annret:13.433,  sharpe:0.741
          0         1         2         3
0  1.000000  0.103872  0.234670  0.225932
1  0.103872  1.000000  0.833021  0.817148
2  0.234670  0.833021  1.000000  0.778997
3  0.225932  0.817148  0.778997  1.000000
------------------
0:  annret:15.698,  sharpe:0.661
1:  annret:21.108,  sharpe:0.933
2:  annret:28.670,  sharpe:1.298
3:  annret:23.063,  sharpe:1.024
          0         1         2         3
0  1.000000  0.649257  0.400351  0.497744
1  0.649257  1.000000  0.405257  0.397367
2  0.400351  0.405257  1.000000  0.499131
3  0.497744  0.397367  0.499131  1.000000
Timestep 51000, Reward: 513.5187310002714, TD Loss: 32.37054074157664
test
0:  annret:20.427,  sharpe:0.934
1:  annret:20.921,  sharpe:0.933
2:  annret:18.687,  sharpe:0.850
3:  annret:18.796,  sharpe:0.817
          0         1         2         3
0  1.000000  0.919849  0.940350  0.930203
1  0.919849  1.000000  0.963071  0.949246
2  0.940350  0.963071  1.000000  0.947050
3  0.930203  0.949246  0.947050  1.000000
train
0:  annret:-1.835,  sharpe:-0.060
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:33.862,  sharpe:1.400
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.942112
1          1.000000  1.00000  1.000000  1.000000  -0.942110
2          1.000000  1.00000  1.000000  1.000000  -0.942111
3          1.000000  1.00000  1.000000  1.000000  -0.942109
portfolio -0.942112 -0.94211 -0.942111 -0.942109   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.422,  sharpe:-0.674
portfolio:  annret:21.729,  sharpe:1.094
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.966012
1          1.000000  1.000000  1.000000  1.000000  -0.966015
2          1.000000  1.000000  1.000000  1.000000  -0.966014
3          1.000000  1.000000  1.000000  1.000000  -0.966009
portfolio -0.966012 -0.966015 -0.966014 -0.966009   1.000000
------------------
Timestep 52000, Reward: 513.5187310002714, TD Loss: 27.43858838081879
test
0:  annret:13.163,  sharpe:0.809
1:  annret:3.835,  sharpe:0.345
2:  annret:17.142,  sharpe:0.872
3:  annret:14.231,  sharpe:0.822
          0         1         2         3
0  1.000000  0.677385  0.863339  0.794614
1  0.677385  1.000000  0.710695  0.699975
2  0.863339  0.710695  1.000000  0.782027
3  0.794614  0.699975  0.782027  1.000000
train
0:  annret:-1.835,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.060
portfolio:  annret:53.270,  sharpe:3.291
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000  -0.502944
1          1.000000  1.000000  1.00000  1.000000  -0.502941
2          1.000000  1.000000  1.00000  1.000000  -0.502950
3          1.000000  1.000000  1.00000  1.000000  -0.502951
portfolio -0.502944 -0.502941 -0.50295 -0.502951   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:13.173,  sharpe:1.251
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.711514
1          1.000000  1.000000  1.000000  1.000000  -0.711523
2          1.000000  1.000000  1.000000  1.000000  -0.711531
3          1.000000  1.000000  1.000000  1.000000  -0.711508
portfolio -0.711514 -0.711523 -0.711531 -0.711508   1.000000
------------------
0:  annret:14.031,  sharpe:0.673
1:  annret:20.619,  sharpe:0.940
2:  annret:31.666,  sharpe:1.405
3:  annret:22.011,  sharpe:0.969
          0         1         2         3
0  1.000000  0.478231  0.501539  0.573943
1  0.478231  1.000000  0.415050  0.582864
2  0.501539  0.415050  1.000000  0.459027
3  0.573943  0.582864  0.459027  1.000000
Timestep 53000, Reward: 512.4933080020012, TD Loss: 29.783390497239782
test
0:  annret:20.173,  sharpe:0.917
1:  annret:18.039,  sharpe:0.888
2:  annret:15.719,  sharpe:0.740
3:  annret:16.860,  sharpe:0.759
          0         1         2         3
0  1.000000  0.876615  0.920421  0.889419
1  0.876615  1.000000  0.928457  0.909552
2  0.920421  0.928457  1.000000  0.903096
3  0.889419  0.909552  0.903096  1.000000
train
0:  annret:-1.835,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:42.323,  sharpe:2.050
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000  -0.852793
1          1.000000  1.000000  1.00000  1.000000  -0.852785
2          1.000000  1.000000  1.00000  1.000000  -0.852790
3          1.000000  1.000000  1.00000  1.000000  -0.852789
portfolio -0.852793 -0.852785 -0.85279 -0.852789   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.421,  sharpe:-0.674
portfolio:  annret:17.115,  sharpe:1.040
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.936343
1          1.000000  1.000000  1.000000  1.000000  -0.936337
2          1.000000  1.000000  1.000000  1.000000  -0.936339
3          1.000000  1.000000  1.000000  1.000000  -0.936337
portfolio -0.936343 -0.936337 -0.936339 -0.936337   1.000000
------------------
Timestep 54000, Reward: 512.4933080020012, TD Loss: 29.322597879602796
test
0:  annret:17.648,  sharpe:0.902
1:  annret:10.802,  sharpe:0.656
2:  annret:11.981,  sharpe:0.974
3:  annret:9.146,  sharpe:0.550
          0         1         2         3
0  1.000000  0.781940  0.743355  0.744082
1  0.781940  1.000000  0.712998  0.762255
2  0.743355  0.712998  1.000000  0.546620
3  0.744082  0.762255  0.546620  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.833,  sharpe:-0.060
portfolio:  annret:55.692,  sharpe:3.571
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.433330
1          1.00000  1.000000  1.000000  1.000000  -0.433318
2          1.00000  1.000000  1.000000  1.000000  -0.433316
3          1.00000  1.000000  1.000000  1.000000  -0.433323
portfolio -0.43333 -0.433318 -0.433316 -0.433323   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:12.388,  sharpe:1.173
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.569980
1          1.00000  1.000000  1.000000  1.000000  -0.569985
2          1.00000  1.000000  1.000000  1.000000  -0.569969
3          1.00000  1.000000  1.000000  1.000000  -0.569973
portfolio -0.56998 -0.569985 -0.569969 -0.569973   1.000000
------------------
0:  annret:19.344,  sharpe:0.781
1:  annret:16.449,  sharpe:0.732
2:  annret:28.670,  sharpe:1.356
3:  annret:19.246,  sharpe:0.886
          0         1         2         3
0  1.000000  0.664720  0.497558  0.491748
1  0.664720  1.000000  0.447156  0.541322
2  0.497558  0.447156  1.000000  0.453151
3  0.491748  0.541322  0.453151  1.000000
Timestep 55000, Reward: 525.952510191058, TD Loss: 9.472322318406585
test
0:  annret:16.632,  sharpe:0.967
1:  annret:-2.522,  sharpe:-0.221
2:  annret:13.265,  sharpe:0.861
3:  annret:12.018,  sharpe:0.687
          0         1         2         3
0  1.000000 -0.368838  0.803548  0.740897
1 -0.368838  1.000000 -0.430014 -0.329499
2  0.803548 -0.430014  1.000000  0.643575
3  0.740897 -0.329499  0.643575  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.832,  sharpe:-0.059
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:61.585,  sharpe:4.290
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.250323
1          1.000000  1.000000  1.000000  1.000000  -0.250307
2          1.000000  1.000000  1.000000  1.000000  -0.250311
3          1.000000  1.000000  1.000000  1.000000  -0.250313
portfolio -0.250323 -0.250307 -0.250311 -0.250313   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:16.126,  sharpe:1.809
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.408287
1          1.000000  1.000000  1.000000  1.000000  -0.408281
2          1.000000  1.000000  1.000000  1.000000  -0.408274
3          1.000000  1.000000  1.000000  1.000000  -0.408295
portfolio -0.408287 -0.408281 -0.408274 -0.408295   1.000000
------------------
Timestep 56000, Reward: 525.952510191058, TD Loss: 9.490390625188372
test
0:  annret:13.005,  sharpe:0.853
1:  annret:12.060,  sharpe:0.789
2:  annret:14.954,  sharpe:0.789
3:  annret:9.599,  sharpe:0.523
          0         1         2         3
0  1.000000  0.779303  0.883190  0.783789
1  0.779303  1.000000  0.868216  0.844733
2  0.883190  0.868216  1.000000  0.833582
3  0.783789  0.844733  0.833582  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.832,  sharpe:-0.059
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:57.290,  sharpe:3.487
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.556637
1          1.000000  1.000000  1.000000  1.000000  -0.556638
2          1.000000  1.000000  1.000000  1.000000  -0.556638
3          1.000000  1.000000  1.000000  1.000000  -0.556639
portfolio -0.556637 -0.556638 -0.556638 -0.556639   1.000000
test
0:  annret:-17.408,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:14.379,  sharpe:1.319
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.735606
1          1.000000  1.000000  1.000000  1.000000  -0.735613
2          1.000000  1.000000  1.000000  1.000000  -0.735608
3          1.000000  1.000000  1.000000  1.000000  -0.735615
portfolio -0.735606 -0.735613 -0.735608 -0.735615   1.000000
------------------
0:  annret:20.380,  sharpe:0.936
1:  annret:14.628,  sharpe:0.740
2:  annret:35.230,  sharpe:1.634
3:  annret:28.817,  sharpe:1.320
          0         1         2         3
0  1.000000  0.584888  0.545062  0.579041
1  0.584888  1.000000  0.427207  0.503065
2  0.545062  0.427207  1.000000  0.489240
3  0.579041  0.503065  0.489240  1.000000
Timestep 57000, Reward: 549.4178866092939, TD Loss: 33.8083143100174
test
0:  annret:19.623,  sharpe:1.035
1:  annret:15.249,  sharpe:0.813
2:  annret:15.905,  sharpe:0.887
3:  annret:17.928,  sharpe:0.919
          0         1         2         3
0  1.000000  0.760475  0.854103  0.833242
1  0.760475  1.000000  0.811496  0.801057
2  0.854103  0.811496  1.000000  0.765444
3  0.833242  0.801057  0.765444  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.829,  sharpe:-0.059
3:  annret:-1.833,  sharpe:-0.060
portfolio:  annret:56.655,  sharpe:3.586
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.599263
1          1.000000  1.000000  1.000000  1.000000  -0.599266
2          1.000000  1.000000  1.000000  1.000000  -0.599264
3          1.000000  1.000000  1.000000  1.000000  -0.599272
portfolio -0.599263 -0.599266 -0.599264 -0.599272   1.000000
test
0:  annret:-17.408,  sharpe:-0.673
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.414,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:19.281,  sharpe:1.833
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.644866
1          1.000000  1.00000  1.000000  1.000000  -0.644870
2          1.000000  1.00000  1.000000  1.000000  -0.644859
3          1.000000  1.00000  1.000000  1.000000  -0.644875
portfolio -0.644866 -0.64487 -0.644859 -0.644875   1.000000
------------------
Timestep 58000, Reward: 549.4178866092939, TD Loss: 68.25817710938043
test
0:  annret:3.909,  sharpe:0.303
1:  annret:12.530,  sharpe:1.031
2:  annret:9.904,  sharpe:0.988
3:  annret:-7.940,  sharpe:-0.452
          0         1         2         3
0  1.000000 -0.289906 -0.029185  0.656866
1 -0.289906  1.000000  0.616842 -0.605623
2 -0.029185  0.616842  1.000000 -0.271927
3  0.656866 -0.605623 -0.271927  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.829,  sharpe:-0.059
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:56.948,  sharpe:3.745
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.300878
1          1.000000  1.000000  1.000000  1.000000   0.300877
2          1.000000  1.000000  1.000000  1.000000   0.300884
3          1.000000  1.000000  1.000000  1.000000   0.300876
portfolio  0.300878  0.300877  0.300884  0.300876   1.000000
test
0:  annret:-17.408,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.413,  sharpe:-0.674
3:  annret:-17.422,  sharpe:-0.674
portfolio:  annret:12.167,  sharpe:1.457
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.409088
1          1.000000  1.000000  1.000000  1.000000   0.409071
2          1.000000  1.000000  1.000000  1.000000   0.409084
3          1.000000  1.000000  1.000000  1.000000   0.409084
portfolio  0.409088  0.409071  0.409084  0.409084   1.000000
------------------
0:  annret:17.353,  sharpe:0.750
1:  annret:15.751,  sharpe:0.735
2:  annret:27.743,  sharpe:1.217
3:  annret:20.972,  sharpe:0.953
          0         1         2         3
0  1.000000  0.579242  0.613288  0.578066
1  0.579242  1.000000  0.575738  0.372514
2  0.613288  0.575738  1.000000  0.546163
3  0.578066  0.372514  0.546163  1.000000
Timestep 59000, Reward: 515.1236820959443, TD Loss: 13.268479901992734
test
0:  annret:20.314,  sharpe:0.941
1:  annret:18.590,  sharpe:0.933
2:  annret:15.173,  sharpe:0.736
3:  annret:20.050,  sharpe:1.024
          0         1         2         3
0  1.000000  0.818389  0.893209  0.817290
1  0.818389  1.000000  0.884608  0.834672
2  0.893209  0.884608  1.000000  0.827209
3  0.817290  0.834672  0.827209  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:42.447,  sharpe:2.090
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.856011
1          1.000000  1.00000  1.000000  1.000000  -0.856010
2          1.000000  1.00000  1.000000  1.000000  -0.856013
3          1.000000  1.00000  1.000000  1.000000  -0.856016
portfolio -0.856011 -0.85601 -0.856013 -0.856016   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:20.044,  sharpe:1.300
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.902731
1          1.000000  1.000000  1.000000  1.000000  -0.902737
2          1.000000  1.000000  1.000000  1.000000  -0.902737
3          1.000000  1.000000  1.000000  1.000000  -0.902733
portfolio -0.902731 -0.902737 -0.902737 -0.902733   1.000000
------------------
Timestep 60000, Reward: 515.1236820959443, TD Loss: 69.27272864426388
test
0:  annret:20.969,  sharpe:0.893
1:  annret:18.170,  sharpe:0.799
2:  annret:17.725,  sharpe:0.750
3:  annret:17.779,  sharpe:0.733
          0         1         2         3
0  1.000000  0.961356  0.976162  0.976484
1  0.961356  1.000000  0.981040  0.977476
2  0.976162  0.981040  1.000000  0.987278
3  0.976484  0.977476  0.987278  1.000000
train
0:  annret:-1.838,  sharpe:-0.060
1:  annret:-1.840,  sharpe:-0.060
2:  annret:-1.839,  sharpe:-0.060
3:  annret:-1.840,  sharpe:-0.060
portfolio:  annret:21.011,  sharpe:0.739
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.986338
1          1.000000  1.000000  1.000000  1.000000  -0.986337
2          1.000000  1.000000  1.000000  1.000000  -0.986336
3          1.000000  1.000000  1.000000  1.000000  -0.986335
portfolio -0.986338 -0.986337 -0.986336 -0.986335   1.000000
test
0:  annret:-17.416,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.422,  sharpe:-0.674
portfolio:  annret:21.139,  sharpe:0.876
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.992272
1          1.000000  1.000000  1.000000  1.000000  -0.992274
2          1.000000  1.000000  1.000000  1.000000  -0.992272
3          1.000000  1.000000  1.000000  1.000000  -0.992269
portfolio -0.992272 -0.992274 -0.992272 -0.992269   1.000000
------------------
0:  annret:15.783,  sharpe:0.720
1:  annret:17.318,  sharpe:0.854
2:  annret:23.811,  sharpe:1.065
3:  annret:27.885,  sharpe:1.247
          0         1         2         3
0  1.000000  0.575210  0.568168  0.622437
1  0.575210  1.000000  0.519501  0.489326
2  0.568168  0.519501  1.000000  0.548889
3  0.622437  0.489326  0.548889  1.000000
Timestep 61000, Reward: 509.10496902322166, TD Loss: 13.037393340971807
test
0:  annret:-3.440,  sharpe:-0.205
1:  annret:0.093,  sharpe:0.006
2:  annret:1.649,  sharpe:0.177
3:  annret:11.272,  sharpe:1.117
          0         1         2         3
0  1.000000  0.685631 -0.037382  0.268950
1  0.685631  1.000000  0.073208  0.443704
2 -0.037382  0.073208  1.000000  0.011603
3  0.268950  0.443704  0.011603  1.000000
train
0:  annret:-1.825,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:65.858,  sharpe:4.301
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.219094
1          1.000000  1.000000  1.000000  1.000000   0.219107
2          1.000000  1.000000  1.000000  1.000000   0.219098
3          1.000000  1.000000  1.000000  1.000000   0.219093
portfolio  0.219094  0.219107  0.219098  0.219093   1.000000
test
0:  annret:-17.404,  sharpe:-0.673
1:  annret:-17.411,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:17.669,  sharpe:1.994
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.254586
1          1.000000  1.000000  1.000000  1.000000   0.254576
2          1.000000  1.000000  1.000000  1.000000   0.254571
3          1.000000  1.000000  1.000000  1.000000   0.254587
portfolio  0.254586  0.254576  0.254571  0.254587   1.000000
------------------
Timestep 62000, Reward: 509.10496902322166, TD Loss: 16.06787715696149
test
0:  annret:20.679,  sharpe:0.973
1:  annret:17.543,  sharpe:0.791
2:  annret:17.614,  sharpe:0.796
3:  annret:20.853,  sharpe:0.930
          0         1         2         3
0  1.000000  0.852103  0.908435  0.886556
1  0.852103  1.000000  0.945813  0.930242
2  0.908435  0.945813  1.000000  0.950997
3  0.886556  0.930242  0.950997  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.839,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:37.681,  sharpe:1.668
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.924179
1          1.000000  1.000000  1.000000  1.000000  -0.924183
2          1.000000  1.000000  1.000000  1.000000  -0.924181
3          1.000000  1.000000  1.000000  1.000000  -0.924182
portfolio -0.924179 -0.924183 -0.924181 -0.924182   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.417,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:21.881,  sharpe:1.207
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.961271
1          1.000000  1.000000  1.000000  1.000000  -0.961282
2          1.000000  1.000000  1.000000  1.000000  -0.961276
3          1.000000  1.000000  1.000000  1.000000  -0.961273
portfolio -0.961271 -0.961282 -0.961276 -0.961273   1.000000
------------------
Timestep 63000, Reward: 509.10496902322166, TD Loss: 29.047527826131073
test
0:  annret:17.095,  sharpe:0.869
1:  annret:12.386,  sharpe:0.703
2:  annret:7.922,  sharpe:0.551
3:  annret:14.138,  sharpe:0.823
          0         1         2         3
0  1.000000  0.692068  0.778109  0.769480
1  0.692068  1.000000  0.708330  0.763220
2  0.778109  0.708330  1.000000  0.654608
3  0.769480  0.763220  0.654608  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:54.258,  sharpe:3.233
                  0        1        2         3  portfolio
0          1.000000  1.00000  1.00000  1.000000  -0.640021
1          1.000000  1.00000  1.00000  1.000000  -0.640020
2          1.000000  1.00000  1.00000  1.000000  -0.640020
3          1.000000  1.00000  1.00000  1.000000  -0.640019
portfolio -0.640021 -0.64002 -0.64002 -0.640019   1.000000
test
0:  annret:-17.409,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.421,  sharpe:-0.674
portfolio:  annret:13.379,  sharpe:1.132
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.772348
1          1.000000  1.000000  1.000000  1.000000  -0.772351
2          1.000000  1.000000  1.000000  1.000000  -0.772346
3          1.000000  1.000000  1.000000  1.000000  -0.772334
portfolio -0.772348 -0.772351 -0.772346 -0.772334   1.000000
------------------
0:  annret:11.870,  sharpe:0.542
1:  annret:12.908,  sharpe:0.610
2:  annret:28.465,  sharpe:1.296
3:  annret:25.813,  sharpe:1.183
          0         1         2         3
0  1.000000  0.567857  0.547012  0.543874
1  0.567857  1.000000  0.457668  0.443035
2  0.547012  0.457668  1.000000  0.549199
3  0.543874  0.443035  0.549199  1.000000
Timestep 64000, Reward: 526.6099045041008, TD Loss: 12.23405727157686
test
0:  annret:22.167,  sharpe:1.019
1:  annret:18.836,  sharpe:0.897
2:  annret:18.142,  sharpe:0.846
3:  annret:16.406,  sharpe:0.778
          0         1         2         3
0  1.000000  0.872568  0.918584  0.886954
1  0.872568  1.000000  0.919749  0.885921
2  0.918584  0.919749  1.000000  0.882590
3  0.886954  0.885921  0.882590  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:42.402,  sharpe:2.040
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.877519
1          1.000000  1.00000  1.000000  1.000000  -0.877520
2          1.000000  1.00000  1.000000  1.000000  -0.877521
3          1.000000  1.00000  1.000000  1.000000  -0.877519
portfolio -0.877519 -0.87752 -0.877521 -0.877519   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:20.371,  sharpe:1.256
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.909710
1          1.00000  1.000000  1.000000  1.000000  -0.909716
2          1.00000  1.000000  1.000000  1.000000  -0.909714
3          1.00000  1.000000  1.000000  1.000000  -0.909708
portfolio -0.90971 -0.909716 -0.909714 -0.909708   1.000000
------------------
Timestep 65000, Reward: 526.6099045041008, TD Loss: 10.823940615841178
test
0:  annret:20.102,  sharpe:0.972
1:  annret:8.713,  sharpe:0.812
2:  annret:9.745,  sharpe:0.579
3:  annret:19.908,  sharpe:0.934
          0         1         2         3
0  1.000000  0.536573  0.839345  0.874027
1  0.536573  1.000000  0.664664  0.693012
2  0.839345  0.664664  1.000000  0.841905
3  0.874027  0.693012  0.841905  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:51.090,  sharpe:3.071
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.678722
1          1.000000  1.000000  1.000000  1.000000  -0.678716
2          1.000000  1.000000  1.000000  1.000000  -0.678717
3          1.000000  1.000000  1.000000  1.000000  -0.678721
portfolio -0.678722 -0.678716 -0.678717 -0.678721   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:15.713,  sharpe:1.349
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.788834
1          1.000000  1.000000  1.000000  1.000000  -0.788833
2          1.000000  1.000000  1.000000  1.000000  -0.788826
3          1.000000  1.000000  1.000000  1.000000  -0.788827
portfolio -0.788834 -0.788833 -0.788826 -0.788827   1.000000
------------------
0:  annret:20.550,  sharpe:0.849
1:  annret:17.862,  sharpe:0.847
2:  annret:28.293,  sharpe:1.338
3:  annret:25.884,  sharpe:1.175
          0         1         2         3
0  1.000000  0.617278  0.602696  0.597987
1  0.617278  1.000000  0.482678  0.475165
2  0.602696  0.482678  1.000000  0.450977
3  0.597987  0.475165  0.450977  1.000000
Timestep 66000, Reward: 523.4400284460442, TD Loss: 15.649129903874545
test
0:  annret:19.170,  sharpe:0.977
1:  annret:18.494,  sharpe:0.919
2:  annret:16.009,  sharpe:0.772
3:  annret:21.206,  sharpe:1.007
          0         1         2         3
0  1.000000  0.807625  0.896102  0.842208
1  0.807625  1.000000  0.907758  0.871151
2  0.896102  0.907758  1.000000  0.904238
3  0.842208  0.871151  0.904238  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:51.251,  sharpe:2.751
                 0         1        2         3  portfolio
0          1.00000  1.000000  1.00000  1.000000  -0.774920
1          1.00000  1.000000  1.00000  1.000000  -0.774922
2          1.00000  1.000000  1.00000  1.000000  -0.774920
3          1.00000  1.000000  1.00000  1.000000  -0.774922
portfolio -0.77492 -0.774922 -0.77492 -0.774922   1.000000
test
0:  annret:-17.409,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:22.057,  sharpe:1.657
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.877975
1          1.000000  1.000000  1.000000  1.000000  -0.877989
2          1.000000  1.000000  1.000000  1.000000  -0.877983
3          1.000000  1.000000  1.000000  1.000000  -0.877977
portfolio -0.877975 -0.877989 -0.877983 -0.877977   1.000000
------------------
Timestep 67000, Reward: 523.4400284460442, TD Loss: 24.281756799895767
test
0:  annret:10.347,  sharpe:0.738
1:  annret:17.963,  sharpe:0.898
2:  annret:14.771,  sharpe:0.836
3:  annret:18.147,  sharpe:1.145
          0         1         2         3
0  1.000000  0.706781  0.783168  0.646276
1  0.706781  1.000000  0.880048  0.771427
2  0.783168  0.880048  1.000000  0.756345
3  0.646276  0.771427  0.756345  1.000000
train
0:  annret:-1.826,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:57.547,  sharpe:3.540
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.562118
1          1.000000  1.00000  1.000000  1.000000  -0.562120
2          1.000000  1.00000  1.000000  1.000000  -0.562116
3          1.000000  1.00000  1.000000  1.000000  -0.562124
portfolio -0.562118 -0.56212 -0.562116 -0.562124   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:18.450,  sharpe:1.804
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.666081
1          1.000000  1.000000  1.000000  1.000000  -0.666106
2          1.000000  1.000000  1.000000  1.000000  -0.666091
3          1.000000  1.000000  1.000000  1.000000  -0.666087
portfolio -0.666081 -0.666106 -0.666091 -0.666087   1.000000
------------------
0:  annret:17.382,  sharpe:0.803
1:  annret:15.443,  sharpe:0.726
2:  annret:25.742,  sharpe:1.152
3:  annret:23.126,  sharpe:1.036
          0         1         2         3
0  1.000000  0.438070  0.541782  0.586906
1  0.438070  1.000000  0.351292  0.356513
2  0.541782  0.351292  1.000000  0.517113
3  0.586906  0.356513  0.517113  1.000000
Timestep 68000, Reward: 509.15120343982426, TD Loss: 11.679418371868262
test
0:  annret:10.507,  sharpe:1.123
1:  annret:18.427,  sharpe:0.940
2:  annret:13.175,  sharpe:0.684
3:  annret:22.031,  sharpe:1.195
          0         1         2         3
0  1.000000 -0.270243 -0.200206 -0.208035
1 -0.270243  1.000000  0.869669  0.789391
2 -0.200206  0.869669  1.000000  0.801550
3 -0.208035  0.789391  0.801550  1.000000
train
0:  annret:-1.824,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:60.036,  sharpe:3.491
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.625319
1          1.000000  1.000000  1.000000  1.000000  -0.625324
2          1.000000  1.000000  1.000000  1.000000  -0.625325
3          1.000000  1.000000  1.000000  1.000000  -0.625335
portfolio -0.625319 -0.625324 -0.625325 -0.625335   1.000000
test
0:  annret:-17.403,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.421,  sharpe:-0.674
portfolio:  annret:23.744,  sharpe:2.035
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.786021
1          1.000000  1.000000  1.000000  1.00000  -0.786048
2          1.000000  1.000000  1.000000  1.00000  -0.786045
3          1.000000  1.000000  1.000000  1.00000  -0.786040
portfolio -0.786021 -0.786048 -0.786045 -0.78604   1.000000
------------------
Timestep 69000, Reward: 509.15120343982426, TD Loss: 13.99503525962263
test
0:  annret:11.988,  sharpe:0.861
1:  annret:11.695,  sharpe:0.853
2:  annret:16.219,  sharpe:0.832
3:  annret:15.920,  sharpe:1.020
          0         1         2         3
0  1.000000  0.688963  0.809124  0.665790
1  0.688963  1.000000  0.847434  0.742759
2  0.809124  0.847434  1.000000  0.774913
3  0.665790  0.742759  0.774913  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:57.030,  sharpe:3.732
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.468903
1          1.000000  1.000000  1.000000  1.000000  -0.468905
2          1.000000  1.000000  1.000000  1.000000  -0.468909
3          1.000000  1.000000  1.000000  1.000000  -0.468904
portfolio -0.468903 -0.468905 -0.468909 -0.468904   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:18.168,  sharpe:2.041
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.591678
1          1.000000  1.000000  1.000000  1.000000  -0.591691
2          1.000000  1.000000  1.000000  1.000000  -0.591699
3          1.000000  1.000000  1.000000  1.000000  -0.591673
portfolio -0.591678 -0.591691 -0.591699 -0.591673   1.000000
------------------
0:  annret:21.423,  sharpe:1.022
1:  annret:22.701,  sharpe:0.974
2:  annret:32.494,  sharpe:1.481
3:  annret:28.264,  sharpe:1.329
          0         1         2         3
0  1.000000  0.558531  0.489002  0.489019
1  0.558531  1.000000  0.556143  0.600436
2  0.489002  0.556143  1.000000  0.462415
3  0.489019  0.600436  0.462415  1.000000
Timestep 70000, Reward: 557.000269205044, TD Loss: 11.288110491165284
test
0:  annret:5.650,  sharpe:0.458
1:  annret:15.121,  sharpe:0.827
2:  annret:10.949,  sharpe:0.575
3:  annret:21.328,  sharpe:1.016
          0         1         2         3
0  1.000000  0.530585  0.690651  0.628847
1  0.530585  1.000000  0.878011  0.856054
2  0.690651  0.878011  1.000000  0.866585
3  0.628847  0.856054  0.866585  1.000000
train
0:  annret:-1.823,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:54.743,  sharpe:3.215
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.677916
1          1.000000  1.000000  1.000000  1.000000  -0.677922
2          1.000000  1.000000  1.000000  1.000000  -0.677921
3          1.000000  1.000000  1.000000  1.000000  -0.677926
portfolio -0.677916 -0.677922 -0.677921 -0.677926   1.000000
test
0:  annret:-17.404,  sharpe:-0.673
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.422,  sharpe:-0.674
portfolio:  annret:17.795,  sharpe:1.540
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.809911
1          1.000000  1.000000  1.000000  1.000000  -0.809937
2          1.000000  1.000000  1.000000  1.000000  -0.809935
3          1.000000  1.000000  1.000000  1.000000  -0.809936
portfolio -0.809911 -0.809937 -0.809935 -0.809936   1.000000
------------------
Timestep 71000, Reward: 557.000269205044, TD Loss: 47.3354866215154
test
0:  annret:19.946,  sharpe:0.881
1:  annret:15.112,  sharpe:0.786
2:  annret:12.102,  sharpe:0.627
3:  annret:15.041,  sharpe:0.757
          0         1         2         3
0  1.000000  0.922108  0.934742  0.929973
1  0.922108  1.000000  0.912670  0.885170
2  0.934742  0.912670  1.000000  0.889329
3  0.929973  0.885170  0.889329  1.000000
train
0:  annret:-1.840,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:41.682,  sharpe:2.144
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.800598
1          1.000000  1.000000  1.000000  1.000000  -0.800601
2          1.000000  1.000000  1.000000  1.000000  -0.800598
3          1.000000  1.000000  1.000000  1.000000  -0.800597
portfolio -0.800598 -0.800601 -0.800598 -0.800597   1.000000
test
0:  annret:-17.416,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:14.152,  sharpe:0.993
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.912810
1          1.00000  1.000000  1.000000  1.000000  -0.912807
2          1.00000  1.000000  1.000000  1.000000  -0.912803
3          1.00000  1.000000  1.000000  1.000000  -0.912806
portfolio -0.91281 -0.912807 -0.912803 -0.912806   1.000000
------------------
0:  annret:18.191,  sharpe:0.782
1:  annret:9.930,  sharpe:0.451
2:  annret:29.853,  sharpe:1.415
3:  annret:30.790,  sharpe:1.306
          0         1         2         3
0  1.000000  0.609000  0.469327  0.612303
1  0.609000  1.000000  0.505544  0.572050
2  0.469327  0.505544  1.000000  0.497752
3  0.612303  0.572050  0.497752  1.000000
Timestep 72000, Reward: 536.6680231938166, TD Loss: 25.470824195680937
test
0:  annret:23.243,  sharpe:1.062
1:  annret:19.083,  sharpe:0.958
2:  annret:12.230,  sharpe:0.688
3:  annret:18.868,  sharpe:0.893
          0         1         2         3
0  1.000000  0.773494  0.866544  0.852843
1  0.773494  1.000000  0.805624  0.809454
2  0.866544  0.805624  1.000000  0.814200
3  0.852843  0.809454  0.814200  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:43.734,  sharpe:2.150
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.852336
1          1.000000  1.000000  1.000000  1.000000  -0.852331
2          1.000000  1.000000  1.000000  1.000000  -0.852332
3          1.000000  1.000000  1.000000  1.000000  -0.852331
portfolio -0.852336 -0.852331 -0.852332 -0.852331   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:17.068,  sharpe:1.086
                 0         1         2        3  portfolio
0          1.00000  1.000000  1.000000  1.00000  -0.915870
1          1.00000  1.000000  1.000000  1.00000  -0.915866
2          1.00000  1.000000  1.000000  1.00000  -0.915866
3          1.00000  1.000000  1.000000  1.00000  -0.915860
portfolio -0.91587 -0.915866 -0.915866 -0.91586   1.000000
------------------
Timestep 73000, Reward: 536.6680231938166, TD Loss: 28.90976887830681
test
0:  annret:20.424,  sharpe:0.903
1:  annret:17.751,  sharpe:0.750
2:  annret:16.038,  sharpe:0.724
3:  annret:19.379,  sharpe:0.829
          0         1         2         3
0  1.000000  0.956052  0.960191  0.946015
1  0.956052  1.000000  0.973527  0.966194
2  0.960191  0.973527  1.000000  0.956416
3  0.946015  0.966194  0.956416  1.000000
train
0:  annret:-1.837,  sharpe:-0.060
1:  annret:-1.840,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:26.831,  sharpe:1.002
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.974005
1          1.000000  1.000000  1.000000  1.000000  -0.974004
2          1.000000  1.000000  1.000000  1.000000  -0.974003
3          1.000000  1.000000  1.000000  1.000000  -0.974003
portfolio -0.974005 -0.974004 -0.974003 -0.974003   1.000000
test
0:  annret:-17.415,  sharpe:-0.674
1:  annret:-17.417,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:21.626,  sharpe:0.967
                  0         1        2        3  portfolio
0          1.000000  1.000000  1.00000  1.00000  -0.988679
1          1.000000  1.000000  1.00000  1.00000  -0.988681
2          1.000000  1.000000  1.00000  1.00000  -0.988680
3          1.000000  1.000000  1.00000  1.00000  -0.988680
portfolio -0.988679 -0.988681 -0.98868 -0.98868   1.000000
------------------
0:  annret:20.169,  sharpe:0.879
1:  annret:18.174,  sharpe:0.777
2:  annret:32.193,  sharpe:1.460
3:  annret:28.287,  sharpe:1.244
          0         1         2         3
0  1.000000  0.593078  0.580226  0.627142
1  0.593078  1.000000  0.432928  0.559569
2  0.580226  0.432928  1.000000  0.433550
3  0.627142  0.559569  0.433550  1.000000
Timestep 74000, Reward: 556.1262354572978, TD Loss: 37.8844933787402
test
0:  annret:5.623,  sharpe:0.542
1:  annret:12.049,  sharpe:0.671
2:  annret:9.149,  sharpe:0.689
3:  annret:12.442,  sharpe:0.976
          0         1         2         3
0  1.000000 -0.536644 -0.213039 -0.234264
1 -0.536644  1.000000  0.643547  0.469256
2 -0.213039  0.643547  1.000000  0.352149
3 -0.234264  0.469256  0.352149  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.830,  sharpe:-0.059
3:  annret:-1.830,  sharpe:-0.059
portfolio:  annret:63.682,  sharpe:4.404
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.168539
1          1.000000  1.000000  1.000000  1.000000  -0.168551
2          1.000000  1.000000  1.000000  1.000000  -0.168547
3          1.000000  1.000000  1.000000  1.000000  -0.168539
portfolio -0.168539 -0.168551 -0.168547 -0.168539   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.415,  sharpe:-0.674
portfolio:  annret:17.183,  sharpe:2.169
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.189605
1          1.000000  1.000000  1.000000  1.000000  -0.189615
2          1.000000  1.000000  1.000000  1.000000  -0.189621
3          1.000000  1.000000  1.000000  1.000000  -0.189593
portfolio -0.189605 -0.189615 -0.189621 -0.189593   1.000000
------------------
Timestep 75000, Reward: 556.1262354572978, TD Loss: 22.86764634108914
test
0:  annret:20.208,  sharpe:1.162
1:  annret:18.563,  sharpe:0.891
2:  annret:17.771,  sharpe:0.827
3:  annret:19.116,  sharpe:0.898
          0         1         2         3
0  1.000000  0.764714  0.843010  0.823875
1  0.764714  1.000000  0.909391  0.871691
2  0.843010  0.909391  1.000000  0.883557
3  0.823875  0.871691  0.883557  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:46.611,  sharpe:2.334
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.845292
1          1.000000  1.000000  1.000000  1.000000  -0.845301
2          1.000000  1.000000  1.000000  1.000000  -0.845299
3          1.000000  1.000000  1.000000  1.000000  -0.845296
portfolio -0.845292 -0.845301 -0.845299 -0.845296   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:24.725,  sharpe:1.679
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.891573
1          1.000000  1.000000  1.000000  1.000000  -0.891587
2          1.000000  1.000000  1.000000  1.000000  -0.891588
3          1.000000  1.000000  1.000000  1.000000  -0.891578
portfolio -0.891573 -0.891587 -0.891588 -0.891578   1.000000
------------------
Timestep 76000, Reward: 556.1262354572978, TD Loss: 28.699315901955192
test
0:  annret:11.911,  sharpe:0.701
1:  annret:16.679,  sharpe:0.885
2:  annret:5.720,  sharpe:0.508
3:  annret:21.000,  sharpe:1.192
          0         1         2         3
0  1.000000  0.737346  0.682813  0.787922
1  0.737346  1.000000  0.518011  0.725342
2  0.682813  0.518011  1.000000  0.440568
3  0.787922  0.725342  0.440568  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.832,  sharpe:-0.059
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:57.722,  sharpe:3.583
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.576666
1          1.000000  1.000000  1.000000  1.000000  -0.576674
2          1.000000  1.000000  1.000000  1.000000  -0.576665
3          1.000000  1.000000  1.000000  1.000000  -0.576669
portfolio -0.576666 -0.576674 -0.576665 -0.576669   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:16.339,  sharpe:1.542
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.661563
1          1.000000  1.000000  1.000000  1.000000  -0.661585
2          1.000000  1.000000  1.000000  1.000000  -0.661552
3          1.000000  1.000000  1.000000  1.000000  -0.661567
portfolio -0.661563 -0.661585 -0.661552 -0.661567   1.000000
------------------
0:  annret:18.095,  sharpe:0.864
1:  annret:18.431,  sharpe:0.759
2:  annret:27.685,  sharpe:1.274
3:  annret:28.611,  sharpe:1.308
          0         1         2         3
0  1.000000  0.542622  0.564924  0.489559
1  0.542622  1.000000  0.585494  0.400182
2  0.564924  0.585494  1.000000  0.512121
3  0.489559  0.400182  0.512121  1.000000
Timestep 77000, Reward: 561.8261018093059, TD Loss: 25.31330592280932
test
0:  annret:20.414,  sharpe:0.954
1:  annret:19.295,  sharpe:0.843
2:  annret:16.309,  sharpe:0.753
3:  annret:24.213,  sharpe:1.134
          0         1         2         3
0  1.000000  0.925509  0.934895  0.898633
1  0.925509  1.000000  0.958831  0.901009
2  0.934895  0.958831  1.000000  0.888785
3  0.898633  0.901009  0.888785  1.000000
train
0:  annret:-1.833,  sharpe:-0.060
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:38.996,  sharpe:1.699
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.919391
1          1.000000  1.000000  1.000000  1.000000  -0.919392
2          1.000000  1.000000  1.000000  1.000000  -0.919391
3          1.000000  1.000000  1.000000  1.000000  -0.919391
portfolio -0.919391 -0.919392 -0.919391 -0.919391   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:23.064,  sharpe:1.270
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.946485
1          1.000000  1.000000  1.000000  1.000000  -0.946492
2          1.000000  1.000000  1.000000  1.000000  -0.946488
3          1.000000  1.000000  1.000000  1.000000  -0.946488
portfolio -0.946485 -0.946492 -0.946488 -0.946488   1.000000
------------------
Timestep 78000, Reward: 561.8261018093059, TD Loss: 26.21452480164851
test
0:  annret:11.864,  sharpe:0.727
1:  annret:15.475,  sharpe:0.856
2:  annret:14.940,  sharpe:0.741
3:  annret:20.501,  sharpe:1.044
          0         1         2         3
0  1.000000  0.628839  0.795130  0.753059
1  0.628839  1.000000  0.855540  0.819915
2  0.795130  0.855540  1.000000  0.865384
3  0.753059  0.819915  0.865384  1.000000
train
0:  annret:-1.825,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:55.361,  sharpe:3.372
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.594945
1          1.000000  1.000000  1.000000  1.00000  -0.594951
2          1.000000  1.000000  1.000000  1.00000  -0.594946
3          1.000000  1.000000  1.000000  1.00000  -0.594950
portfolio -0.594945 -0.594951 -0.594946 -0.59495   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:19.331,  sharpe:1.811
                  0       1         2         3  portfolio
0          1.000000  1.0000  1.000000  1.000000  -0.671176
1          1.000000  1.0000  1.000000  1.000000  -0.671200
2          1.000000  1.0000  1.000000  1.000000  -0.671185
3          1.000000  1.0000  1.000000  1.000000  -0.671187
portfolio -0.671176 -0.6712 -0.671185 -0.671187   1.000000
------------------
0:  annret:13.609,  sharpe:0.610
1:  annret:20.576,  sharpe:0.880
2:  annret:34.241,  sharpe:1.653
3:  annret:32.139,  sharpe:1.475
          0         1         2         3
0  1.000000  0.631506  0.492582  0.523755
1  0.631506  1.000000  0.583767  0.507829
2  0.492582  0.583767  1.000000  0.497629
3  0.523755  0.507829  0.497629  1.000000
Timestep 79000, Reward: 558.1615298918199, TD Loss: 16.596715617606698
test
0:  annret:22.504,  sharpe:1.027
1:  annret:17.608,  sharpe:0.822
2:  annret:16.845,  sharpe:0.836
3:  annret:20.538,  sharpe:0.962
          0         1         2         3
0  1.000000  0.907602  0.898519  0.915969
1  0.907602  1.000000  0.925866  0.913143
2  0.898519  0.925866  1.000000  0.881332
3  0.915969  0.913143  0.881332  1.000000
train
0:  annret:-1.833,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:49.273,  sharpe:2.476
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.823858
1          1.000000  1.000000  1.000000  1.000000  -0.823854
2          1.000000  1.000000  1.000000  1.000000  -0.823856
3          1.000000  1.000000  1.000000  1.000000  -0.823856
portfolio -0.823858 -0.823854 -0.823856 -0.823856   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:21.811,  sharpe:1.390
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.887281
1          1.000000  1.000000  1.000000  1.000000  -0.887281
2          1.000000  1.000000  1.000000  1.000000  -0.887273
3          1.000000  1.000000  1.000000  1.000000  -0.887278
portfolio -0.887281 -0.887281 -0.887273 -0.887278   1.000000
------------------
Timestep 80000, Reward: 558.1615298918199, TD Loss: 9.801899318855362
test
0:  annret:17.415,  sharpe:0.871
1:  annret:16.895,  sharpe:0.811
2:  annret:13.333,  sharpe:0.726
3:  annret:20.688,  sharpe:1.081
          0         1         2         3
0  1.000000  0.888401  0.904628  0.871321
1  0.888401  1.000000  0.907487  0.867701
2  0.904628  0.907487  1.000000  0.838303
3  0.871321  0.867701  0.838303  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.832,  sharpe:-0.059
3:  annret:-1.829,  sharpe:-0.059
portfolio:  annret:53.239,  sharpe:3.027
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.723028
1          1.000000  1.000000  1.000000  1.000000  -0.723031
2          1.000000  1.000000  1.000000  1.000000  -0.723025
3          1.000000  1.000000  1.000000  1.000000  -0.723023
portfolio -0.723028 -0.723031 -0.723025 -0.723023   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.415,  sharpe:-0.674
portfolio:  annret:18.613,  sharpe:1.473
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.809103
1          1.000000  1.000000  1.000000  1.000000  -0.809115
2          1.000000  1.000000  1.000000  1.000000  -0.809096
3          1.000000  1.000000  1.000000  1.000000  -0.809093
portfolio -0.809103 -0.809115 -0.809096 -0.809093   1.000000
------------------
0:  annret:20.520,  sharpe:0.966
1:  annret:17.030,  sharpe:0.735
2:  annret:24.588,  sharpe:1.173
3:  annret:34.770,  sharpe:1.520
          0         1         2         3
0  1.000000  0.478845  0.462542  0.513622
1  0.478845  1.000000  0.596941  0.615754
2  0.462542  0.596941  1.000000  0.501947
3  0.513622  0.615754  0.501947  1.000000
Timestep 81000, Reward: 547.3214721001244, TD Loss: 8.065632648107352
test
0:  annret:16.194,  sharpe:1.193
1:  annret:17.022,  sharpe:0.836
2:  annret:15.317,  sharpe:0.775
3:  annret:24.822,  sharpe:1.189
          0         1         2         3
0  1.000000  0.602634  0.698310  0.721004
1  0.602634  1.000000  0.902966  0.864818
2  0.698310  0.902966  1.000000  0.861954
3  0.721004  0.864818  0.861954  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.831,  sharpe:-0.059
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:57.096,  sharpe:3.343
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.697780
1          1.00000  1.000000  1.000000  1.000000  -0.697791
2          1.00000  1.000000  1.000000  1.000000  -0.697785
3          1.00000  1.000000  1.000000  1.000000  -0.697788
portfolio -0.69778 -0.697791 -0.697785 -0.697788   1.000000
test
0:  annret:-17.408,  sharpe:-0.673
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:23.712,  sharpe:2.068
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.778005
1          1.000000  1.00000  1.000000  1.000000  -0.778020
2          1.000000  1.00000  1.000000  1.000000  -0.778001
3          1.000000  1.00000  1.000000  1.000000  -0.778007
portfolio -0.778005 -0.77802 -0.778001 -0.778007   1.000000
------------------
Timestep 82000, Reward: 547.3214721001244, TD Loss: 31.53157747841958
test
0:  annret:15.990,  sharpe:1.097
1:  annret:6.118,  sharpe:0.498
2:  annret:15.535,  sharpe:0.805
3:  annret:13.155,  sharpe:0.840
          0         1         2         3
0  1.000000  0.618057  0.820340  0.768194
1  0.618057  1.000000  0.735269  0.693306
2  0.820340  0.735269  1.000000  0.816826
3  0.768194  0.693306  0.816826  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.060
3:  annret:-1.829,  sharpe:-0.059
portfolio:  annret:57.726,  sharpe:3.688
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.471521
1          1.000000  1.000000  1.000000  1.000000  -0.471521
2          1.000000  1.000000  1.000000  1.000000  -0.471523
3          1.000000  1.000000  1.000000  1.000000  -0.471521
portfolio -0.471521 -0.471521 -0.471523 -0.471521   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:15.410,  sharpe:1.541
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.587393
1          1.000000  1.000000  1.000000  1.00000  -0.587386
2          1.000000  1.000000  1.000000  1.00000  -0.587397
3          1.000000  1.000000  1.000000  1.00000  -0.587370
portfolio -0.587393 -0.587386 -0.587397 -0.58737   1.000000
------------------
0:  annret:15.361,  sharpe:0.702
1:  annret:19.669,  sharpe:0.854
2:  annret:24.269,  sharpe:1.075
3:  annret:32.010,  sharpe:1.371
          0         1         2         3
0  1.000000  0.495674  0.420729  0.458444
1  0.495674  1.000000  0.548141  0.576496
2  0.420729  0.548141  1.000000  0.531487
3  0.458444  0.576496  0.531487  1.000000
Timestep 83000, Reward: 551.4869326205453, TD Loss: 13.294797356722164
test
0:  annret:22.121,  sharpe:1.050
1:  annret:10.984,  sharpe:0.772
2:  annret:17.185,  sharpe:0.784
3:  annret:19.167,  sharpe:0.885
          0         1         2         3
0  1.000000  0.653127  0.879802  0.861656
1  0.653127  1.000000  0.811667  0.779537
2  0.879802  0.811667  1.000000  0.927988
3  0.861656  0.779537  0.927988  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.060
portfolio:  annret:50.620,  sharpe:2.725
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.782406
1          1.000000  1.000000  1.000000  1.000000  -0.782398
2          1.000000  1.000000  1.000000  1.000000  -0.782406
3          1.000000  1.000000  1.000000  1.000000  -0.782402
portfolio -0.782406 -0.782398 -0.782406 -0.782402   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.421,  sharpe:-0.674
portfolio:  annret:18.830,  sharpe:1.385
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.864670
1          1.00000  1.000000  1.000000  1.000000  -0.864657
2          1.00000  1.000000  1.000000  1.000000  -0.864672
3          1.00000  1.000000  1.000000  1.000000  -0.864666
portfolio -0.86467 -0.864657 -0.864672 -0.864666   1.000000
------------------
Timestep 84000, Reward: 551.4869326205453, TD Loss: 114.6536125121829
test
0:  annret:6.486,  sharpe:0.562
1:  annret:14.968,  sharpe:0.913
2:  annret:-4.536,  sharpe:-0.443
3:  annret:-0.205,  sharpe:-0.022
          0         1         2         3
0  1.000000  0.109246  0.549696  0.592232
1  0.109246  1.000000 -0.134639 -0.053107
2  0.549696 -0.134639  1.000000  0.505892
3  0.592232 -0.053107  0.505892  1.000000
train
0:  annret:-1.838,  sharpe:-0.060
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.832,  sharpe:-0.059
3:  annret:-1.829,  sharpe:-0.059
portfolio:  annret:55.614,  sharpe:3.860
                  0         1       2         3  portfolio
0          1.000000  1.000000  1.0000  1.000000   0.131603
1          1.000000  1.000000  1.0000  1.000000   0.131589
2          1.000000  1.000000  1.0000  1.000000   0.131600
3          1.000000  1.000000  1.0000  1.000000   0.131601
portfolio  0.131603  0.131589  0.1316  0.131601   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:7.391,  sharpe:0.926
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.262024
1          1.000000  1.000000  1.000000  1.000000   0.262014
2          1.000000  1.000000  1.000000  1.000000   0.262028
3          1.000000  1.000000  1.000000  1.000000   0.262043
portfolio  0.262024  0.262014  0.262028  0.262043   1.000000
------------------
0:  annret:12.213,  sharpe:0.517
1:  annret:18.471,  sharpe:0.814
2:  annret:31.432,  sharpe:1.354
3:  annret:28.217,  sharpe:1.243
          0         1         2         3
0  1.000000  0.583999  0.423258  0.609938
1  0.583999  1.000000  0.359753  0.471857
2  0.423258  0.359753  1.000000  0.530510
3  0.609938  0.471857  0.530510  1.000000
Timestep 85000, Reward: 549.717595354137, TD Loss: 21.110017338164333
test
0:  annret:19.919,  sharpe:1.063
1:  annret:20.495,  sharpe:0.976
2:  annret:18.424,  sharpe:0.833
3:  annret:21.714,  sharpe:1.105
          0         1         2         3
0  1.000000  0.747963  0.847106  0.833750
1  0.747963  1.000000  0.914600  0.836743
2  0.847106  0.914600  1.000000  0.880156
3  0.833750  0.836743  0.880156  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:49.372,  sharpe:2.485
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.835686
1          1.000000  1.000000  1.000000  1.000000  -0.835691
2          1.000000  1.000000  1.000000  1.000000  -0.835691
3          1.000000  1.000000  1.000000  1.000000  -0.835689
portfolio -0.835686 -0.835691 -0.835691 -0.835689   1.000000
test
0:  annret:-17.409,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:22.075,  sharpe:1.471
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.902625
1          1.000000  1.000000  1.000000  1.000000  -0.902633
2          1.000000  1.000000  1.000000  1.000000  -0.902634
3          1.000000  1.000000  1.000000  1.000000  -0.902622
portfolio -0.902625 -0.902633 -0.902634 -0.902622   1.000000
------------------
Timestep 86000, Reward: 549.717595354137, TD Loss: 39.83740418506616
test
0:  annret:21.072,  sharpe:0.921
1:  annret:19.570,  sharpe:0.809
2:  annret:15.830,  sharpe:0.704
3:  annret:18.461,  sharpe:0.811
          0         1         2         3
0  1.000000  0.955869  0.962560  0.953075
1  0.955869  1.000000  0.970863  0.959014
2  0.962560  0.970863  1.000000  0.952727
3  0.953075  0.959014  0.952727  1.000000
train
0:  annret:-1.836,  sharpe:-0.060
1:  annret:-1.840,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:29.739,  sharpe:1.133
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.970725
1          1.000000  1.000000  1.000000  1.000000  -0.970726
2          1.000000  1.000000  1.000000  1.000000  -0.970724
3          1.000000  1.000000  1.000000  1.000000  -0.970725
portfolio -0.970725 -0.970726 -0.970724 -0.970725   1.000000
test
0:  annret:-17.415,  sharpe:-0.674
1:  annret:-17.417,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:21.091,  sharpe:0.970
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.986388
1          1.000000  1.000000  1.000000  1.000000  -0.986393
2          1.000000  1.000000  1.000000  1.000000  -0.986389
3          1.000000  1.000000  1.000000  1.000000  -0.986389
portfolio -0.986388 -0.986393 -0.986389 -0.986389   1.000000
------------------
0:  annret:15.104,  sharpe:0.644
1:  annret:20.751,  sharpe:0.851
2:  annret:32.191,  sharpe:1.439
3:  annret:26.735,  sharpe:1.164
          0         1         2         3
0  1.000000  0.556619  0.642384  0.558220
1  0.556619  1.000000  0.600289  0.611479
2  0.642384  0.600289  1.000000  0.556978
3  0.558220  0.611479  0.556978  1.000000
Timestep 87000, Reward: 578.1950300362818, TD Loss: 6.675574268786304
test
0:  annret:-1.040,  sharpe:-0.064
1:  annret:19.127,  sharpe:0.891
2:  annret:3.152,  sharpe:0.234
3:  annret:19.854,  sharpe:1.033
          0         1         2         3
0  1.000000 -0.832792 -0.559644 -0.763093
1 -0.832792  1.000000  0.652870  0.852187
2 -0.559644  0.652870  1.000000  0.544260
3 -0.763093  0.852187  0.544260  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.831,  sharpe:-0.059
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:68.273,  sharpe:4.208
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000  -0.445014
1          1.000000  1.000000  1.00000  1.000000  -0.445028
2          1.000000  1.000000  1.00000  1.000000  -0.445020
3          1.000000  1.000000  1.00000  1.000000  -0.445025
portfolio -0.445014 -0.445028 -0.44502 -0.445025   1.000000
test
0:  annret:-17.408,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:19.059,  sharpe:1.918
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.693483
1          1.000000  1.000000  1.000000  1.000000  -0.693512
2          1.000000  1.000000  1.000000  1.000000  -0.693493
3          1.000000  1.000000  1.000000  1.000000  -0.693501
portfolio -0.693483 -0.693512 -0.693493 -0.693501   1.000000
------------------
Timestep 88000, Reward: 578.1950300362818, TD Loss: 20.20051181269553
test
0:  annret:9.067,  sharpe:0.946
1:  annret:20.024,  sharpe:0.888
2:  annret:17.640,  sharpe:0.782
3:  annret:20.947,  sharpe:0.927
          0         1         2         3
0  1.000000  0.051738  0.090890  0.230911
1  0.051738  1.000000  0.940867  0.936001
2  0.090890  0.940867  1.000000  0.934271
3  0.230911  0.936001  0.934271  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.839,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.838,  sharpe:-0.060
portfolio:  annret:51.536,  sharpe:2.499
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.822874
1          1.000000  1.000000  1.000000  1.000000  -0.822887
2          1.000000  1.000000  1.000000  1.000000  -0.822885
3          1.000000  1.000000  1.000000  1.000000  -0.822886
portfolio -0.822874 -0.822887 -0.822885 -0.822886   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:24.702,  sharpe:1.491
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.927935
1          1.000000  1.00000  1.000000  1.000000  -0.927960
2          1.000000  1.00000  1.000000  1.000000  -0.927957
3          1.000000  1.00000  1.000000  1.000000  -0.927955
portfolio -0.927935 -0.92796 -0.927957 -0.927955   1.000000
------------------
Timestep 89000, Reward: 578.1950300362818, TD Loss: 24.15932040685261
test
0:  annret:13.350,  sharpe:0.898
1:  annret:17.927,  sharpe:0.865
2:  annret:10.649,  sharpe:0.571
3:  annret:13.804,  sharpe:0.791
          0         1         2         3
0  1.000000  0.752850  0.841158  0.810806
1  0.752850  1.000000  0.898222  0.831752
2  0.841158  0.898222  1.000000  0.846314
3  0.810806  0.831752  0.846314  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:56.903,  sharpe:3.429
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000  -0.621463
1          1.000000  1.000000  1.00000  1.000000  -0.621478
2          1.000000  1.000000  1.00000  1.000000  -0.621470
3          1.000000  1.000000  1.00000  1.000000  -0.621475
portfolio -0.621463 -0.621478 -0.62147 -0.621475   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.421,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:16.641,  sharpe:1.543
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.746270
1          1.00000  1.000000  1.000000  1.000000  -0.746298
2          1.00000  1.000000  1.000000  1.000000  -0.746283
3          1.00000  1.000000  1.000000  1.000000  -0.746266
portfolio -0.74627 -0.746298 -0.746283 -0.746266   1.000000
------------------
0:  annret:13.172,  sharpe:0.634
1:  annret:21.671,  sharpe:0.889
2:  annret:29.481,  sharpe:1.335
3:  annret:26.806,  sharpe:1.157
          0         1         2         3
0  1.000000  0.400066  0.272472  0.399017
1  0.400066  1.000000  0.559097  0.631782
2  0.272472  0.559097  1.000000  0.523290
3  0.399017  0.631782  0.523290  1.000000
Timestep 90000, Reward: 559.0669087788691, TD Loss: 27.18134541786361
test
0:  annret:20.425,  sharpe:0.911
1:  annret:20.878,  sharpe:0.937
2:  annret:17.053,  sharpe:0.754
3:  annret:19.084,  sharpe:0.891
          0         1         2         3
0  1.000000  0.934006  0.950013  0.925901
1  0.934006  1.000000  0.968781  0.936114
2  0.950013  0.968781  1.000000  0.938582
3  0.925901  0.936114  0.938582  1.000000
train
0:  annret:-1.835,  sharpe:-0.060
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:39.865,  sharpe:1.731
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.915163
1          1.000000  1.000000  1.000000  1.000000  -0.915162
2          1.000000  1.000000  1.000000  1.000000  -0.915163
3          1.000000  1.000000  1.000000  1.000000  -0.915163
portfolio -0.915163 -0.915162 -0.915163 -0.915163   1.000000
test
0:  annret:-17.416,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:22.235,  sharpe:1.199
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.960823
1          1.000000  1.000000  1.000000  1.000000  -0.960824
2          1.000000  1.000000  1.000000  1.000000  -0.960826
3          1.000000  1.000000  1.000000  1.000000  -0.960823
portfolio -0.960823 -0.960824 -0.960826 -0.960823   1.000000
------------------
Timestep 91000, Reward: 559.0669087788691, TD Loss: 11.847181185049132
test
0:  annret:-0.172,  sharpe:-0.014
1:  annret:14.901,  sharpe:0.753
2:  annret:13.017,  sharpe:0.688
3:  annret:20.433,  sharpe:1.071
          0         1         2         3
0  1.000000 -0.592263 -0.548566 -0.555737
1 -0.592263  1.000000  0.887666  0.852860
2 -0.548566  0.887666  1.000000  0.871219
3 -0.555737  0.852860  0.871219  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:62.241,  sharpe:3.897
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.398806
1          1.000000  1.000000  1.000000  1.000000  -0.398821
2          1.000000  1.000000  1.000000  1.000000  -0.398817
3          1.000000  1.000000  1.000000  1.000000  -0.398815
portfolio -0.398806 -0.398821 -0.398817 -0.398815   1.000000
test
0:  annret:-17.409,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:15.658,  sharpe:1.765
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.589646
1          1.000000  1.000000  1.000000  1.000000  -0.589676
2          1.000000  1.000000  1.000000  1.000000  -0.589661
3          1.000000  1.000000  1.000000  1.000000  -0.589662
portfolio -0.589646 -0.589676 -0.589661 -0.589662   1.000000
------------------
0:  annret:27.459,  sharpe:1.290
1:  annret:16.922,  sharpe:0.721
2:  annret:33.367,  sharpe:1.522
3:  annret:21.182,  sharpe:0.982
          0         1         2         3
0  1.000000  0.138737  0.264612  0.317480
1  0.138737  1.000000  0.533556  0.508798
2  0.264612  0.533556  1.000000  0.503960
3  0.317480  0.508798  0.503960  1.000000
Timestep 92000, Reward: 515.036614176755, TD Loss: 6.73033025391526
test
0:  annret:16.122,  sharpe:0.924
1:  annret:7.151,  sharpe:0.758
2:  annret:16.001,  sharpe:0.793
3:  annret:19.939,  sharpe:1.007
          0         1         2         3
0  1.000000  0.320431  0.847233  0.848834
1  0.320431  1.000000  0.472347  0.413612
2  0.847233  0.472347  1.000000  0.867031
3  0.848834  0.413612  0.867031  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.833,  sharpe:-0.060
portfolio:  annret:58.977,  sharpe:4.164
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.481469
1          1.000000  1.000000  1.000000  1.000000  -0.481462
2          1.000000  1.000000  1.000000  1.000000  -0.481475
3          1.000000  1.000000  1.000000  1.000000  -0.481476
portfolio -0.481469 -0.481462 -0.481475 -0.481476   1.000000
test
0:  annret:-17.408,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:17.747,  sharpe:2.090
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.470041
1          1.000000  1.000000  1.000000  1.000000  -0.470018
2          1.000000  1.000000  1.000000  1.000000  -0.470043
3          1.000000  1.000000  1.000000  1.000000  -0.470037
portfolio -0.470041 -0.470018 -0.470043 -0.470037   1.000000
------------------
Timestep 93000, Reward: 515.036614176755, TD Loss: 20.704457772867137
test
0:  annret:10.935,  sharpe:1.178
1:  annret:12.358,  sharpe:0.685
2:  annret:14.210,  sharpe:0.690
3:  annret:17.628,  sharpe:0.933
          0         1         2         3
0  1.000000  0.081823  0.217400  0.310939
1  0.081823  1.000000  0.914265  0.848967
2  0.217400  0.914265  1.000000  0.891091
3  0.310939  0.848967  0.891091  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:58.655,  sharpe:3.750
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.522075
1          1.000000  1.000000  1.000000  1.000000  -0.522085
2          1.000000  1.000000  1.000000  1.000000  -0.522088
3          1.000000  1.000000  1.000000  1.000000  -0.522089
portfolio -0.522075 -0.522085 -0.522088 -0.522089   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:17.907,  sharpe:1.893
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.699247
1          1.000000  1.000000  1.000000  1.000000  -0.699272
2          1.000000  1.000000  1.000000  1.000000  -0.699274
3          1.000000  1.000000  1.000000  1.000000  -0.699265
portfolio -0.699247 -0.699272 -0.699274 -0.699265   1.000000
------------------
0:  annret:19.100,  sharpe:0.860
1:  annret:16.275,  sharpe:0.758
2:  annret:32.212,  sharpe:1.408
3:  annret:27.484,  sharpe:1.198
          0         1         2         3
0  1.000000  0.398088  0.390806  0.397637
1  0.398088  1.000000  0.507035  0.541804
2  0.390806  0.507035  1.000000  0.603908
3  0.397637  0.541804  0.603908  1.000000
Timestep 94000, Reward: 523.5164842117638, TD Loss: 11.352039436344057
test
0:  annret:5.102,  sharpe:0.469
1:  annret:11.662,  sharpe:1.180
2:  annret:15.088,  sharpe:0.709
3:  annret:20.326,  sharpe:0.997
          0         1         2         3
0  1.000000 -0.398779 -0.544249 -0.449686
1 -0.398779  1.000000  0.588418  0.591858
2 -0.544249  0.588418  1.000000  0.903362
3 -0.449686  0.591858  0.903362  1.000000
train
0:  annret:-1.822,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:65.140,  sharpe:4.732
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.300439
1          1.000000  1.000000  1.000000  1.000000  -0.300439
2          1.000000  1.000000  1.000000  1.000000  -0.300449
3          1.000000  1.000000  1.000000  1.000000  -0.300448
portfolio -0.300439 -0.300439 -0.300449 -0.300448   1.000000
test
0:  annret:-17.403,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:17.970,  sharpe:2.415
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.460351
1          1.000000  1.000000  1.000000  1.000000  -0.460365
2          1.000000  1.000000  1.000000  1.000000  -0.460395
3          1.000000  1.000000  1.000000  1.000000  -0.460385
portfolio -0.460351 -0.460365 -0.460395 -0.460385   1.000000
------------------
Timestep 95000, Reward: 523.5164842117638, TD Loss: 38.69820702974089
test
0:  annret:3.483,  sharpe:0.347
1:  annret:-2.097,  sharpe:-0.156
2:  annret:13.262,  sharpe:0.685
3:  annret:16.041,  sharpe:0.935
          0         1         2         3
0  1.000000 -0.051574  0.235031  0.400202
1 -0.051574  1.000000 -0.732822 -0.603693
2  0.235031 -0.732822  1.000000  0.846004
3  0.400202 -0.603693  0.846004  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:58.438,  sharpe:4.042
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.141727
1          1.000000  1.000000  1.000000  1.000000  -0.141728
2          1.000000  1.000000  1.000000  1.000000  -0.141735
3          1.000000  1.000000  1.000000  1.000000  -0.141733
portfolio -0.141727 -0.141728 -0.141735 -0.141733   1.000000
test
0:  annret:-17.409,  sharpe:-0.674
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:15.704,  sharpe:1.958
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.281650
1          1.00000  1.000000  1.000000  1.000000  -0.281665
2          1.00000  1.000000  1.000000  1.000000  -0.281683
3          1.00000  1.000000  1.000000  1.000000  -0.281658
portfolio -0.28165 -0.281665 -0.281683 -0.281658   1.000000
------------------
0:  annret:13.629,  sharpe:0.679
1:  annret:15.284,  sharpe:0.717
2:  annret:29.131,  sharpe:1.266
3:  annret:27.187,  sharpe:1.214
          0         1         2         3
0  1.000000  0.525728  0.338839  0.431034
1  0.525728  1.000000  0.441999  0.452480
2  0.338839  0.441999  1.000000  0.544495
3  0.431034  0.452480  0.544495  1.000000
Timestep 96000, Reward: 482.9508107486465, TD Loss: 22.570741339355045
test
0:  annret:18.814,  sharpe:0.989
1:  annret:1.704,  sharpe:0.203
2:  annret:14.105,  sharpe:0.668
3:  annret:20.986,  sharpe:1.009
          0         1         2        3
0  1.000000 -0.235960  0.875367  0.86629
1 -0.235960  1.000000 -0.019179 -0.10469
2  0.875367 -0.019179  1.000000  0.87107
3  0.866290 -0.104690  0.871070  1.00000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:57.272,  sharpe:3.421
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000  -0.632648
1          1.000000  1.000000  1.00000  1.000000  -0.632642
2          1.000000  1.000000  1.00000  1.000000  -0.632650
3          1.000000  1.000000  1.00000  1.000000  -0.632646
portfolio -0.632648 -0.632642 -0.63265 -0.632646   1.000000
test
0:  annret:-17.408,  sharpe:-0.674
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:17.903,  sharpe:1.500
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.730819
1          1.000000  1.000000  1.000000  1.000000  -0.730814
2          1.000000  1.000000  1.000000  1.000000  -0.730834
3          1.000000  1.000000  1.000000  1.000000  -0.730812
portfolio -0.730819 -0.730814 -0.730834 -0.730812   1.000000
------------------
Timestep 97000, Reward: 482.9508107486465, TD Loss: 170.5497252657933
test
0:  annret:12.049,  sharpe:0.704
1:  annret:17.402,  sharpe:0.801
2:  annret:6.552,  sharpe:0.452
3:  annret:17.667,  sharpe:0.789
          0         1         2         3
0  1.000000  0.833345  0.845203  0.869467
1  0.833345  1.000000  0.787901  0.960323
2  0.845203  0.787901  1.000000  0.798869
3  0.869467  0.960323  0.798869  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.831,  sharpe:-0.059
3:  annret:-1.839,  sharpe:-0.060
portfolio:  annret:49.969,  sharpe:2.813
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.667063
1          1.000000  1.000000  1.000000  1.000000  -0.667063
2          1.000000  1.000000  1.000000  1.000000  -0.667059
3          1.000000  1.000000  1.000000  1.000000  -0.667061
portfolio -0.667063 -0.667063 -0.667059 -0.667061   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.415,  sharpe:-0.674
3:  annret:-17.421,  sharpe:-0.674
portfolio:  annret:18.750,  sharpe:1.433
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.870259
1          1.000000  1.000000  1.000000  1.000000  -0.870273
2          1.000000  1.000000  1.000000  1.000000  -0.870252
3          1.000000  1.000000  1.000000  1.000000  -0.870277
portfolio -0.870259 -0.870273 -0.870252 -0.870277   1.000000
------------------
0:  annret:19.294,  sharpe:0.904
1:  annret:17.262,  sharpe:0.842
2:  annret:25.218,  sharpe:1.125
3:  annret:27.912,  sharpe:1.256
          0         1         2         3
0  1.000000  0.484975  0.424062  0.526186
1  0.484975  1.000000  0.455614  0.460583
2  0.424062  0.455614  1.000000  0.530188
3  0.526186  0.460583  0.530188  1.000000
Timestep 98000, Reward: 524.5678985918731, TD Loss: 14.498455266790224
test
0:  annret:15.749,  sharpe:0.880
1:  annret:7.308,  sharpe:0.657
2:  annret:9.066,  sharpe:0.557
3:  annret:23.067,  sharpe:1.386
          0         1         2         3
0  1.000000  0.500467  0.798511  0.761735
1  0.500467  1.000000  0.591344  0.428941
2  0.798511  0.591344  1.000000  0.606809
3  0.761735  0.428941  0.606809  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.833,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.060
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:61.409,  sharpe:3.917
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.497657
1          1.000000  1.000000  1.000000  1.000000  -0.497654
2          1.000000  1.000000  1.000000  1.000000  -0.497658
3          1.000000  1.000000  1.000000  1.000000  -0.497651
portfolio -0.497657 -0.497654 -0.497658 -0.497651   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:16.902,  sharpe:1.700
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.563238
1          1.000000  1.00000  1.000000  1.000000  -0.563250
2          1.000000  1.00000  1.000000  1.000000  -0.563252
3          1.000000  1.00000  1.000000  1.000000  -0.563234
portfolio -0.563238 -0.56325 -0.563252 -0.563234   1.000000
------------------
Timestep 99000, Reward: 524.5678985918731, TD Loss: 22.522117709090544
test
0:  annret:21.261,  sharpe:0.938
1:  annret:18.833,  sharpe:0.839
2:  annret:17.230,  sharpe:0.779
3:  annret:23.463,  sharpe:1.029
          0         1         2         3
0  1.000000  0.921536  0.953528  0.937714
1  0.921536  1.000000  0.948889  0.931357
2  0.953528  0.948889  1.000000  0.944125
3  0.937714  0.931357  0.944125  1.000000
train
0:  annret:-1.836,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:33.716,  sharpe:1.370
                  0        1        2        3  portfolio
0          1.000000  1.00000  1.00000  1.00000  -0.947151
1          1.000000  1.00000  1.00000  1.00000  -0.947150
2          1.000000  1.00000  1.00000  1.00000  -0.947150
3          1.000000  1.00000  1.00000  1.00000  -0.947150
portfolio -0.947151 -0.94715 -0.94715 -0.94715   1.000000
test
0:  annret:-17.414,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:24.275,  sharpe:1.207
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.974358
1          1.000000  1.000000  1.000000  1.000000  -0.974358
2          1.000000  1.000000  1.000000  1.000000  -0.974359
3          1.000000  1.000000  1.000000  1.000000  -0.974358
portfolio -0.974358 -0.974358 -0.974359 -0.974358   1.000000
------------------
Timestep 100000, Reward: 524.5678985918731, TD Loss: 10.677471396261893
test
0:  annret:11.730,  sharpe:0.696
1:  annret:1.010,  sharpe:0.060
2:  annret:14.868,  sharpe:0.950
3:  annret:19.281,  sharpe:1.467
          0         1         2         3
0  1.000000 -0.625465  0.754051  0.642329
1 -0.625465  1.000000 -0.574984 -0.408685
2  0.754051 -0.574984  1.000000  0.561895
3  0.642329 -0.408685  0.561895  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.830,  sharpe:-0.059
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:65.229,  sharpe:4.511
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.311083
1          1.000000  1.000000  1.000000  1.000000  -0.311078
2          1.000000  1.000000  1.000000  1.000000  -0.311079
3          1.000000  1.000000  1.000000  1.000000  -0.311082
portfolio -0.311083 -0.311078 -0.311079 -0.311082   1.000000
test
0:  annret:-17.408,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:18.984,  sharpe:2.198
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.482775
1          1.000000  1.000000  1.000000  1.000000  -0.482785
2          1.000000  1.000000  1.000000  1.000000  -0.482778
3          1.000000  1.000000  1.000000  1.000000  -0.482778
portfolio -0.482775 -0.482785 -0.482778 -0.482778   1.000000
------------------
0:  annret:18.054,  sharpe:0.809
1:  annret:15.995,  sharpe:0.712
2:  annret:28.580,  sharpe:1.297
3:  annret:27.198,  sharpe:1.243
          0         1         2         3
0  1.000000  0.622514  0.531744  0.544392
1  0.622514  1.000000  0.472737  0.569511
2  0.531744  0.472737  1.000000  0.439148
3  0.544392  0.569511  0.439148  1.000000
Timestep 101000, Reward: 560.6517270965808, TD Loss: 28.89079055129764
test
0:  annret:20.379,  sharpe:0.943
1:  annret:18.527,  sharpe:0.810
2:  annret:17.643,  sharpe:0.808
3:  annret:21.253,  sharpe:0.944
          0         1         2         3
0  1.000000  0.880565  0.906782  0.886307
1  0.880565  1.000000  0.959752  0.948216
2  0.906782  0.959752  1.000000  0.941224
3  0.886307  0.948216  0.941224  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.838,  sharpe:-0.060
portfolio:  annret:39.066,  sharpe:1.715
                  0         1        2        3  portfolio
0          1.000000  1.000000  1.00000  1.00000  -0.911089
1          1.000000  1.000000  1.00000  1.00000  -0.911092
2          1.000000  1.000000  1.00000  1.00000  -0.911090
3          1.000000  1.000000  1.00000  1.00000  -0.911090
portfolio -0.911089 -0.911092 -0.91109 -0.91109   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:22.858,  sharpe:1.252
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.958317
1          1.000000  1.000000  1.000000  1.000000  -0.958326
2          1.000000  1.000000  1.000000  1.000000  -0.958323
3          1.000000  1.000000  1.000000  1.000000  -0.958323
portfolio -0.958317 -0.958326 -0.958323 -0.958323   1.000000
------------------
Timestep 102000, Reward: 560.6517270965808, TD Loss: 28.82813960524167
test
0:  annret:18.276,  sharpe:0.905
1:  annret:18.904,  sharpe:1.065
2:  annret:20.313,  sharpe:1.188
3:  annret:20.317,  sharpe:1.010
          0         1         2         3
0  1.000000  0.764767  0.889481  0.893359
1  0.764767  1.000000  0.823953  0.835090
2  0.889481  0.823953  1.000000  0.847118
3  0.893359  0.835090  0.847118  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.830,  sharpe:-0.059
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:53.724,  sharpe:3.074
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.707206
1          1.000000  1.000000  1.000000  1.000000  -0.707208
2          1.000000  1.000000  1.000000  1.000000  -0.707203
3          1.000000  1.000000  1.000000  1.000000  -0.707202
portfolio -0.707206 -0.707208 -0.707203 -0.707202   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.422,  sharpe:-0.674
portfolio:  annret:18.686,  sharpe:1.509
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.860041
1          1.000000  1.000000  1.000000  1.000000  -0.860049
2          1.000000  1.000000  1.000000  1.000000  -0.860034
3          1.000000  1.000000  1.000000  1.000000  -0.860035
portfolio -0.860041 -0.860049 -0.860034 -0.860035   1.000000
------------------
0:  annret:24.370,  sharpe:1.073
1:  annret:22.060,  sharpe:1.036
2:  annret:39.045,  sharpe:1.756
3:  annret:26.405,  sharpe:1.177
          0         1         2         3
0  1.000000  0.551520  0.605413  0.622820
1  0.551520  1.000000  0.456520  0.534315
2  0.605413  0.456520  1.000000  0.522889
3  0.622820  0.534315  0.522889  1.000000
Timestep 103000, Reward: 598.8124866450714, TD Loss: 20.46413153083185
test
0:  annret:17.597,  sharpe:0.897
1:  annret:19.373,  sharpe:0.940
2:  annret:17.547,  sharpe:0.815
3:  annret:22.956,  sharpe:1.085
          0         1         2         3
0  1.000000  0.850839  0.918350  0.883479
1  0.850839  1.000000  0.928182  0.885474
2  0.918350  0.928182  1.000000  0.901958
3  0.883479  0.885474  0.901958  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:50.029,  sharpe:2.597
                  0         1     2         3  portfolio
0          1.000000  1.000000  1.00  1.000000  -0.829993
1          1.000000  1.000000  1.00  1.000000  -0.830001
2          1.000000  1.000000  1.00  1.000000  -0.830000
3          1.000000  1.000000  1.00  1.000000  -0.830001
portfolio -0.829993 -0.830001 -0.83 -0.830001   1.000000
test
0:  annret:-17.408,  sharpe:-0.673
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.421,  sharpe:-0.674
portfolio:  annret:23.979,  sharpe:1.621
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.909721
1          1.000000  1.000000  1.000000  1.00000  -0.909733
2          1.000000  1.000000  1.000000  1.00000  -0.909733
3          1.000000  1.000000  1.000000  1.00000  -0.909730
portfolio -0.909721 -0.909733 -0.909733 -0.90973   1.000000
------------------
Timestep 104000, Reward: 598.8124866450714, TD Loss: 17.11699675031468
test
0:  annret:17.993,  sharpe:0.847
1:  annret:18.098,  sharpe:0.982
2:  annret:12.746,  sharpe:0.707
3:  annret:19.202,  sharpe:1.005
          0         1         2         3
0  1.000000  0.784234  0.880863  0.860329
1  0.784234  1.000000  0.829911  0.790135
2  0.880863  0.829911  1.000000  0.819085
3  0.860329  0.790135  0.819085  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.838,  sharpe:-0.060
portfolio:  annret:49.099,  sharpe:2.958
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.729608
1          1.000000  1.000000  1.000000  1.000000  -0.729605
2          1.000000  1.000000  1.000000  1.000000  -0.729602
3          1.000000  1.000000  1.000000  1.000000  -0.729611
portfolio -0.729608 -0.729605 -0.729602 -0.729611   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:16.387,  sharpe:1.406
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.843171
1          1.000000  1.000000  1.000000  1.000000  -0.843175
2          1.000000  1.000000  1.000000  1.000000  -0.843166
3          1.000000  1.000000  1.000000  1.000000  -0.843172
portfolio -0.843171 -0.843175 -0.843166 -0.843172   1.000000
------------------
0:  annret:14.266,  sharpe:0.668
1:  annret:24.169,  sharpe:1.126
2:  annret:33.684,  sharpe:1.480
3:  annret:22.167,  sharpe:0.983
          0         1         2         3
0  1.000000  0.412666  0.466239  0.558746
1  0.412666  1.000000  0.544905  0.448692
2  0.466239  0.544905  1.000000  0.519817
3  0.558746  0.448692  0.519817  1.000000
Timestep 105000, Reward: 572.4963849604844, TD Loss: 12.725735771352326
test
0:  annret:16.202,  sharpe:0.927
1:  annret:12.409,  sharpe:0.815
2:  annret:11.392,  sharpe:0.613
3:  annret:17.132,  sharpe:0.906
          0         1         2         3
0  1.000000  0.606162  0.821338  0.777880
1  0.606162  1.000000  0.789761  0.754318
2  0.821338  0.789761  1.000000  0.806035
3  0.777880  0.754318  0.806035  1.000000
train
0:  annret:-1.824,  sharpe:-0.059
1:  annret:-1.833,  sharpe:-0.060
2:  annret:-1.832,  sharpe:-0.059
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:60.533,  sharpe:4.263
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.470778
1          1.000000  1.000000  1.000000  1.000000  -0.470774
2          1.000000  1.000000  1.000000  1.000000  -0.470779
3          1.000000  1.000000  1.000000  1.000000  -0.470785
portfolio -0.470778 -0.470774 -0.470779 -0.470785   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:19.797,  sharpe:2.298
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.490215
1          1.000000  1.000000  1.000000  1.00000  -0.490221
2          1.000000  1.000000  1.000000  1.00000  -0.490235
3          1.000000  1.000000  1.000000  1.00000  -0.490230
portfolio -0.490215 -0.490221 -0.490235 -0.49023   1.000000
------------------
Timestep 106000, Reward: 572.4963849604844, TD Loss: 10.70192078317929
test
0:  annret:16.670,  sharpe:0.816
1:  annret:12.900,  sharpe:1.071
2:  annret:12.996,  sharpe:0.665
3:  annret:14.253,  sharpe:0.842
          0         1         2         3
0  1.000000  0.608282  0.891535  0.826006
1  0.608282  1.000000  0.770067  0.751869
2  0.891535  0.770067  1.000000  0.830930
3  0.826006  0.751869  0.830930  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.833,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:56.202,  sharpe:3.711
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.488646
1          1.000000  1.000000  1.000000  1.000000  -0.488632
2          1.000000  1.000000  1.000000  1.000000  -0.488638
3          1.000000  1.000000  1.000000  1.000000  -0.488639
portfolio -0.488646 -0.488632 -0.488638 -0.488639   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:13.369,  sharpe:1.425
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.595566
1          1.000000  1.000000  1.000000  1.000000  -0.595555
2          1.000000  1.000000  1.000000  1.000000  -0.595577
3          1.000000  1.000000  1.000000  1.000000  -0.595553
portfolio -0.595566 -0.595555 -0.595577 -0.595553   1.000000
------------------
0:  annret:20.389,  sharpe:0.881
1:  annret:18.190,  sharpe:0.878
2:  annret:25.079,  sharpe:1.106
3:  annret:20.514,  sharpe:0.947
          0         1         2         3
0  1.000000  0.521405  0.555209  0.486595
1  0.521405  1.000000  0.421144  0.535175
2  0.555209  0.421144  1.000000  0.372289
3  0.486595  0.535175  0.372289  1.000000
Timestep 107000, Reward: 530.2385925454771, TD Loss: 23.397017748387483
test
0:  annret:10.732,  sharpe:0.700
1:  annret:17.306,  sharpe:1.082
2:  annret:12.035,  sharpe:0.627
3:  annret:11.396,  sharpe:0.918
          0         1         2         3
0  1.000000  0.509101  0.727941  0.466770
1  0.509101  1.000000  0.783560  0.442467
2  0.727941  0.783560  1.000000  0.410398
3  0.466770  0.442467  0.410398  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.831,  sharpe:-0.059
3:  annret:-1.833,  sharpe:-0.060
portfolio:  annret:62.783,  sharpe:4.305
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.335564
1          1.000000  1.000000  1.000000  1.000000  -0.335565
2          1.000000  1.000000  1.000000  1.000000  -0.335562
3          1.000000  1.000000  1.000000  1.000000  -0.335559
portfolio -0.335564 -0.335565 -0.335562 -0.335559   1.000000
test
0:  annret:-17.408,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.415,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:18.482,  sharpe:2.061
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.375357
1          1.000000  1.00000  1.000000  1.000000  -0.375360
2          1.000000  1.00000  1.000000  1.000000  -0.375369
3          1.000000  1.00000  1.000000  1.000000  -0.375338
portfolio -0.375357 -0.37536 -0.375369 -0.375338   1.000000
------------------
Timestep 108000, Reward: 530.2385925454771, TD Loss: 67.0791835196739
test
0:  annret:1.617,  sharpe:0.171
1:  annret:8.553,  sharpe:0.913
2:  annret:13.525,  sharpe:0.730
3:  annret:19.356,  sharpe:0.957
          0         1         2         3
0  1.000000  0.180275 -0.317488 -0.322294
1  0.180275  1.000000  0.441398  0.483087
2 -0.317488  0.441398  1.000000  0.882776
3 -0.322294  0.483087  0.882776  1.000000
train
0:  annret:-1.833,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:60.718,  sharpe:4.040
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.209201
1          1.000000  1.000000  1.000000  1.000000  -0.209204
2          1.000000  1.000000  1.000000  1.000000  -0.209206
3          1.000000  1.000000  1.000000  1.000000  -0.209208
portfolio -0.209201 -0.209204 -0.209206 -0.209208   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:14.276,  sharpe:1.856
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.328148
1          1.000000  1.000000  1.000000  1.000000  -0.328136
2          1.000000  1.000000  1.000000  1.000000  -0.328164
3          1.000000  1.000000  1.000000  1.000000  -0.328156
portfolio -0.328148 -0.328136 -0.328164 -0.328156   1.000000
------------------
0:  annret:16.418,  sharpe:0.720
1:  annret:18.655,  sharpe:0.853
2:  annret:31.989,  sharpe:1.402
3:  annret:30.347,  sharpe:1.322
          0         1         2         3
0  1.000000  0.560038  0.552394  0.523366
1  0.560038  1.000000  0.531441  0.528479
2  0.552394  0.531441  1.000000  0.449207
3  0.523366  0.528479  0.449207  1.000000
Timestep 109000, Reward: 568.7530752655736, TD Loss: 11.258116955133277
test
0:  annret:17.080,  sharpe:0.782
1:  annret:12.054,  sharpe:0.734
2:  annret:14.089,  sharpe:0.675
3:  annret:22.081,  sharpe:1.065
          0         1         2         3
0  1.000000  0.764047  0.916132  0.863454
1  0.764047  1.000000  0.850885  0.834601
2  0.916132  0.850885  1.000000  0.894855
3  0.863454  0.834601  0.894855  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:49.117,  sharpe:2.639
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.776062
1          1.000000  1.000000  1.000000  1.000000  -0.776055
2          1.000000  1.000000  1.000000  1.000000  -0.776057
3          1.000000  1.000000  1.000000  1.000000  -0.776051
portfolio -0.776062 -0.776055 -0.776057 -0.776051   1.000000
test
0:  annret:-17.414,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:16.183,  sharpe:1.153
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.889610
1          1.00000  1.000000  1.000000  1.000000  -0.889602
2          1.00000  1.000000  1.000000  1.000000  -0.889612
3          1.00000  1.000000  1.000000  1.000000  -0.889601
portfolio -0.88961 -0.889602 -0.889612 -0.889601   1.000000
------------------
Timestep 110000, Reward: 568.7530752655736, TD Loss: 73.87087954757202
test
0:  annret:19.971,  sharpe:0.863
1:  annret:18.222,  sharpe:0.767
2:  annret:15.559,  sharpe:0.678
3:  annret:19.020,  sharpe:0.827
          0         1         2         3
0  1.000000  0.962136  0.968659  0.959711
1  0.962136  1.000000  0.977494  0.970309
2  0.968659  0.977494  1.000000  0.966694
3  0.959711  0.970309  0.966694  1.000000
train
0:  annret:-1.838,  sharpe:-0.060
1:  annret:-1.840,  sharpe:-0.060
2:  annret:-1.839,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:26.134,  sharpe:0.961
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.968527
1          1.000000  1.000000  1.000000  1.000000  -0.968526
2          1.000000  1.000000  1.000000  1.000000  -0.968523
3          1.000000  1.000000  1.000000  1.000000  -0.968522
portfolio -0.968527 -0.968526 -0.968523 -0.968522   1.000000
test
0:  annret:-17.418,  sharpe:-0.674
1:  annret:-17.417,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:20.350,  sharpe:0.886
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.990346
1          1.000000  1.000000  1.000000  1.000000  -0.990347
2          1.000000  1.000000  1.000000  1.000000  -0.990346
3          1.000000  1.000000  1.000000  1.000000  -0.990343
portfolio -0.990346 -0.990347 -0.990346 -0.990343   1.000000
------------------
0:  annret:21.450,  sharpe:0.976
1:  annret:22.641,  sharpe:1.046
2:  annret:29.649,  sharpe:1.358
3:  annret:33.783,  sharpe:1.533
          0         1         2         3
0  1.000000  0.539375  0.604870  0.356070
1  0.539375  1.000000  0.513422  0.136009
2  0.604870  0.513422  1.000000  0.270615
3  0.356070  0.136009  0.270615  1.000000
Timestep 111000, Reward: 546.7351176481941, TD Loss: 8.161909918037228
test
0:  annret:11.167,  sharpe:1.100
1:  annret:-8.227,  sharpe:-0.398
2:  annret:8.557,  sharpe:0.798
3:  annret:7.623,  sharpe:0.550
          0         1         2         3
0  1.000000  0.297090  0.254508 -0.271220
1  0.297090  1.000000  0.270716 -0.662158
2  0.254508  0.270716  1.000000 -0.165539
3 -0.271220 -0.662158 -0.165539  1.000000
train
0:  annret:-1.821,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.830,  sharpe:-0.059
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:67.934,  sharpe:4.447
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000   0.344858
1          1.000000  1.000000  1.00000  1.000000   0.344847
2          1.000000  1.000000  1.00000  1.000000   0.344860
3          1.000000  1.000000  1.00000  1.000000   0.344851
portfolio  0.344858  0.344847  0.34486  0.344851   1.000000
test
0:  annret:-17.403,  sharpe:-0.673
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:13.410,  sharpe:1.392
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000   0.447178
1          1.000000  1.00000  1.000000  1.000000   0.447130
2          1.000000  1.00000  1.000000  1.000000   0.447143
3          1.000000  1.00000  1.000000  1.000000   0.447154
portfolio  0.447178  0.44713  0.447143  0.447154   1.000000
------------------
Timestep 112000, Reward: 546.7351176481941, TD Loss: 12.828567387949619
test
0:  annret:17.993,  sharpe:0.830
1:  annret:20.221,  sharpe:0.907
2:  annret:16.084,  sharpe:0.721
3:  annret:21.236,  sharpe:0.944
          0         1         2         3
0  1.000000  0.887410  0.930615  0.910837
1  0.887410  1.000000  0.945726  0.925017
2  0.930615  0.945726  1.000000  0.941317
3  0.910837  0.925017  0.941317  1.000000
train
0:  annret:-1.833,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.838,  sharpe:-0.060
portfolio:  annret:38.849,  sharpe:1.663
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.915605
1          1.000000  1.000000  1.000000  1.000000  -0.915607
2          1.000000  1.000000  1.000000  1.000000  -0.915605
3          1.000000  1.000000  1.000000  1.000000  -0.915606
portfolio -0.915605 -0.915607 -0.915605 -0.915606   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:21.550,  sharpe:1.139
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.966412
1          1.000000  1.00000  1.000000  1.000000  -0.966420
2          1.000000  1.00000  1.000000  1.000000  -0.966419
3          1.000000  1.00000  1.000000  1.000000  -0.966418
portfolio -0.966412 -0.96642 -0.966419 -0.966418   1.000000
------------------
Timestep 113000, Reward: 546.7351176481941, TD Loss: 36.40089393709018
test
0:  annret:12.538,  sharpe:0.850
1:  annret:18.541,  sharpe:1.096
2:  annret:12.112,  sharpe:0.683
3:  annret:-5.244,  sharpe:-0.310
          0         1         2         3
0  1.000000  0.634102  0.771381 -0.637528
1  0.634102  1.000000  0.804861 -0.792159
2  0.771381  0.804861  1.000000 -0.796707
3 -0.637528 -0.792159 -0.796707  1.000000
train
0:  annret:-1.824,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.832,  sharpe:-0.059
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:63.202,  sharpe:4.316
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.351265
1          1.000000  1.000000  1.000000  1.000000  -0.351272
2          1.000000  1.000000  1.000000  1.000000  -0.351267
3          1.000000  1.000000  1.000000  1.000000  -0.351263
portfolio -0.351265 -0.351272 -0.351267 -0.351263   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:18.444,  sharpe:2.103
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.511589
1          1.000000  1.000000  1.000000  1.000000  -0.511623
2          1.000000  1.000000  1.000000  1.000000  -0.511617
3          1.000000  1.000000  1.000000  1.000000  -0.511582
portfolio -0.511589 -0.511623 -0.511617 -0.511582   1.000000
------------------
0:  annret:14.406,  sharpe:0.671
1:  annret:15.289,  sharpe:0.679
2:  annret:31.358,  sharpe:1.383
3:  annret:25.710,  sharpe:1.157
          0         1         2         3
0  1.000000  0.533180  0.466895  0.473026
1  0.533180  1.000000  0.521885  0.298819
2  0.466895  0.521885  1.000000  0.379945
3  0.473026  0.298819  0.379945  1.000000
Timestep 114000, Reward: 520.5096852018817, TD Loss: 16.17927135528593
test
0:  annret:15.629,  sharpe:0.841
1:  annret:17.737,  sharpe:0.922
2:  annret:16.490,  sharpe:0.792
3:  annret:21.322,  sharpe:0.950
          0         1         2         3
0  1.000000  0.843228  0.897795  0.891366
1  0.843228  1.000000  0.921891  0.918454
2  0.897795  0.921891  1.000000  0.923657
3  0.891366  0.918454  0.923657  1.000000
train
0:  annret:-1.833,  sharpe:-0.059
1:  annret:-1.833,  sharpe:-0.059
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.838,  sharpe:-0.060
portfolio:  annret:51.095,  sharpe:2.601
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.797307
1          1.000000  1.000000  1.000000  1.000000  -0.797313
2          1.000000  1.000000  1.000000  1.000000  -0.797314
3          1.000000  1.000000  1.000000  1.000000  -0.797315
portfolio -0.797307 -0.797313 -0.797314 -0.797315   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.411,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:21.858,  sharpe:1.419
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.908706
1          1.000000  1.000000  1.000000  1.000000  -0.908707
2          1.000000  1.000000  1.000000  1.000000  -0.908716
3          1.000000  1.000000  1.000000  1.000000  -0.908719
portfolio -0.908706 -0.908707 -0.908716 -0.908719   1.000000
------------------
Timestep 115000, Reward: 520.5096852018817, TD Loss: 17.955061454957253
test
0:  annret:16.367,  sharpe:0.956
1:  annret:9.866,  sharpe:0.618
2:  annret:15.009,  sharpe:0.776
3:  annret:16.924,  sharpe:0.857
          0         1         2         3
0  1.000000  0.759796  0.869160  0.832001
1  0.759796  1.000000  0.852921  0.843240
2  0.869160  0.852921  1.000000  0.879562
3  0.832001  0.843240  0.879562  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:57.696,  sharpe:3.648
                  0       1         2         3  portfolio
0          1.000000  1.0000  1.000000  1.000000  -0.551699
1          1.000000  1.0000  1.000000  1.000000  -0.551700
2          1.000000  1.0000  1.000000  1.000000  -0.551705
3          1.000000  1.0000  1.000000  1.000000  -0.551706
portfolio -0.551699 -0.5517 -0.551705 -0.551706   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:19.611,  sharpe:1.918
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.696973
1          1.000000  1.000000  1.000000  1.000000  -0.696985
2          1.000000  1.000000  1.000000  1.000000  -0.696993
3          1.000000  1.000000  1.000000  1.000000  -0.696981
portfolio -0.696973 -0.696985 -0.696993 -0.696981   1.000000
------------------
0:  annret:18.979,  sharpe:0.936
1:  annret:22.103,  sharpe:1.046
2:  annret:36.835,  sharpe:1.644
3:  annret:28.561,  sharpe:1.230
          0         1         2         3
0  1.000000  0.488408  0.538631  0.573806
1  0.488408  1.000000  0.498421  0.510396
2  0.538631  0.498421  1.000000  0.609110
3  0.573806  0.510396  0.609110  1.000000
Timestep 116000, Reward: 561.7667915818683, TD Loss: 22.66583128896457
test
0:  annret:14.613,  sharpe:0.841
1:  annret:16.837,  sharpe:0.868
2:  annret:15.763,  sharpe:0.762
3:  annret:20.919,  sharpe:0.960
          0         1         2         3
0  1.000000  0.739386  0.852418  0.816951
1  0.739386  1.000000  0.899052  0.894453
2  0.852418  0.899052  1.000000  0.900679
3  0.816951  0.894453  0.900679  1.000000
train
0:  annret:-1.825,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:55.568,  sharpe:3.110
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.722851
1          1.000000  1.000000  1.000000  1.000000  -0.722854
2          1.000000  1.000000  1.000000  1.000000  -0.722857
3          1.000000  1.000000  1.000000  1.000000  -0.722854
portfolio -0.722851 -0.722854 -0.722857 -0.722854   1.000000
test
0:  annret:-17.405,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:23.288,  sharpe:1.783
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.811253
1          1.000000  1.000000  1.000000  1.000000  -0.811269
2          1.000000  1.000000  1.000000  1.000000  -0.811281
3          1.000000  1.000000  1.000000  1.000000  -0.811272
portfolio -0.811253 -0.811269 -0.811281 -0.811272   1.000000
------------------
Timestep 117000, Reward: 561.7667915818683, TD Loss: 11.707256509531739
test
0:  annret:13.700,  sharpe:0.778
1:  annret:13.180,  sharpe:0.710
2:  annret:15.695,  sharpe:0.767
3:  annret:18.837,  sharpe:1.130
          0         1         2         3
0  1.000000  0.729236  0.890005  0.781631
1  0.729236  1.000000  0.876353  0.782163
2  0.890005  0.876353  1.000000  0.833310
3  0.781631  0.782163  0.833310  1.000000
train
0:  annret:-1.826,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.838,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:53.451,  sharpe:3.223
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.635477
1          1.000000  1.00000  1.000000  1.000000  -0.635480
2          1.000000  1.00000  1.000000  1.000000  -0.635483
3          1.000000  1.00000  1.000000  1.000000  -0.635474
portfolio -0.635477 -0.63548 -0.635483 -0.635474   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.421,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:20.398,  sharpe:1.820
                  0         1       2         3  portfolio
0          1.000000  1.000000  1.0000  1.000000  -0.773182
1          1.000000  1.000000  1.0000  1.000000  -0.773199
2          1.000000  1.000000  1.0000  1.000000  -0.773200
3          1.000000  1.000000  1.0000  1.000000  -0.773174
portfolio -0.773182 -0.773199 -0.7732 -0.773174   1.000000
------------------
0:  annret:23.155,  sharpe:1.084
1:  annret:30.536,  sharpe:1.443
2:  annret:27.305,  sharpe:1.203
3:  annret:26.375,  sharpe:1.166
          0         1         2         3
0  1.000000  0.342021  0.394674  0.590383
1  0.342021  1.000000  0.452715  0.403486
2  0.394674  0.452715  1.000000  0.475804
3  0.590383  0.403486  0.475804  1.000000
Timestep 118000, Reward: 547.3660858089344, TD Loss: 16.57889638350921
test
0:  annret:-2.234,  sharpe:-0.205
1:  annret:16.604,  sharpe:0.882
2:  annret:15.284,  sharpe:0.976
3:  annret:19.103,  sharpe:0.954
          0         1         2         3
0  1.000000 -0.622812 -0.487609 -0.664007
1 -0.622812  1.000000  0.776904  0.826122
2 -0.487609  0.776904  1.000000  0.799645
3 -0.664007  0.826122  0.799645  1.000000
train
0:  annret:-1.820,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:68.254,  sharpe:4.554
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.327640
1          1.00000  1.000000  1.000000  1.000000  -0.327649
2          1.00000  1.000000  1.000000  1.000000  -0.327651
3          1.00000  1.000000  1.000000  1.000000  -0.327638
portfolio -0.32764 -0.327649 -0.327651 -0.327638   1.000000
test
0:  annret:-17.400,  sharpe:-0.673
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:21.175,  sharpe:2.383
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.460867
1          1.000000  1.000000  1.000000  1.000000  -0.460909
2          1.000000  1.000000  1.000000  1.000000  -0.460893
3          1.000000  1.000000  1.000000  1.000000  -0.460894
portfolio -0.460867 -0.460909 -0.460893 -0.460894   1.000000
------------------
Timestep 119000, Reward: 547.3660858089344, TD Loss: 22.196504113945515
test
0:  annret:16.254,  sharpe:0.813
1:  annret:13.005,  sharpe:0.712
2:  annret:15.830,  sharpe:0.831
3:  annret:16.280,  sharpe:1.011
          0         1         2         3
0  1.000000  0.836096  0.906196  0.813001
1  0.836096  1.000000  0.881839  0.756544
2  0.906196  0.881839  1.000000  0.814707
3  0.813001  0.756544  0.814707  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:54.968,  sharpe:3.378
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.577071
1          1.000000  1.000000  1.000000  1.000000  -0.577076
2          1.000000  1.000000  1.000000  1.000000  -0.577067
3          1.000000  1.000000  1.000000  1.000000  -0.577068
portfolio -0.577071 -0.577076 -0.577067 -0.577068   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:17.856,  sharpe:1.771
                  0         1       2         3  portfolio
0          1.000000  1.000000  1.0000  1.000000  -0.669297
1          1.000000  1.000000  1.0000  1.000000  -0.669308
2          1.000000  1.000000  1.0000  1.000000  -0.669300
3          1.000000  1.000000  1.0000  1.000000  -0.669285
portfolio -0.669297 -0.669308 -0.6693 -0.669285   1.000000
------------------
0:  annret:18.457,  sharpe:0.907
1:  annret:18.947,  sharpe:0.887
2:  annret:27.401,  sharpe:1.198
3:  annret:35.070,  sharpe:1.555
          0         1         2         3
0  1.000000  0.448507  0.459668  0.522224
1  0.448507  1.000000  0.482138  0.480511
2  0.459668  0.482138  1.000000  0.521981
3  0.522224  0.480511  0.521981  1.000000
Timestep 120000, Reward: 539.6092682759588, TD Loss: 18.284304749949555
test
0:  annret:10.208,  sharpe:0.839
1:  annret:13.316,  sharpe:0.696
2:  annret:13.622,  sharpe:0.720
3:  annret:19.148,  sharpe:0.980
          0         1         2         3
0  1.000000  0.582146  0.675558  0.633714
1  0.582146  1.000000  0.831537  0.828507
2  0.675558  0.831537  1.000000  0.810299
3  0.633714  0.828507  0.810299  1.000000
train
0:  annret:-1.821,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:60.449,  sharpe:3.840
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.588619
1          1.000000  1.000000  1.000000  1.000000  -0.588627
2          1.000000  1.000000  1.000000  1.000000  -0.588629
3          1.000000  1.000000  1.000000  1.000000  -0.588621
portfolio -0.588619 -0.588627 -0.588629 -0.588621   1.000000
test
0:  annret:-17.402,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:22.141,  sharpe:2.246
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.638938
1          1.000000  1.000000  1.000000  1.000000  -0.638968
2          1.000000  1.000000  1.000000  1.000000  -0.638974
3          1.000000  1.000000  1.000000  1.000000  -0.638956
portfolio -0.638938 -0.638968 -0.638974 -0.638956   1.000000
------------------
Timestep 121000, Reward: 539.6092682759588, TD Loss: 41.025004841923845
test
0:  annret:19.854,  sharpe:0.935
1:  annret:16.613,  sharpe:0.837
2:  annret:14.233,  sharpe:0.706
3:  annret:13.657,  sharpe:0.694
          0         1         2         3
0  1.000000  0.926326  0.941123  0.934040
1  0.926326  1.000000  0.883617  0.858752
2  0.941123  0.883617  1.000000  0.916326
3  0.934040  0.858752  0.916326  1.000000
train
0:  annret:-1.841,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:40.059,  sharpe:2.039
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.828944
1          1.000000  1.000000  1.000000  1.000000  -0.828956
2          1.000000  1.000000  1.000000  1.000000  -0.828952
3          1.000000  1.000000  1.000000  1.000000  -0.828949
portfolio -0.828944 -0.828956 -0.828952 -0.828949   1.000000
test
0:  annret:-17.417,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:15.693,  sharpe:1.098
                  0        1        2        3  portfolio
0          1.000000  1.00000  1.00000  1.00000  -0.897713
1          1.000000  1.00000  1.00000  1.00000  -0.897720
2          1.000000  1.00000  1.00000  1.00000  -0.897720
3          1.000000  1.00000  1.00000  1.00000  -0.897710
portfolio -0.897713 -0.89772 -0.89772 -0.89771   1.000000
------------------
0:  annret:15.699,  sharpe:0.755
1:  annret:16.240,  sharpe:0.728
2:  annret:25.492,  sharpe:1.169
3:  annret:27.319,  sharpe:1.247
          0         1         2         3
0  1.000000  0.498072  0.413404  0.423114
1  0.498072  1.000000  0.483348  0.427962
2  0.413404  0.483348  1.000000  0.544528
3  0.423114  0.427962  0.544528  1.000000
Timestep 122000, Reward: 509.13876488460716, TD Loss: 20.85602840058047
test
0:  annret:15.072,  sharpe:1.273
1:  annret:13.839,  sharpe:0.771
2:  annret:14.240,  sharpe:0.748
3:  annret:16.377,  sharpe:0.946
          0         1         2         3
0  1.000000  0.100152  0.357020  0.545826
1  0.100152  1.000000  0.807835  0.648932
2  0.357020  0.807835  1.000000  0.768228
3  0.545826  0.648932  0.768228  1.000000
train
0:  annret:-1.824,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.829,  sharpe:-0.059
portfolio:  annret:63.075,  sharpe:4.075
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.453760
1          1.00000  1.000000  1.000000  1.000000  -0.453772
2          1.00000  1.000000  1.000000  1.000000  -0.453772
3          1.00000  1.000000  1.000000  1.000000  -0.453758
portfolio -0.45376 -0.453772 -0.453772 -0.453758   1.000000
test
0:  annret:-17.404,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.414,  sharpe:-0.674
portfolio:  annret:21.494,  sharpe:2.187
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.544712
1          1.000000  1.000000  1.000000  1.000000  -0.544741
2          1.000000  1.000000  1.000000  1.000000  -0.544746
3          1.000000  1.000000  1.000000  1.000000  -0.544711
portfolio -0.544712 -0.544741 -0.544746 -0.544711   1.000000
------------------
Timestep 123000, Reward: 509.13876488460716, TD Loss: 22.558645208228697
test
0:  annret:20.611,  sharpe:0.939
1:  annret:17.759,  sharpe:0.789
2:  annret:17.363,  sharpe:0.758
3:  annret:18.400,  sharpe:0.819
          0         1         2         3
0  1.000000  0.933258  0.952079  0.944996
1  0.933258  1.000000  0.967031  0.952045
2  0.952079  0.967031  1.000000  0.957265
3  0.944996  0.952045  0.957265  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.838,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:35.686,  sharpe:1.469
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.933793
1          1.000000  1.000000  1.000000  1.000000  -0.933792
2          1.000000  1.000000  1.000000  1.000000  -0.933791
3          1.000000  1.000000  1.000000  1.000000  -0.933789
portfolio -0.933793 -0.933792 -0.933791 -0.933789   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:22.510,  sharpe:1.142
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000  -0.971586
1          1.000000  1.000000  1.00000  1.000000  -0.971591
2          1.000000  1.000000  1.00000  1.000000  -0.971590
3          1.000000  1.000000  1.00000  1.000000  -0.971586
portfolio -0.971586 -0.971591 -0.97159 -0.971586   1.000000
------------------
0:  annret:20.920,  sharpe:1.030
1:  annret:18.533,  sharpe:0.867
2:  annret:32.650,  sharpe:1.443
3:  annret:27.192,  sharpe:1.268
          0         1         2         3
0  1.000000  0.372048  0.386788  0.429159
1  0.372048  1.000000  0.505458  0.343031
2  0.386788  0.505458  1.000000  0.477110
3  0.429159  0.343031  0.477110  1.000000
Timestep 124000, Reward: 544.6275906549037, TD Loss: 36.17614389232533
test
0:  annret:0.174,  sharpe:0.018
1:  annret:-1.508,  sharpe:-0.091
2:  annret:10.863,  sharpe:0.748
3:  annret:18.992,  sharpe:1.093
          0         1         2         3
0  1.000000  0.518259 -0.178803 -0.250485
1  0.518259  1.000000 -0.570828 -0.631457
2 -0.178803 -0.570828  1.000000  0.646863
3 -0.250485 -0.631457  0.646863  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.832,  sharpe:-0.059
2:  annret:-1.833,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:65.545,  sharpe:4.602
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.025177
1          1.000000  1.000000  1.000000  1.000000   0.025175
2          1.000000  1.000000  1.000000  1.000000   0.025173
3          1.000000  1.000000  1.000000  1.000000   0.025182
portfolio  0.025177  0.025175  0.025173  0.025182   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.411,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:17.537,  sharpe:2.073
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.065106
1          1.000000  1.000000  1.000000  1.000000  -0.065119
2          1.000000  1.000000  1.000000  1.000000  -0.065134
3          1.000000  1.000000  1.000000  1.000000  -0.065113
portfolio -0.065106 -0.065119 -0.065134 -0.065113   1.000000
------------------
Timestep 125000, Reward: 544.6275906549037, TD Loss: 12.233145571803533
test
0:  annret:19.729,  sharpe:0.962
1:  annret:16.549,  sharpe:0.811
2:  annret:14.619,  sharpe:0.701
3:  annret:20.784,  sharpe:0.944
          0         1         2         3
0  1.000000  0.854078  0.928111  0.906194
1  0.854078  1.000000  0.908956  0.895297
2  0.928111  0.908956  1.000000  0.916764
3  0.906194  0.895297  0.916764  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:44.746,  sharpe:2.218
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.862905
1          1.000000  1.000000  1.000000  1.000000  -0.862912
2          1.000000  1.000000  1.000000  1.000000  -0.862911
3          1.000000  1.000000  1.000000  1.000000  -0.862908
portfolio -0.862905 -0.862912 -0.862911 -0.862908   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:20.910,  sharpe:1.345
                  0         1       2         3  portfolio
0          1.000000  1.000000  1.0000  1.000000  -0.913686
1          1.000000  1.000000  1.0000  1.000000  -0.913694
2          1.000000  1.000000  1.0000  1.000000  -0.913700
3          1.000000  1.000000  1.0000  1.000000  -0.913689
portfolio -0.913686 -0.913694 -0.9137 -0.913689   1.000000
------------------
Timestep 126000, Reward: 544.6275906549037, TD Loss: 18.229970116970577
test
0:  annret:-9.591,  sharpe:-0.661
1:  annret:5.596,  sharpe:0.371
2:  annret:15.882,  sharpe:0.880
3:  annret:24.383,  sharpe:1.294
          0         1         2         3
0  1.000000  0.710360 -0.749873 -0.784553
1  0.710360  1.000000 -0.727274 -0.698252
2 -0.749873 -0.727274  1.000000  0.814744
3 -0.784553 -0.698252  0.814744  1.000000
train
0:  annret:-1.824,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:68.972,  sharpe:4.671
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000   0.008992
1          1.000000  1.000000  1.000000  1.00000   0.008997
2          1.000000  1.000000  1.000000  1.00000   0.008981
3          1.000000  1.000000  1.000000  1.00000   0.008980
portfolio  0.008992  0.008997  0.008981  0.00898   1.000000
test
0:  annret:-17.405,  sharpe:-0.673
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:15.857,  sharpe:1.931
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000   0.035608
1          1.000000  1.00000  1.000000  1.000000   0.035620
2          1.000000  1.00000  1.000000  1.000000   0.035574
3          1.000000  1.00000  1.000000  1.000000   0.035578
portfolio  0.035608  0.03562  0.035574  0.035578   1.000000
------------------
0:  annret:25.535,  sharpe:1.229
1:  annret:24.683,  sharpe:1.219
2:  annret:30.634,  sharpe:1.354
3:  annret:30.887,  sharpe:1.356
          0         1         2         3
0  1.000000  0.399550  0.251389  0.281311
1  0.399550  1.000000  0.415425  0.388984
2  0.251389  0.415425  1.000000  0.534022
3  0.281311  0.388984  0.534022  1.000000
Timestep 127000, Reward: 564.4778181888673, TD Loss: 42.27264587666967
test
0:  annret:20.714,  sharpe:0.981
1:  annret:16.874,  sharpe:0.788
2:  annret:17.527,  sharpe:0.826
3:  annret:21.121,  sharpe:0.994
          0         1         2         3
0  1.000000  0.893523  0.916555  0.904180
1  0.893523  1.000000  0.957737  0.950366
2  0.916555  0.957737  1.000000  0.933404
3  0.904180  0.950366  0.933404  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:44.079,  sharpe:2.039
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.888064
1          1.000000  1.000000  1.000000  1.000000  -0.888062
2          1.000000  1.000000  1.000000  1.000000  -0.888065
3          1.000000  1.000000  1.000000  1.000000  -0.888066
portfolio -0.888064 -0.888062 -0.888065 -0.888066   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:22.213,  sharpe:1.287
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.932426
1          1.000000  1.000000  1.000000  1.000000  -0.932427
2          1.000000  1.000000  1.000000  1.000000  -0.932434
3          1.000000  1.000000  1.000000  1.000000  -0.932432
portfolio -0.932426 -0.932427 -0.932434 -0.932432   1.000000
------------------
Timestep 128000, Reward: 564.4778181888673, TD Loss: 22.637565615768114
test
0:  annret:16.694,  sharpe:0.969
1:  annret:7.881,  sharpe:0.535
2:  annret:17.237,  sharpe:0.854
3:  annret:18.217,  sharpe:1.084
          0         1         2         3
0  1.000000  0.681852  0.863346  0.797309
1  0.681852  1.000000  0.824100  0.757447
2  0.863346  0.824100  1.000000  0.803082
3  0.797309  0.757447  0.803082  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:57.238,  sharpe:3.619
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.524731
1          1.000000  1.000000  1.000000  1.000000  -0.524734
2          1.000000  1.000000  1.000000  1.000000  -0.524741
3          1.000000  1.000000  1.000000  1.000000  -0.524729
portfolio -0.524731 -0.524734 -0.524741 -0.524729   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:16.394,  sharpe:1.681
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.582547
1          1.000000  1.000000  1.000000  1.000000  -0.582557
2          1.000000  1.000000  1.000000  1.000000  -0.582571
3          1.000000  1.000000  1.000000  1.000000  -0.582537
portfolio -0.582547 -0.582557 -0.582571 -0.582537   1.000000
------------------
0:  annret:14.274,  sharpe:0.673
1:  annret:10.722,  sharpe:0.537
2:  annret:29.224,  sharpe:1.276
3:  annret:34.043,  sharpe:1.536
          0         1         2         3
0  1.000000  0.550501  0.518834  0.609467
1  0.550501  1.000000  0.385666  0.486307
2  0.518834  0.385666  1.000000  0.505323
3  0.609467  0.486307  0.505323  1.000000
Timestep 129000, Reward: 540.8505719982047, TD Loss: 17.392663449491323
test
0:  annret:16.577,  sharpe:0.814
1:  annret:11.258,  sharpe:0.852
2:  annret:15.097,  sharpe:0.737
3:  annret:20.320,  sharpe:0.943
          0         1         2         3
0  1.000000  0.704162  0.904111  0.902356
1  0.704162  1.000000  0.812540  0.827328
2  0.904111  0.812540  1.000000  0.928153
3  0.902356  0.827328  0.928153  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.833,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:51.661,  sharpe:2.981
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.729624
1          1.000000  1.000000  1.000000  1.000000  -0.729617
2          1.000000  1.000000  1.000000  1.000000  -0.729631
3          1.000000  1.000000  1.000000  1.000000  -0.729623
portfolio -0.729624 -0.729617 -0.729631 -0.729623   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:17.122,  sharpe:1.365
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.826575
1          1.000000  1.000000  1.000000  1.000000  -0.826562
2          1.000000  1.000000  1.000000  1.000000  -0.826585
3          1.000000  1.000000  1.000000  1.000000  -0.826584
portfolio -0.826575 -0.826562 -0.826585 -0.826584   1.000000
------------------
Timestep 130000, Reward: 540.8505719982047, TD Loss: 5.854058997963689
test
0:  annret:18.690,  sharpe:0.915
1:  annret:12.126,  sharpe:0.622
2:  annret:13.544,  sharpe:0.715
3:  annret:16.971,  sharpe:0.929
          0         1         2         3
0  1.000000  0.826269  0.858722  0.844613
1  0.826269  1.000000  0.890548  0.851975
2  0.858722  0.890548  1.000000  0.842498
3  0.844613  0.851975  0.842498  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:54.411,  sharpe:3.264
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.655713
1          1.000000  1.000000  1.000000  1.000000  -0.655717
2          1.000000  1.000000  1.000000  1.000000  -0.655715
3          1.000000  1.000000  1.000000  1.000000  -0.655714
portfolio -0.655713 -0.655717 -0.655715 -0.655714   1.000000
test
0:  annret:-17.408,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:17.411,  sharpe:1.587
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.694167
1          1.000000  1.000000  1.000000  1.000000  -0.694181
2          1.000000  1.000000  1.000000  1.000000  -0.694176
3          1.000000  1.000000  1.000000  1.000000  -0.694169
portfolio -0.694167 -0.694181 -0.694176 -0.694169   1.000000
------------------
0:  annret:15.167,  sharpe:0.748
1:  annret:17.449,  sharpe:0.809
2:  annret:30.416,  sharpe:1.335
3:  annret:32.707,  sharpe:1.410
          0         1         2         3
0  1.000000  0.538264  0.549726  0.590055
1  0.538264  1.000000  0.476713  0.652798
2  0.549726  0.476713  1.000000  0.564998
3  0.590055  0.652798  0.564998  1.000000
Timestep 131000, Reward: 539.6241705864327, TD Loss: 11.827937198983957
test
0:  annret:15.959,  sharpe:1.096
1:  annret:-7.161,  sharpe:-0.375
2:  annret:16.546,  sharpe:0.824
3:  annret:21.880,  sharpe:1.094
          0         1         2         3
0  1.000000 -0.645135  0.740790  0.715096
1 -0.645135  1.000000 -0.848522 -0.858389
2  0.740790 -0.848522  1.000000  0.855122
3  0.715096 -0.858389  0.855122  1.000000
train
0:  annret:-1.825,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:63.508,  sharpe:4.390
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.364008
1          1.000000  1.000000  1.000000  1.00000  -0.364004
2          1.000000  1.000000  1.000000  1.00000  -0.364019
3          1.000000  1.000000  1.000000  1.00000  -0.364010
portfolio -0.364008 -0.364004 -0.364019 -0.36401   1.000000
test
0:  annret:-17.404,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:20.025,  sharpe:2.283
                0         1         2         3  portfolio
0          1.0000  1.000000  1.000000  1.000000  -0.393700
1          1.0000  1.000000  1.000000  1.000000  -0.393701
2          1.0000  1.000000  1.000000  1.000000  -0.393729
3          1.0000  1.000000  1.000000  1.000000  -0.393727
portfolio -0.3937 -0.393701 -0.393729 -0.393727   1.000000
------------------
Timestep 132000, Reward: 539.6241705864327, TD Loss: 27.290056441183303
test
0:  annret:16.859,  sharpe:0.909
1:  annret:14.155,  sharpe:0.772
2:  annret:19.371,  sharpe:1.014
3:  annret:11.473,  sharpe:0.882
          0         1         2         3
0  1.000000  0.809981  0.896521  0.763574
1  0.809981  1.000000  0.833382  0.692400
2  0.896521  0.833382  1.000000  0.701855
3  0.763574  0.692400  0.701855  1.000000
train
0:  annret:-1.833,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:50.725,  sharpe:3.231
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.602707
1          1.000000  1.000000  1.000000  1.000000  -0.602712
2          1.000000  1.000000  1.000000  1.000000  -0.602708
3          1.000000  1.000000  1.000000  1.000000  -0.602698
portfolio -0.602707 -0.602712 -0.602708 -0.602698   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.414,  sharpe:-0.674
portfolio:  annret:17.556,  sharpe:1.836
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.676822
1          1.000000  1.00000  1.000000  1.000000  -0.676830
2          1.000000  1.00000  1.000000  1.000000  -0.676833
3          1.000000  1.00000  1.000000  1.000000  -0.676783
portfolio -0.676822 -0.67683 -0.676833 -0.676783   1.000000
------------------
0:  annret:19.168,  sharpe:0.924
1:  annret:21.049,  sharpe:0.915
2:  annret:38.085,  sharpe:1.699
3:  annret:19.541,  sharpe:0.878
          0         1         2         3
0  1.000000  0.451261  0.596359  0.592072
1  0.451261  1.000000  0.409308  0.438445
2  0.596359  0.409308  1.000000  0.524498
3  0.592072  0.438445  0.524498  1.000000
Timestep 133000, Reward: 549.1995804287134, TD Loss: 15.911440505532426
test
0:  annret:18.836,  sharpe:0.935
1:  annret:20.048,  sharpe:0.907
2:  annret:15.768,  sharpe:0.782
3:  annret:19.305,  sharpe:0.939
          0         1         2         3
0  1.000000  0.848772  0.889622  0.863040
1  0.848772  1.000000  0.909230  0.911163
2  0.889622  0.909230  1.000000  0.887330
3  0.863040  0.911163  0.887330  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:46.678,  sharpe:2.353
                  0         1        2        3  portfolio
0          1.000000  1.000000  1.00000  1.00000  -0.844335
1          1.000000  1.000000  1.00000  1.00000  -0.844342
2          1.000000  1.000000  1.00000  1.00000  -0.844340
3          1.000000  1.000000  1.00000  1.00000  -0.844340
portfolio -0.844335 -0.844342 -0.84434 -0.84434   1.000000
test
0:  annret:-17.409,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:22.812,  sharpe:1.575
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.901051
1          1.000000  1.00000  1.000000  1.000000  -0.901060
2          1.000000  1.00000  1.000000  1.000000  -0.901063
3          1.000000  1.00000  1.000000  1.000000  -0.901056
portfolio -0.901051 -0.90106 -0.901063 -0.901056   1.000000
------------------
Timestep 134000, Reward: 549.1995804287134, TD Loss: 86.72668513326336
test
0:  annret:-3.302,  sharpe:-0.217
1:  annret:-12.666,  sharpe:-0.607
2:  annret:12.832,  sharpe:0.654
3:  annret:-11.598,  sharpe:-0.555
          0         1         2         3
0  1.000000  0.672057 -0.653822  0.697464
1  0.672057  1.000000 -0.863531  0.919305
2 -0.653822 -0.863531  1.000000 -0.887450
3  0.697464  0.919305 -0.887450  1.000000
train
0:  annret:-1.838,  sharpe:-0.060
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.832,  sharpe:-0.059
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:55.675,  sharpe:3.278
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000   0.502346
1          1.000000  1.000000  1.000000  1.00000   0.502339
2          1.000000  1.000000  1.000000  1.00000   0.502341
3          1.000000  1.000000  1.000000  1.00000   0.502340
portfolio  0.502346  0.502339  0.502341  0.50234   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:6.615,  sharpe:0.549
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.713196
1          1.000000  1.000000  1.000000  1.000000   0.713187
2          1.000000  1.000000  1.000000  1.000000   0.713187
3          1.000000  1.000000  1.000000  1.000000   0.713199
portfolio  0.713196  0.713187  0.713187  0.713199   1.000000
------------------
0:  annret:15.782,  sharpe:0.717
1:  annret:11.975,  sharpe:0.549
2:  annret:28.908,  sharpe:1.234
3:  annret:20.799,  sharpe:0.927
          0         1         2         3
0  1.000000  0.534399  0.579430  0.586374
1  0.534399  1.000000  0.411007  0.554075
2  0.579430  0.411007  1.000000  0.520403
3  0.586374  0.554075  0.520403  1.000000
Timestep 135000, Reward: 527.0335461486326, TD Loss: 42.97835631251473
test
0:  annret:19.441,  sharpe:0.914
1:  annret:9.373,  sharpe:0.649
2:  annret:15.506,  sharpe:0.777
3:  annret:20.551,  sharpe:1.091
          0         1         2         3
0  1.000000  0.654427  0.878441  0.852900
1  0.654427  1.000000  0.731195  0.698343
2  0.878441  0.731195  1.000000  0.821255
3  0.852900  0.698343  0.821255  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.832,  sharpe:-0.059
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:55.993,  sharpe:3.296
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.657559
1          1.000000  1.000000  1.000000  1.000000  -0.657548
2          1.000000  1.000000  1.000000  1.000000  -0.657556
3          1.000000  1.000000  1.000000  1.000000  -0.657553
portfolio -0.657559 -0.657548 -0.657556 -0.657553   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.411,  sharpe:-0.674
2:  annret:-17.415,  sharpe:-0.674
3:  annret:-17.414,  sharpe:-0.674
portfolio:  annret:21.371,  sharpe:1.899
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.716978
1          1.000000  1.000000  1.000000  1.000000  -0.716966
2          1.000000  1.000000  1.000000  1.000000  -0.716986
3          1.000000  1.000000  1.000000  1.000000  -0.716973
portfolio -0.716978 -0.716966 -0.716986 -0.716973   1.000000
------------------
Timestep 136000, Reward: 527.0335461486326, TD Loss: 36.1283617224648
test
0:  annret:19.768,  sharpe:0.860
1:  annret:17.218,  sharpe:0.763
2:  annret:16.927,  sharpe:0.772
3:  annret:20.070,  sharpe:0.941
          0         1         2         3
0  1.000000  0.947234  0.953220  0.931998
1  0.947234  1.000000  0.950935  0.928300
2  0.953220  0.950935  1.000000  0.917979
3  0.931998  0.928300  0.917979  1.000000
train
0:  annret:-1.838,  sharpe:-0.060
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:35.446,  sharpe:1.468
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.940528
1          1.000000  1.000000  1.000000  1.000000  -0.940527
2          1.000000  1.000000  1.000000  1.000000  -0.940526
3          1.000000  1.000000  1.000000  1.000000  -0.940525
portfolio -0.940528 -0.940527 -0.940526 -0.940525   1.000000
test
0:  annret:-17.417,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.415,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:21.293,  sharpe:1.087
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.975347
1          1.000000  1.000000  1.000000  1.000000  -0.975348
2          1.000000  1.000000  1.000000  1.000000  -0.975347
3          1.000000  1.000000  1.000000  1.000000  -0.975346
portfolio -0.975347 -0.975348 -0.975347 -0.975346   1.000000
------------------
0:  annret:19.730,  sharpe:0.826
1:  annret:17.456,  sharpe:0.823
2:  annret:30.353,  sharpe:1.338
3:  annret:29.195,  sharpe:1.349
          0         1         2         3
0  1.000000  0.609757  0.603474  0.457907
1  0.609757  1.000000  0.529296  0.530565
2  0.603474  0.529296  1.000000  0.537696
3  0.457907  0.530565  0.537696  1.000000
Timestep 137000, Reward: 583.9445123104427, TD Loss: 11.078836760527743
test
0:  annret:5.332,  sharpe:0.526
1:  annret:-4.754,  sharpe:-0.248
2:  annret:9.992,  sharpe:0.527
3:  annret:21.371,  sharpe:1.146
          0         1         2         3
0  1.000000  0.096560 -0.092915 -0.060644
1  0.096560  1.000000 -0.787440 -0.810046
2 -0.092915 -0.787440  1.000000  0.745851
3 -0.060644 -0.810046  0.745851  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:64.012,  sharpe:4.495
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.196588
1          1.000000  1.000000  1.000000  1.000000  -0.196586
2          1.000000  1.000000  1.000000  1.000000  -0.196596
3          1.000000  1.000000  1.000000  1.000000  -0.196594
portfolio -0.196588 -0.196586 -0.196596 -0.196594   1.000000
test
0:  annret:-17.408,  sharpe:-0.674
1:  annret:-17.409,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:17.672,  sharpe:2.246
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.231779
1          1.000000  1.00000  1.000000  1.000000  -0.231780
2          1.000000  1.00000  1.000000  1.000000  -0.231815
3          1.000000  1.00000  1.000000  1.000000  -0.231796
portfolio -0.231779 -0.23178 -0.231815 -0.231796   1.000000
------------------
Timestep 138000, Reward: 583.9445123104427, TD Loss: 21.337858646636736
test
0:  annret:19.179,  sharpe:0.976
1:  annret:17.655,  sharpe:0.792
2:  annret:14.255,  sharpe:0.668
3:  annret:21.818,  sharpe:1.057
          0         1         2         3
0  1.000000  0.807813  0.864709  0.828092
1  0.807813  1.000000  0.902641  0.896265
2  0.864709  0.902641  1.000000  0.852800
3  0.828092  0.896265  0.852800  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:47.285,  sharpe:2.240
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.846841
1          1.000000  1.000000  1.000000  1.000000  -0.846848
2          1.000000  1.000000  1.000000  1.000000  -0.846842
3          1.000000  1.000000  1.000000  1.000000  -0.846844
portfolio -0.846841 -0.846848 -0.846842 -0.846844   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:22.092,  sharpe:1.375
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.939264
1          1.000000  1.000000  1.000000  1.000000  -0.939276
2          1.000000  1.000000  1.000000  1.000000  -0.939273
3          1.000000  1.000000  1.000000  1.000000  -0.939269
portfolio -0.939264 -0.939276 -0.939273 -0.939269   1.000000
------------------
Timestep 139000, Reward: 583.9445123104427, TD Loss: 14.50607815115261
test
0:  annret:18.960,  sharpe:0.964
1:  annret:11.380,  sharpe:0.731
2:  annret:18.259,  sharpe:0.912
3:  annret:23.254,  sharpe:1.267
          0         1         2         3
0  1.000000  0.709134  0.861802  0.808454
1  0.709134  1.000000  0.830630  0.742450
2  0.861802  0.830630  1.000000  0.810923
3  0.808454  0.742450  0.810923  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.833,  sharpe:-0.059
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.060
portfolio:  annret:56.586,  sharpe:3.288
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.649804
1          1.000000  1.000000  1.000000  1.000000  -0.649798
2          1.000000  1.000000  1.000000  1.000000  -0.649801
3          1.000000  1.000000  1.000000  1.000000  -0.649802
portfolio -0.649804 -0.649798 -0.649801 -0.649802   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.409,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:21.711,  sharpe:1.849
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.762459
1          1.000000  1.000000  1.000000  1.000000  -0.762467
2          1.000000  1.000000  1.000000  1.000000  -0.762467
3          1.000000  1.000000  1.000000  1.000000  -0.762455
portfolio -0.762459 -0.762467 -0.762467 -0.762455   1.000000
------------------
0:  annret:21.265,  sharpe:0.933
1:  annret:19.295,  sharpe:0.863
2:  annret:30.356,  sharpe:1.318
3:  annret:32.663,  sharpe:1.454
          0         1         2         3
0  1.000000  0.643667  0.622308  0.474798
1  0.643667  1.000000  0.448087  0.490804
2  0.622308  0.448087  1.000000  0.559945
3  0.474798  0.490804  0.559945  1.000000
Timestep 140000, Reward: 603.3138711281371, TD Loss: 22.014027430390886
test
0:  annret:17.387,  sharpe:0.880
1:  annret:19.968,  sharpe:0.897
2:  annret:17.962,  sharpe:0.830
3:  annret:17.034,  sharpe:0.826
          0         1         2         3
0  1.000000  0.841997  0.884868  0.841839
1  0.841997  1.000000  0.939988  0.907102
2  0.884868  0.939988  1.000000  0.894576
3  0.841839  0.907102  0.894576  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:47.772,  sharpe:2.322
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.847291
1          1.000000  1.000000  1.000000  1.000000  -0.847292
2          1.000000  1.000000  1.000000  1.000000  -0.847293
3          1.000000  1.000000  1.000000  1.000000  -0.847292
portfolio -0.847291 -0.847292 -0.847293 -0.847292   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:21.857,  sharpe:1.360
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.930269
1          1.000000  1.000000  1.000000  1.000000  -0.930273
2          1.000000  1.000000  1.000000  1.000000  -0.930276
3          1.000000  1.000000  1.000000  1.000000  -0.930275
portfolio -0.930269 -0.930273 -0.930276 -0.930275   1.000000
------------------
Timestep 141000, Reward: 603.3138711281371, TD Loss: 10.391456508236665
test
0:  annret:18.287,  sharpe:0.895
1:  annret:15.888,  sharpe:0.838
2:  annret:14.477,  sharpe:0.717
3:  annret:22.482,  sharpe:1.283
          0         1         2         3
0  1.000000  0.748304  0.871055  0.784545
1  0.748304  1.000000  0.854426  0.771572
2  0.871055  0.854426  1.000000  0.792962
3  0.784545  0.771572  0.792962  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:49.051,  sharpe:2.770
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.728564
1          1.000000  1.000000  1.000000  1.00000  -0.728563
2          1.000000  1.000000  1.000000  1.00000  -0.728565
3          1.000000  1.000000  1.000000  1.00000  -0.728570
portfolio -0.728564 -0.728563 -0.728565 -0.72857   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.411,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:18.001,  sharpe:1.483
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.832762
1          1.000000  1.000000  1.000000  1.000000  -0.832757
2          1.000000  1.000000  1.000000  1.000000  -0.832764
3          1.000000  1.000000  1.000000  1.000000  -0.832765
portfolio -0.832762 -0.832757 -0.832764 -0.832765   1.000000
------------------
0:  annret:16.351,  sharpe:0.661
1:  annret:19.986,  sharpe:0.868
2:  annret:32.707,  sharpe:1.404
3:  annret:35.063,  sharpe:1.588
          0         1         2         3
0  1.000000  0.520879  0.671048  0.570920
1  0.520879  1.000000  0.527436  0.584682
2  0.671048  0.527436  1.000000  0.541766
3  0.570920  0.584682  0.541766  1.000000
Timestep 142000, Reward: 635.8082833770043, TD Loss: 12.95978317638812
test
0:  annret:22.203,  sharpe:1.012
1:  annret:4.202,  sharpe:0.306
2:  annret:14.005,  sharpe:0.733
3:  annret:18.369,  sharpe:0.874
          0         1         2         3
0  1.000000  0.681427  0.869304  0.876952
1  0.681427  1.000000  0.693982  0.728492
2  0.869304  0.693982  1.000000  0.822721
3  0.876952  0.728492  0.822721  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.833,  sharpe:-0.059
2:  annret:-1.833,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:52.244,  sharpe:2.987
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.709952
1          1.000000  1.000000  1.000000  1.000000  -0.709936
2          1.000000  1.000000  1.000000  1.000000  -0.709947
3          1.000000  1.000000  1.000000  1.000000  -0.709953
portfolio -0.709952 -0.709936 -0.709947 -0.709953   1.000000
test
0:  annret:-17.414,  sharpe:-0.674
1:  annret:-17.411,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:15.712,  sharpe:1.269
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.782839
1          1.000000  1.000000  1.000000  1.000000  -0.782806
2          1.000000  1.000000  1.000000  1.000000  -0.782827
3          1.000000  1.000000  1.000000  1.000000  -0.782838
portfolio -0.782839 -0.782806 -0.782827 -0.782838   1.000000
------------------
Timestep 143000, Reward: 635.8082833770043, TD Loss: 15.007302194841415
test
0:  annret:19.609,  sharpe:0.972
1:  annret:14.706,  sharpe:0.875
2:  annret:14.605,  sharpe:0.787
3:  annret:18.167,  sharpe:1.080
          0         1         2         3
0  1.000000  0.806970  0.876600  0.831964
1  0.806970  1.000000  0.835067  0.805474
2  0.876600  0.835067  1.000000  0.774169
3  0.831964  0.805474  0.774169  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.060
3:  annret:-1.829,  sharpe:-0.059
portfolio:  annret:57.992,  sharpe:3.412
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.577898
1          1.000000  1.000000  1.000000  1.000000  -0.577891
2          1.000000  1.000000  1.000000  1.000000  -0.577899
3          1.000000  1.000000  1.000000  1.000000  -0.577893
portfolio -0.577898 -0.577891 -0.577899 -0.577893   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:17.649,  sharpe:1.584
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.666085
1          1.000000  1.000000  1.000000  1.00000  -0.666074
2          1.000000  1.000000  1.000000  1.00000  -0.666087
3          1.000000  1.000000  1.000000  1.00000  -0.666060
portfolio -0.666085 -0.666074 -0.666087 -0.66606   1.000000
------------------
0:  annret:22.970,  sharpe:0.976
1:  annret:15.675,  sharpe:0.707
2:  annret:36.796,  sharpe:1.543
3:  annret:28.769,  sharpe:1.287
          0         1         2         3
0  1.000000  0.597145  0.595554  0.615604
1  0.597145  1.000000  0.546622  0.602255
2  0.595554  0.546622  1.000000  0.581617
3  0.615604  0.602255  0.581617  1.000000
Timestep 144000, Reward: 593.4440275932049, TD Loss: 17.081027303039168
test
0:  annret:18.506,  sharpe:1.153
1:  annret:-8.484,  sharpe:-0.459
2:  annret:16.984,  sharpe:0.840
3:  annret:18.645,  sharpe:0.929
          0         1         2         3
0  1.000000 -0.596999  0.835581  0.820088
1 -0.596999  1.000000 -0.750609 -0.733779
2  0.835581 -0.750609  1.000000  0.829371
3  0.820088 -0.733779  0.829371  1.000000
train
0:  annret:-1.826,  sharpe:-0.059
1:  annret:-1.833,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:60.734,  sharpe:3.608
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.524431
1          1.000000  1.00000  1.000000  1.000000  -0.524430
2          1.000000  1.00000  1.000000  1.000000  -0.524442
3          1.000000  1.00000  1.000000  1.000000  -0.524436
portfolio -0.524431 -0.52443 -0.524442 -0.524436   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.410,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:24.557,  sharpe:2.079
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.579126
1          1.000000  1.000000  1.000000  1.000000  -0.579137
2          1.000000  1.000000  1.000000  1.000000  -0.579157
3          1.000000  1.000000  1.000000  1.000000  -0.579147
portfolio -0.579126 -0.579137 -0.579157 -0.579147   1.000000
------------------
Timestep 145000, Reward: 593.4440275932049, TD Loss: 39.35279517872818
test
0:  annret:8.956,  sharpe:0.841
1:  annret:2.681,  sharpe:0.223
2:  annret:16.336,  sharpe:0.863
3:  annret:16.059,  sharpe:0.866
          0         1         2         3
0  1.000000 -0.010345  0.568458  0.550075
1 -0.010345  1.000000 -0.499120 -0.462236
2  0.568458 -0.499120  1.000000  0.881689
3  0.550075 -0.462236  0.881689  1.000000
train
0:  annret:-1.833,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.831,  sharpe:-0.059
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:57.217,  sharpe:4.024
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.176477
1          1.000000  1.00000  1.000000  1.000000  -0.176470
2          1.000000  1.00000  1.000000  1.000000  -0.176479
3          1.000000  1.00000  1.000000  1.000000  -0.176488
portfolio -0.176477 -0.17647 -0.176479 -0.176488   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.415,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:18.047,  sharpe:2.229
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.194735
1          1.000000  1.000000  1.000000  1.000000  -0.194727
2          1.000000  1.000000  1.000000  1.000000  -0.194744
3          1.000000  1.000000  1.000000  1.000000  -0.194733
portfolio -0.194735 -0.194727 -0.194744 -0.194733   1.000000
------------------
0:  annret:23.999,  sharpe:1.069
1:  annret:15.706,  sharpe:0.689
2:  annret:30.257,  sharpe:1.327
3:  annret:20.889,  sharpe:0.877
          0         1         2         3
0  1.000000  0.544601  0.578524  0.593522
1  0.544601  1.000000  0.447954  0.487527
2  0.578524  0.447954  1.000000  0.519115
3  0.593522  0.487527  0.519115  1.000000
Timestep 146000, Reward: 571.331729527451, TD Loss: 16.66122580705295
test
0:  annret:23.750,  sharpe:1.241
1:  annret:8.687,  sharpe:0.721
2:  annret:17.627,  sharpe:0.838
3:  annret:18.606,  sharpe:0.932
          0         1         2         3
0  1.000000  0.663391  0.883234  0.841211
1  0.663391  1.000000  0.668174  0.685269
2  0.883234  0.668174  1.000000  0.826770
3  0.841211  0.685269  0.826770  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:53.827,  sharpe:3.192
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.686290
1          1.00000  1.000000  1.000000  1.000000  -0.686289
2          1.00000  1.000000  1.000000  1.000000  -0.686296
3          1.00000  1.000000  1.000000  1.000000  -0.686295
portfolio -0.68629 -0.686289 -0.686296 -0.686295   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.415,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:20.869,  sharpe:1.797
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.767166
1          1.000000  1.000000  1.000000  1.000000  -0.767164
2          1.000000  1.000000  1.000000  1.000000  -0.767176
3          1.000000  1.000000  1.000000  1.000000  -0.767167
portfolio -0.767166 -0.767164 -0.767176 -0.767167   1.000000
------------------
Timestep 147000, Reward: 571.331729527451, TD Loss: 151.13555600769064
test
0:  annret:21.510,  sharpe:1.184
1:  annret:18.531,  sharpe:0.809
2:  annret:14.274,  sharpe:0.674
3:  annret:19.040,  sharpe:0.831
          0         1         2         3
0  1.000000  0.839333  0.867511  0.870351
1  0.839333  1.000000  0.945481  0.965499
2  0.867511  0.945481  1.000000  0.937569
3  0.870351  0.965499  0.937569  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:44.103,  sharpe:1.961
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.867687
1          1.000000  1.000000  1.000000  1.000000  -0.867692
2          1.000000  1.000000  1.000000  1.000000  -0.867688
3          1.000000  1.000000  1.000000  1.000000  -0.867691
portfolio -0.867687 -0.867692 -0.867688 -0.867691   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:20.721,  sharpe:1.110
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.957917
1          1.000000  1.000000  1.000000  1.000000  -0.957927
2          1.000000  1.000000  1.000000  1.000000  -0.957923
3          1.000000  1.000000  1.000000  1.000000  -0.957926
portfolio -0.957917 -0.957927 -0.957923 -0.957926   1.000000
------------------
0:  annret:24.908,  sharpe:1.149
1:  annret:24.533,  sharpe:1.103
2:  annret:33.340,  sharpe:1.461
3:  annret:22.732,  sharpe:1.025
          0         1         2         3
0  1.000000  0.475726  0.535193  0.635506
1  0.475726  1.000000  0.549563  0.549553
2  0.535193  0.549563  1.000000  0.524014
3  0.635506  0.549553  0.524014  1.000000
Timestep 148000, Reward: 579.7495593165819, TD Loss: 14.627070998289643
test
0:  annret:15.147,  sharpe:0.981
1:  annret:20.007,  sharpe:0.937
2:  annret:19.231,  sharpe:1.100
3:  annret:14.522,  sharpe:1.091
          0         1         2         3
0  1.000000  0.618189  0.702655  0.663658
1  0.618189  1.000000  0.793522  0.724651
2  0.702655  0.793522  1.000000  0.644820
3  0.663658  0.724651  0.644820  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.830,  sharpe:-0.059
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:62.410,  sharpe:3.683
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000  -0.584036
1          1.000000  1.000000  1.00000  1.000000  -0.584046
2          1.000000  1.000000  1.00000  1.000000  -0.584040
3          1.000000  1.000000  1.00000  1.000000  -0.584033
portfolio -0.584036 -0.584046 -0.58404 -0.584033   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.413,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:24.718,  sharpe:2.198
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.733647
1          1.000000  1.00000  1.000000  1.000000  -0.733680
2          1.000000  1.00000  1.000000  1.000000  -0.733657
3          1.000000  1.00000  1.000000  1.000000  -0.733656
portfolio -0.733647 -0.73368 -0.733657 -0.733656   1.000000
------------------
Timestep 149000, Reward: 579.7495593165819, TD Loss: 14.583448884539333
test
0:  annret:23.722,  sharpe:1.069
1:  annret:21.255,  sharpe:0.957
2:  annret:20.978,  sharpe:0.959
3:  annret:25.033,  sharpe:1.136
          0         1         2         3
0  1.000000  0.896801  0.923373  0.916869
1  0.896801  1.000000  0.928446  0.926843
2  0.923373  0.928446  1.000000  0.917979
3  0.916869  0.926843  0.917979  1.000000
train
0:  annret:-1.835,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:35.597,  sharpe:1.472
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.947729
1          1.000000  1.00000  1.000000  1.000000  -0.947730
2          1.000000  1.00000  1.000000  1.000000  -0.947728
3          1.000000  1.00000  1.000000  1.000000  -0.947729
portfolio -0.947729 -0.94773 -0.947728 -0.947729   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.414,  sharpe:-0.674
3:  annret:-17.421,  sharpe:-0.674
portfolio:  annret:26.899,  sharpe:1.381
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.972655
1          1.000000  1.000000  1.000000  1.000000  -0.972658
2          1.000000  1.000000  1.000000  1.000000  -0.972658
3          1.000000  1.000000  1.000000  1.000000  -0.972657
portfolio -0.972655 -0.972658 -0.972658 -0.972657   1.000000
------------------
Timestep 150000, Reward: 579.7495593165819, TD Loss: 19.79515394310905
test
0:  annret:4.337,  sharpe:0.398
1:  annret:5.564,  sharpe:0.581
2:  annret:14.742,  sharpe:0.738
3:  annret:19.220,  sharpe:1.200
          0         1         2         3
0  1.000000 -0.277568 -0.438912 -0.386487
1 -0.277568  1.000000  0.393300  0.413362
2 -0.438912  0.393300  1.000000  0.754985
3 -0.386487  0.413362  0.754985  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:67.317,  sharpe:4.545
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.271383
1          1.000000  1.000000  1.000000  1.000000  -0.271386
2          1.000000  1.000000  1.000000  1.000000  -0.271392
3          1.000000  1.000000  1.000000  1.000000  -0.271386
portfolio -0.271383 -0.271386 -0.271392 -0.271386   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.410,  sharpe:-0.674
2:  annret:-17.415,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:23.387,  sharpe:2.833
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.484371
1          1.000000  1.000000  1.000000  1.00000  -0.484384
2          1.000000  1.000000  1.000000  1.00000  -0.484403
3          1.000000  1.000000  1.000000  1.00000  -0.484390
portfolio -0.484371 -0.484384 -0.484403 -0.48439   1.000000
------------------
0:  annret:24.040,  sharpe:1.112
1:  annret:24.656,  sharpe:1.099
2:  annret:33.321,  sharpe:1.482
3:  annret:27.620,  sharpe:1.300
          0         1         2         3
0  1.000000  0.565879  0.483308  0.553323
1  0.565879  1.000000  0.643960  0.604927
2  0.483308  0.643960  1.000000  0.526690
3  0.553323  0.604927  0.526690  1.000000
Timestep 151000, Reward: 584.8104402033283, TD Loss: 28.192678596186866
test
0:  annret:23.960,  sharpe:1.117
1:  annret:19.864,  sharpe:0.955
2:  annret:16.427,  sharpe:0.730
3:  annret:21.292,  sharpe:0.974
          0         1         2         3
0  1.000000  0.860655  0.921934  0.904764
1  0.860655  1.000000  0.931741  0.921717
2  0.921934  0.931741  1.000000  0.943104
3  0.904764  0.921717  0.943104  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:43.286,  sharpe:1.958
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.886388
1          1.000000  1.000000  1.000000  1.000000  -0.886386
2          1.000000  1.000000  1.000000  1.000000  -0.886388
3          1.000000  1.000000  1.000000  1.000000  -0.886384
portfolio -0.886388 -0.886386 -0.886388 -0.886384   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.411,  sharpe:-0.674
2:  annret:-17.415,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:24.724,  sharpe:1.379
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.960602
1          1.000000  1.000000  1.000000  1.000000  -0.960602
2          1.000000  1.000000  1.000000  1.000000  -0.960606
3          1.000000  1.000000  1.000000  1.000000  -0.960604
portfolio -0.960602 -0.960602 -0.960606 -0.960604   1.000000
------------------
Timestep 152000, Reward: 584.8104402033283, TD Loss: 36.91396837437742
test
0:  annret:19.501,  sharpe:1.119
1:  annret:13.631,  sharpe:0.862
2:  annret:16.784,  sharpe:0.823
3:  annret:13.293,  sharpe:0.836
          0         1         2         3
0  1.000000  0.691030  0.858187  0.725472
1  0.691030  1.000000  0.813092  0.685538
2  0.858187  0.813092  1.000000  0.779060
3  0.725472  0.685538  0.779060  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.828,  sharpe:-0.059
portfolio:  annret:61.674,  sharpe:3.953
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000  -0.430227
1          1.000000  1.000000  1.00000  1.000000  -0.430227
2          1.000000  1.000000  1.00000  1.000000  -0.430230
3          1.000000  1.000000  1.00000  1.000000  -0.430217
portfolio -0.430227 -0.430227 -0.43023 -0.430217   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.410,  sharpe:-0.674
2:  annret:-17.415,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:20.950,  sharpe:2.291
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.529575
1          1.000000  1.000000  1.000000  1.000000  -0.529588
2          1.000000  1.000000  1.000000  1.000000  -0.529598
3          1.000000  1.000000  1.000000  1.000000  -0.529561
portfolio -0.529575 -0.529588 -0.529598 -0.529561   1.000000
------------------
0:  annret:19.720,  sharpe:0.932
1:  annret:21.510,  sharpe:0.989
2:  annret:28.535,  sharpe:1.231
3:  annret:24.201,  sharpe:1.105
          0         1         2         3
0  1.000000  0.594990  0.511993  0.460293
1  0.594990  1.000000  0.597254  0.391863
2  0.511993  0.597254  1.000000  0.480290
3  0.460293  0.391863  0.480290  1.000000
Timestep 153000, Reward: 553.2755562275833, TD Loss: 26.965748023678444
test
0:  annret:21.947,  sharpe:1.009
1:  annret:21.790,  sharpe:0.995
2:  annret:16.916,  sharpe:0.812
3:  annret:20.058,  sharpe:0.952
          0         1         2         3
0  1.000000  0.900289  0.909169  0.920259
1  0.900289  1.000000  0.910075  0.919268
2  0.909169  0.910075  1.000000  0.902419
3  0.920259  0.919268  0.902419  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:47.588,  sharpe:2.230
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.867817
1          1.000000  1.00000  1.000000  1.000000  -0.867820
2          1.000000  1.00000  1.000000  1.000000  -0.867816
3          1.000000  1.00000  1.000000  1.000000  -0.867814
portfolio -0.867817 -0.86782 -0.867816 -0.867814   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.414,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:27.069,  sharpe:1.632
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.928151
1          1.000000  1.000000  1.000000  1.000000  -0.928164
2          1.000000  1.000000  1.000000  1.000000  -0.928157
3          1.000000  1.000000  1.000000  1.000000  -0.928151
portfolio -0.928151 -0.928164 -0.928157 -0.928151   1.000000
------------------
Timestep 154000, Reward: 553.2755562275833, TD Loss: 21.05854371367471
test
0:  annret:19.241,  sharpe:1.010
1:  annret:8.262,  sharpe:0.546
2:  annret:17.716,  sharpe:0.956
3:  annret:19.100,  sharpe:1.068
          0         1         2         3
0  1.000000  0.656503  0.845326  0.822884
1  0.656503  1.000000  0.759278  0.714004
2  0.845326  0.759278  1.000000  0.766545
3  0.822884  0.714004  0.766545  1.000000
train
0:  annret:-1.826,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.830,  sharpe:-0.059
portfolio:  annret:61.800,  sharpe:3.836
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.454314
1          1.000000  1.000000  1.000000  1.000000  -0.454314
2          1.000000  1.000000  1.000000  1.000000  -0.454312
3          1.000000  1.000000  1.000000  1.000000  -0.454304
portfolio -0.454314 -0.454314 -0.454312 -0.454304   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.412,  sharpe:-0.674
portfolio:  annret:22.095,  sharpe:2.297
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.533112
1          1.000000  1.000000  1.000000  1.000000  -0.533135
2          1.000000  1.000000  1.000000  1.000000  -0.533123
3          1.000000  1.000000  1.000000  1.000000  -0.533099
portfolio -0.533112 -0.533135 -0.533123 -0.533099   1.000000
------------------
0:  annret:14.550,  sharpe:0.638
1:  annret:19.016,  sharpe:0.852
2:  annret:40.439,  sharpe:1.820
3:  annret:31.845,  sharpe:1.450
          0         1         2         3
0  1.000000  0.655291  0.561423  0.590154
1  0.655291  1.000000  0.509081  0.511511
2  0.561423  0.509081  1.000000  0.510308
3  0.590154  0.511511  0.510308  1.000000
Timestep 155000, Reward: 630.5987160062107, TD Loss: 14.782219812006748
test
0:  annret:20.951,  sharpe:1.453
1:  annret:9.922,  sharpe:0.732
2:  annret:12.286,  sharpe:0.711
3:  annret:19.244,  sharpe:1.001
          0         1         2         3
0  1.000000  0.303128  0.756233  0.738240
1  0.303128  1.000000  0.506038  0.530561
2  0.756233  0.506038  1.000000  0.769070
3  0.738240  0.530561  0.769070  1.000000
train
0:  annret:-1.824,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.830,  sharpe:-0.059
portfolio:  annret:65.069,  sharpe:4.619
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.249758
1          1.000000  1.000000  1.000000  1.000000  -0.249758
2          1.000000  1.000000  1.000000  1.000000  -0.249762
3          1.000000  1.000000  1.000000  1.000000  -0.249756
portfolio -0.249758 -0.249758 -0.249762 -0.249756   1.000000
test
0:  annret:-17.405,  sharpe:-0.673
1:  annret:-17.411,  sharpe:-0.674
2:  annret:-17.415,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:20.601,  sharpe:2.787
                  0        1        2         3  portfolio
0          1.000000  1.00000  1.00000  1.000000  -0.207007
1          1.000000  1.00000  1.00000  1.000000  -0.207020
2          1.000000  1.00000  1.00000  1.000000  -0.207030
3          1.000000  1.00000  1.00000  1.000000  -0.207013
portfolio -0.207007 -0.20702 -0.20703 -0.207013   1.000000
------------------
Timestep 156000, Reward: 630.5987160062107, TD Loss: 10.078751887276567
test
0:  annret:20.663,  sharpe:0.973
1:  annret:14.535,  sharpe:0.783
2:  annret:16.970,  sharpe:0.860
3:  annret:16.103,  sharpe:1.154
          0         1         2         3
0  1.000000  0.862772  0.908106  0.777662
1  0.862772  1.000000  0.895305  0.742013
2  0.908106  0.895305  1.000000  0.743499
3  0.777662  0.742013  0.743499  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.827,  sharpe:-0.059
portfolio:  annret:58.297,  sharpe:3.459
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.576076
1          1.000000  1.000000  1.000000  1.00000  -0.576071
2          1.000000  1.000000  1.000000  1.00000  -0.576069
3          1.000000  1.000000  1.000000  1.00000  -0.576060
portfolio -0.576076 -0.576071 -0.576069 -0.57606   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.412,  sharpe:-0.674
portfolio:  annret:20.594,  sharpe:1.856
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.693567
1          1.000000  1.000000  1.000000  1.000000  -0.693562
2          1.000000  1.000000  1.000000  1.000000  -0.693561
3          1.000000  1.000000  1.000000  1.000000  -0.693534
portfolio -0.693567 -0.693562 -0.693561 -0.693534   1.000000
------------------
0:  annret:17.227,  sharpe:0.762
1:  annret:11.634,  sharpe:0.519
2:  annret:34.224,  sharpe:1.533
3:  annret:30.973,  sharpe:1.435
          0         1         2         3
0  1.000000  0.572331  0.642143  0.302517
1  0.572331  1.000000  0.449101  0.373230
2  0.642143  0.449101  1.000000  0.347651
3  0.302517  0.373230  0.347651  1.000000
Timestep 157000, Reward: 548.8490364947411, TD Loss: 30.39777939945826
test
0:  annret:18.435,  sharpe:1.004
1:  annret:16.013,  sharpe:0.845
2:  annret:16.203,  sharpe:0.859
3:  annret:22.192,  sharpe:1.272
          0         1         2         3
0  1.000000  0.610103  0.789066  0.737185
1  0.610103  1.000000  0.803482  0.746812
2  0.789066  0.803482  1.000000  0.748534
3  0.737185  0.746812  0.748534  1.000000
train
0:  annret:-1.825,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.830,  sharpe:-0.059
portfolio:  annret:59.775,  sharpe:3.936
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.536882
1          1.000000  1.000000  1.000000  1.000000  -0.536887
2          1.000000  1.000000  1.000000  1.000000  -0.536888
3          1.000000  1.000000  1.000000  1.000000  -0.536879
portfolio -0.536882 -0.536887 -0.536888 -0.536879   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:23.790,  sharpe:2.581
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.507011
1          1.000000  1.000000  1.000000  1.000000  -0.507038
2          1.000000  1.000000  1.000000  1.000000  -0.507046
3          1.000000  1.000000  1.000000  1.000000  -0.507013
portfolio -0.507011 -0.507038 -0.507046 -0.507013   1.000000
------------------
Timestep 158000, Reward: 548.8490364947411, TD Loss: 55.17348776329143
test
0:  annret:8.556,  sharpe:0.836
1:  annret:14.330,  sharpe:0.757
2:  annret:14.936,  sharpe:0.797
3:  annret:8.517,  sharpe:0.778
          0         1         2         3
0  1.000000 -0.039672  0.068286  0.623609
1 -0.039672  1.000000  0.853831  0.021999
2  0.068286  0.853831  1.000000  0.187974
3  0.623609  0.021999  0.187974  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.830,  sharpe:-0.059
portfolio:  annret:60.040,  sharpe:3.642
                 0         1         2        3  portfolio
0          1.00000  1.000000  1.000000  1.00000  -0.285140
1          1.00000  1.000000  1.000000  1.00000  -0.285151
2          1.00000  1.000000  1.000000  1.00000  -0.285142
3          1.00000  1.000000  1.000000  1.00000  -0.285140
portfolio -0.28514 -0.285151 -0.285142 -0.28514   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:15.794,  sharpe:1.667
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.436583
1          1.000000  1.000000  1.000000  1.000000  -0.436598
2          1.000000  1.000000  1.000000  1.000000  -0.436595
3          1.000000  1.000000  1.000000  1.000000  -0.436579
portfolio -0.436583 -0.436598 -0.436595 -0.436579   1.000000
------------------
0:  annret:24.048,  sharpe:1.076
1:  annret:18.369,  sharpe:0.786
2:  annret:34.408,  sharpe:1.496
3:  annret:27.258,  sharpe:1.327
          0         1         2         3
0  1.000000  0.550197  0.522663  0.575729
1  0.550197  1.000000  0.598281  0.511710
2  0.522663  0.598281  1.000000  0.501571
3  0.575729  0.511710  0.501571  1.000000
Timestep 159000, Reward: 589.7481202129183, TD Loss: 12.503885330283191
test
0:  annret:21.656,  sharpe:1.036
1:  annret:19.781,  sharpe:0.890
2:  annret:14.322,  sharpe:0.694
3:  annret:20.125,  sharpe:1.041
          0         1         2         3
0  1.000000  0.870893  0.885115  0.862913
1  0.870893  1.000000  0.909921  0.891701
2  0.885115  0.909921  1.000000  0.860698
3  0.862913  0.891701  0.860698  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.838,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.060
portfolio:  annret:41.829,  sharpe:1.940
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.893538
1          1.000000  1.000000  1.000000  1.000000  -0.893539
2          1.000000  1.000000  1.000000  1.000000  -0.893537
3          1.000000  1.000000  1.000000  1.000000  -0.893532
portfolio -0.893538 -0.893539 -0.893537 -0.893532   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:23.118,  sharpe:1.364
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.949868
1          1.000000  1.000000  1.000000  1.000000  -0.949874
2          1.000000  1.000000  1.000000  1.000000  -0.949874
3          1.000000  1.000000  1.000000  1.000000  -0.949859
portfolio -0.949868 -0.949874 -0.949874 -0.949859   1.000000
------------------
Timestep 160000, Reward: 589.7481202129183, TD Loss: 72.42343707675559
test
0:  annret:21.335,  sharpe:0.903
1:  annret:19.672,  sharpe:0.848
2:  annret:16.610,  sharpe:0.748
3:  annret:19.381,  sharpe:0.827
          0         1         2         3
0  1.000000  0.970254  0.967059  0.978254
1  0.970254  1.000000  0.965992  0.977377
2  0.967059  0.965992  1.000000  0.967876
3  0.978254  0.977377  0.967876  1.000000
train
0:  annret:-1.839,  sharpe:-0.060
1:  annret:-1.839,  sharpe:-0.060
2:  annret:-1.839,  sharpe:-0.060
3:  annret:-1.839,  sharpe:-0.060
portfolio:  annret:23.325,  sharpe:0.830
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.978223
1          1.000000  1.000000  1.000000  1.000000  -0.978223
2          1.000000  1.000000  1.000000  1.000000  -0.978221
3          1.000000  1.000000  1.000000  1.000000  -0.978221
portfolio -0.978223 -0.978223 -0.978221 -0.978221   1.000000
test
0:  annret:-17.418,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:21.601,  sharpe:0.905
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.993514
1          1.000000  1.000000  1.000000  1.00000  -0.993514
2          1.000000  1.000000  1.000000  1.00000  -0.993513
3          1.000000  1.000000  1.000000  1.00000  -0.993510
portfolio -0.993514 -0.993514 -0.993513 -0.99351   1.000000
------------------
0:  annret:16.503,  sharpe:0.724
1:  annret:18.191,  sharpe:0.812
2:  annret:32.431,  sharpe:1.462
3:  annret:27.079,  sharpe:1.242
          0         1         2         3
0  1.000000  0.617996  0.565413  0.553581
1  0.617996  1.000000  0.481324  0.533132
2  0.565413  0.481324  1.000000  0.528820
3  0.553581  0.533132  0.528820  1.000000
Timestep 161000, Reward: 560.6321206054004, TD Loss: 21.731842971471682
test
0:  annret:18.673,  sharpe:0.982
1:  annret:3.491,  sharpe:0.273
2:  annret:8.146,  sharpe:0.729
3:  annret:22.816,  sharpe:1.400
          0         1         2         3
0  1.000000 -0.367964  0.326295  0.687889
1 -0.367964  1.000000  0.057887 -0.229356
2  0.326295  0.057887  1.000000  0.139612
3  0.687889 -0.229356  0.139612  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.833,  sharpe:-0.059
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.828,  sharpe:-0.059
portfolio:  annret:61.718,  sharpe:4.232
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.336566
1          1.000000  1.000000  1.000000  1.000000  -0.336555
2          1.000000  1.000000  1.000000  1.000000  -0.336558
3          1.000000  1.000000  1.000000  1.000000  -0.336556
portfolio -0.336566 -0.336555 -0.336558 -0.336556   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.411,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.413,  sharpe:-0.674
portfolio:  annret:18.216,  sharpe:1.989
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.440409
1          1.000000  1.000000  1.000000  1.000000  -0.440392
2          1.000000  1.000000  1.000000  1.000000  -0.440403
3          1.000000  1.000000  1.000000  1.000000  -0.440386
portfolio -0.440409 -0.440392 -0.440403 -0.440386   1.000000
------------------
Timestep 162000, Reward: 560.6321206054004, TD Loss: 12.319905625792357
test
0:  annret:24.105,  sharpe:1.106
1:  annret:20.260,  sharpe:0.929
2:  annret:18.874,  sharpe:0.900
3:  annret:24.362,  sharpe:1.165
          0         1         2         3
0  1.000000  0.889566  0.909242  0.910053
1  0.889566  1.000000  0.932399  0.926567
2  0.909242  0.932399  1.000000  0.919652
3  0.910053  0.926567  0.919652  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:41.778,  sharpe:1.873
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.912936
1          1.000000  1.000000  1.000000  1.000000  -0.912936
2          1.000000  1.000000  1.000000  1.000000  -0.912934
3          1.000000  1.000000  1.000000  1.000000  -0.912933
portfolio -0.912936 -0.912936 -0.912934 -0.912933   1.000000
test
0:  annret:-17.414,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:24.882,  sharpe:1.410
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.966147
1          1.000000  1.000000  1.000000  1.000000  -0.966149
2          1.000000  1.000000  1.000000  1.000000  -0.966148
3          1.000000  1.000000  1.000000  1.000000  -0.966145
portfolio -0.966147 -0.966149 -0.966148 -0.966145   1.000000
------------------
Timestep 163000, Reward: 560.6321206054004, TD Loss: 28.00306376795583
test
0:  annret:0.968,  sharpe:0.087
1:  annret:13.689,  sharpe:0.812
2:  annret:12.368,  sharpe:0.855
3:  annret:-7.861,  sharpe:-0.445
          0         1         2         3
0  1.000000 -0.137208  0.141270  0.015655
1 -0.137208  1.000000  0.493717 -0.694710
2  0.141270  0.493717  1.000000 -0.578179
3  0.015655 -0.694710 -0.578179  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.826,  sharpe:-0.059
portfolio:  annret:66.050,  sharpe:4.664
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.138766
1          1.000000  1.000000  1.000000  1.000000   0.138758
2          1.000000  1.000000  1.000000  1.000000   0.138766
3          1.000000  1.000000  1.000000  1.000000   0.138774
portfolio  0.138766  0.138758  0.138766  0.138774   1.000000
test
0:  annret:-17.408,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.411,  sharpe:-0.674
portfolio:  annret:13.457,  sharpe:1.720
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.323491
1          1.000000  1.000000  1.000000  1.000000   0.323475
2          1.000000  1.000000  1.000000  1.000000   0.323458
3          1.000000  1.000000  1.000000  1.000000   0.323514
portfolio  0.323491  0.323475  0.323458  0.323514   1.000000
------------------
0:  annret:15.882,  sharpe:0.667
1:  annret:20.184,  sharpe:0.960
2:  annret:34.088,  sharpe:1.563
3:  annret:23.798,  sharpe:1.123
          0         1         2         3
0  1.000000  0.576282  0.569278  0.440996
1  0.576282  1.000000  0.543393  0.444068
2  0.569278  0.543393  1.000000  0.427329
3  0.440996  0.444068  0.427329  1.000000
Timestep 164000, Reward: 557.6429829063121, TD Loss: 30.30365057810275
test
0:  annret:23.099,  sharpe:1.040
1:  annret:19.977,  sharpe:0.879
2:  annret:18.606,  sharpe:0.910
3:  annret:21.779,  sharpe:1.080
          0         1         2         3
0  1.000000  0.917530  0.907956  0.891249
1  0.917530  1.000000  0.942488  0.928209
2  0.907956  0.942488  1.000000  0.881090
3  0.891249  0.928209  0.881090  1.000000
train
0:  annret:-1.835,  sharpe:-0.060
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.829,  sharpe:-0.059
portfolio:  annret:43.814,  sharpe:2.028
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.895969
1          1.000000  1.000000  1.000000  1.000000  -0.895967
2          1.000000  1.000000  1.000000  1.000000  -0.895967
3          1.000000  1.000000  1.000000  1.000000  -0.895965
portfolio -0.895969 -0.895967 -0.895967 -0.895965   1.000000
test
0:  annret:-17.415,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.415,  sharpe:-0.674
portfolio:  annret:25.923,  sharpe:1.508
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.939933
1          1.000000  1.000000  1.000000  1.000000  -0.939937
2          1.000000  1.000000  1.000000  1.000000  -0.939935
3          1.000000  1.000000  1.000000  1.000000  -0.939926
portfolio -0.939933 -0.939937 -0.939935 -0.939926   1.000000
------------------
Timestep 165000, Reward: 557.6429829063121, TD Loss: 12.242065843040534
test
0:  annret:20.017,  sharpe:1.001
1:  annret:14.587,  sharpe:0.873
2:  annret:18.031,  sharpe:0.944
3:  annret:24.596,  sharpe:1.459
          0         1         2         3
0  1.000000  0.685218  0.868745  0.822192
1  0.685218  1.000000  0.773709  0.683176
2  0.868745  0.773709  1.000000  0.769205
3  0.822192  0.683176  0.769205  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.830,  sharpe:-0.059
portfolio:  annret:53.385,  sharpe:3.168
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.665985
1          1.000000  1.000000  1.000000  1.00000  -0.665989
2          1.000000  1.000000  1.000000  1.00000  -0.665984
3          1.000000  1.000000  1.000000  1.00000  -0.665980
portfolio -0.665985 -0.665989 -0.665984 -0.66598   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.414,  sharpe:-0.674
portfolio:  annret:20.404,  sharpe:1.866
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.814768
1          1.000000  1.000000  1.000000  1.000000  -0.814765
2          1.000000  1.000000  1.000000  1.000000  -0.814767
3          1.000000  1.000000  1.000000  1.000000  -0.814746
portfolio -0.814768 -0.814765 -0.814767 -0.814746   1.000000
------------------
0:  annret:21.304,  sharpe:0.927
1:  annret:19.874,  sharpe:0.899
2:  annret:40.818,  sharpe:1.776
3:  annret:26.941,  sharpe:1.261
          0         1         2         3
0  1.000000  0.625228  0.510102  0.538123
1  0.625228  1.000000  0.591670  0.594346
2  0.510102  0.591670  1.000000  0.501971
3  0.538123  0.594346  0.501971  1.000000
Timestep 166000, Reward: 631.0392091182512, TD Loss: 22.600330062798715
test
0:  annret:21.833,  sharpe:1.035
1:  annret:16.722,  sharpe:0.803
2:  annret:18.251,  sharpe:0.870
3:  annret:24.803,  sharpe:1.233
          0         1         2         3
0  1.000000  0.880506  0.919184  0.893023
1  0.880506  1.000000  0.924383  0.883474
2  0.919184  0.924383  1.000000  0.882685
3  0.893023  0.883474  0.882685  1.000000
train
0:  annret:-1.831,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:50.019,  sharpe:2.423
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.839669
1          1.000000  1.00000  1.000000  1.000000  -0.839670
2          1.000000  1.00000  1.000000  1.000000  -0.839667
3          1.000000  1.00000  1.000000  1.000000  -0.839665
portfolio -0.839669 -0.83967 -0.839667 -0.839665   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:22.718,  sharpe:1.450
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.926970
1          1.00000  1.000000  1.000000  1.000000  -0.926973
2          1.00000  1.000000  1.000000  1.000000  -0.926973
3          1.00000  1.000000  1.000000  1.000000  -0.926965
portfolio -0.92697 -0.926973 -0.926973 -0.926965   1.000000
------------------
Timestep 167000, Reward: 631.0392091182512, TD Loss: 29.89404044885966
test
0:  annret:5.891,  sharpe:0.475
1:  annret:13.171,  sharpe:0.734
2:  annret:14.088,  sharpe:0.817
3:  annret:16.035,  sharpe:1.006
          0         1         2         3
0  1.000000  0.612990  0.727066  0.696437
1  0.612990  1.000000  0.836072  0.723024
2  0.727066  0.836072  1.000000  0.759925
3  0.696437  0.723024  0.759925  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.829,  sharpe:-0.059
portfolio:  annret:60.686,  sharpe:4.299
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.197834
1          1.000000  1.000000  1.000000  1.000000  -0.197839
2          1.000000  1.000000  1.000000  1.000000  -0.197836
3          1.000000  1.000000  1.000000  1.000000  -0.197838
portfolio -0.197834 -0.197839 -0.197836 -0.197838   1.000000
test
0:  annret:-17.408,  sharpe:-0.673
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.413,  sharpe:-0.674
portfolio:  annret:16.856,  sharpe:2.144
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000  -0.259915
1          1.000000  1.000000  1.00000  1.000000  -0.259925
2          1.000000  1.000000  1.00000  1.000000  -0.259920
3          1.000000  1.000000  1.00000  1.000000  -0.259924
portfolio -0.259915 -0.259925 -0.25992 -0.259924   1.000000
------------------
0:  annret:19.629,  sharpe:0.868
1:  annret:18.090,  sharpe:0.835
2:  annret:33.172,  sharpe:1.484
3:  annret:33.328,  sharpe:1.505
          0         1         2         3
0  1.000000  0.621724  0.536692  0.521467
1  0.621724  1.000000  0.569717  0.565098
2  0.536692  0.569717  1.000000  0.595479
3  0.521467  0.565098  0.595479  1.000000
Timestep 168000, Reward: 606.0487988463643, TD Loss: 19.53794264386687
test
0:  annret:18.732,  sharpe:1.130
1:  annret:22.097,  sharpe:1.030
2:  annret:14.595,  sharpe:0.775
3:  annret:24.833,  sharpe:1.339
          0         1         2         3
0  1.000000  0.741351  0.799193  0.811608
1  0.741351  1.000000  0.880968  0.800599
2  0.799193  0.880968  1.000000  0.783753
3  0.811608  0.800599  0.783753  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:52.905,  sharpe:2.784
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.779712
1          1.000000  1.000000  1.000000  1.000000  -0.779721
2          1.000000  1.000000  1.000000  1.000000  -0.779715
3          1.000000  1.000000  1.000000  1.000000  -0.779717
portfolio -0.779712 -0.779721 -0.779715 -0.779717   1.000000
test
0:  annret:-17.409,  sharpe:-0.674
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:25.146,  sharpe:1.888
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.879909
1          1.000000  1.000000  1.000000  1.000000  -0.879932
2          1.000000  1.000000  1.000000  1.000000  -0.879924
3          1.000000  1.000000  1.000000  1.000000  -0.879917
portfolio -0.879909 -0.879932 -0.879924 -0.879917   1.000000
------------------
Timestep 169000, Reward: 606.0487988463643, TD Loss: 19.131482009802422
test
0:  annret:13.632,  sharpe:1.099
1:  annret:15.549,  sharpe:0.805
2:  annret:15.587,  sharpe:0.837
3:  annret:19.783,  sharpe:1.166
          0         1         2         3
0  1.000000  0.501654  0.675425  0.631294
1  0.501654  1.000000  0.858184  0.802160
2  0.675425  0.858184  1.000000  0.842923
3  0.631294  0.802160  0.842923  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:58.323,  sharpe:3.704
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.472605
1          1.000000  1.000000  1.000000  1.000000  -0.472621
2          1.000000  1.000000  1.000000  1.000000  -0.472611
3          1.000000  1.000000  1.000000  1.000000  -0.472612
portfolio -0.472605 -0.472621 -0.472611 -0.472612   1.000000
test
0:  annret:-17.408,  sharpe:-0.673
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:19.313,  sharpe:2.096
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.640762
1          1.000000  1.000000  1.000000  1.000000  -0.640779
2          1.000000  1.000000  1.000000  1.000000  -0.640771
3          1.000000  1.000000  1.000000  1.000000  -0.640751
portfolio -0.640762 -0.640779 -0.640771 -0.640751   1.000000
------------------
0:  annret:18.225,  sharpe:0.868
1:  annret:29.512,  sharpe:1.219
2:  annret:26.562,  sharpe:1.212
3:  annret:29.588,  sharpe:1.333
          0         1         2         3
0  1.000000  0.479395  0.557868  0.491101
1  0.479395  1.000000  0.612510  0.619096
2  0.557868  0.612510  1.000000  0.507305
3  0.491101  0.619096  0.507305  1.000000
Timestep 170000, Reward: 617.483404497829, TD Loss: 16.295037738162563
test
0:  annret:14.909,  sharpe:0.885
1:  annret:13.376,  sharpe:0.686
2:  annret:16.123,  sharpe:0.808
3:  annret:21.050,  sharpe:1.185
          0         1         2         3
0  1.000000  0.688039  0.840310  0.779412
1  0.688039  1.000000  0.838997  0.727299
2  0.840310  0.838997  1.000000  0.817346
3  0.779412  0.727299  0.817346  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:55.804,  sharpe:3.399
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.649401
1          1.000000  1.000000  1.000000  1.000000  -0.649408
2          1.000000  1.000000  1.000000  1.000000  -0.649406
3          1.000000  1.000000  1.000000  1.000000  -0.649401
portfolio -0.649401 -0.649408 -0.649406 -0.649401   1.000000
test
0:  annret:-17.408,  sharpe:-0.673
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.414,  sharpe:-0.674
portfolio:  annret:21.798,  sharpe:2.046
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.766642
1          1.000000  1.000000  1.000000  1.000000  -0.766655
2          1.000000  1.000000  1.000000  1.000000  -0.766661
3          1.000000  1.000000  1.000000  1.000000  -0.766629
portfolio -0.766642 -0.766655 -0.766661 -0.766629   1.000000
------------------
Timestep 171000, Reward: 617.483404497829, TD Loss: 47.10966235554376
test
0:  annret:-3.746,  sharpe:-0.236
1:  annret:16.406,  sharpe:0.790
2:  annret:14.254,  sharpe:0.745
3:  annret:14.183,  sharpe:0.799
          0         1         2         3
0  1.000000 -0.793840 -0.740027 -0.719696
1 -0.793840  1.000000  0.891393  0.869851
2 -0.740027  0.891393  1.000000  0.874141
3 -0.719696  0.869851  0.874141  1.000000
train
0:  annret:-1.838,  sharpe:-0.060
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:57.590,  sharpe:3.463
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.423711
1          1.000000  1.000000  1.000000  1.00000  -0.423727
2          1.000000  1.000000  1.000000  1.00000  -0.423719
3          1.000000  1.000000  1.000000  1.00000  -0.423720
portfolio -0.423711 -0.423727 -0.423719 -0.42372   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:11.997,  sharpe:1.213
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.629580
1          1.00000  1.000000  1.000000  1.000000  -0.629589
2          1.00000  1.000000  1.000000  1.000000  -0.629591
3          1.00000  1.000000  1.000000  1.000000  -0.629575
portfolio -0.62958 -0.629589 -0.629591 -0.629575   1.000000
------------------
0:  annret:27.274,  sharpe:1.314
1:  annret:22.268,  sharpe:0.916
2:  annret:31.471,  sharpe:1.371
3:  annret:25.198,  sharpe:1.182
          0         1         2         3
0  1.000000  0.361692  0.391434  0.448827
1  0.361692  1.000000  0.624362  0.522281
2  0.391434  0.624362  1.000000  0.494936
3  0.448827  0.522281  0.494936  1.000000
Timestep 172000, Reward: 579.5355596360891, TD Loss: 18.627080293761473
test
0:  annret:18.326,  sharpe:0.997
1:  annret:18.104,  sharpe:0.845
2:  annret:16.570,  sharpe:0.825
3:  annret:18.470,  sharpe:1.071
          0         1         2         3
0  1.000000  0.728101  0.827903  0.792378
1  0.728101  1.000000  0.859783  0.762416
2  0.827903  0.859783  1.000000  0.774816
3  0.792378  0.762416  0.774816  1.000000
train
0:  annret:-1.826,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.826,  sharpe:-0.059
portfolio:  annret:58.534,  sharpe:3.478
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.669981
1          1.000000  1.000000  1.000000  1.000000  -0.669988
2          1.000000  1.000000  1.000000  1.000000  -0.669987
3          1.000000  1.000000  1.000000  1.000000  -0.669979
portfolio -0.669981 -0.669988 -0.669987 -0.669979   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.412,  sharpe:-0.674
portfolio:  annret:22.290,  sharpe:1.960
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.765559
1          1.000000  1.000000  1.000000  1.000000  -0.765585
2          1.000000  1.000000  1.000000  1.000000  -0.765587
3          1.000000  1.000000  1.000000  1.000000  -0.765556
portfolio -0.765559 -0.765585 -0.765587 -0.765556   1.000000
------------------
Timestep 173000, Reward: 579.5355596360891, TD Loss: 32.19222552523264
test
0:  annret:21.054,  sharpe:0.975
1:  annret:16.836,  sharpe:0.734
2:  annret:17.826,  sharpe:0.767
3:  annret:16.948,  sharpe:0.760
          0         1         2         3
0  1.000000  0.920403  0.942321  0.932035
1  0.920403  1.000000  0.971323  0.958439
2  0.942321  0.971323  1.000000  0.963660
3  0.932035  0.958439  0.963660  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.839,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:34.769,  sharpe:1.402
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.948857
1          1.000000  1.000000  1.000000  1.000000  -0.948857
2          1.000000  1.000000  1.000000  1.000000  -0.948857
3          1.000000  1.000000  1.000000  1.000000  -0.948857
portfolio -0.948857 -0.948857 -0.948857 -0.948857   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:23.150,  sharpe:1.128
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.977818
1          1.000000  1.000000  1.000000  1.000000  -0.977826
2          1.000000  1.000000  1.000000  1.000000  -0.977826
3          1.000000  1.000000  1.000000  1.000000  -0.977819
portfolio -0.977818 -0.977826 -0.977826 -0.977819   1.000000
------------------
0:  annret:25.855,  sharpe:1.206
1:  annret:24.584,  sharpe:1.080
2:  annret:35.993,  sharpe:1.566
3:  annret:20.429,  sharpe:0.985
          0         1         2         3
0  1.000000  0.406769  0.411958  0.453224
1  0.406769  1.000000  0.616351  0.527872
2  0.411958  0.616351  1.000000  0.548368
3  0.453224  0.527872  0.548368  1.000000
Timestep 174000, Reward: 591.9029967415167, TD Loss: 24.69067340037977
test
0:  annret:8.743,  sharpe:0.706
1:  annret:13.421,  sharpe:0.738
2:  annret:8.188,  sharpe:0.461
3:  annret:-13.573,  sharpe:-0.681
          0         1         2         3
0  1.000000  0.502034  0.638982 -0.606838
1  0.502034  1.000000  0.787091 -0.835177
2  0.638982  0.787091  1.000000 -0.752912
3 -0.606838 -0.835177 -0.752912  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.828,  sharpe:-0.059
portfolio:  annret:67.941,  sharpe:4.442
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.276971
1          1.000000  1.000000  1.000000  1.000000  -0.276977
2          1.000000  1.000000  1.000000  1.000000  -0.276976
3          1.000000  1.000000  1.000000  1.000000  -0.276975
portfolio -0.276971 -0.276977 -0.276976 -0.276975   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.414,  sharpe:-0.674
portfolio:  annret:15.932,  sharpe:1.885
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.409485
1          1.000000  1.000000  1.000000  1.000000  -0.409505
2          1.000000  1.000000  1.000000  1.000000  -0.409504
3          1.000000  1.000000  1.000000  1.000000  -0.409476
portfolio -0.409485 -0.409505 -0.409504 -0.409476   1.000000
------------------
Timestep 175000, Reward: 591.9029967415167, TD Loss: 18.132290785341596
test
0:  annret:15.737,  sharpe:0.916
1:  annret:16.190,  sharpe:0.754
2:  annret:18.056,  sharpe:0.870
3:  annret:19.705,  sharpe:0.976
          0         1         2         3
0  1.000000  0.795617  0.844839  0.811146
1  0.795617  1.000000  0.919038  0.883665
2  0.844839  0.919038  1.000000  0.869723
3  0.811146  0.883665  0.869723  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:53.810,  sharpe:2.785
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.774773
1          1.000000  1.00000  1.000000  1.000000  -0.774780
2          1.000000  1.00000  1.000000  1.000000  -0.774777
3          1.000000  1.00000  1.000000  1.000000  -0.774777
portfolio -0.774773 -0.77478 -0.774777 -0.774777   1.000000
test
0:  annret:-17.408,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.420,  sharpe:-0.674
portfolio:  annret:22.828,  sharpe:1.583
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.892131
1          1.000000  1.000000  1.000000  1.000000  -0.892148
2          1.000000  1.000000  1.000000  1.000000  -0.892143
3          1.000000  1.000000  1.000000  1.000000  -0.892135
portfolio -0.892131 -0.892148 -0.892143 -0.892135   1.000000
------------------
Timestep 176000, Reward: 591.9029967415167, TD Loss: 22.421817044189538
test
0:  annret:14.440,  sharpe:1.166
1:  annret:15.832,  sharpe:0.882
2:  annret:17.138,  sharpe:0.910
3:  annret:20.443,  sharpe:1.528
          0         1         2         3
0  1.000000  0.290569  0.602039  0.477922
1  0.290569  1.000000  0.779403  0.409743
2  0.602039  0.779403  1.000000  0.503984
3  0.477922  0.409743  0.503984  1.000000
train
0:  annret:-1.826,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.827,  sharpe:-0.059
portfolio:  annret:64.915,  sharpe:4.281
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.396316
1          1.000000  1.000000  1.000000  1.000000  -0.396326
2          1.000000  1.000000  1.000000  1.000000  -0.396323
3          1.000000  1.000000  1.000000  1.000000  -0.396318
portfolio -0.396316 -0.396326 -0.396323 -0.396318   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:18.146,  sharpe:2.082
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.537639
1          1.000000  1.000000  1.000000  1.000000  -0.537654
2          1.000000  1.000000  1.000000  1.000000  -0.537656
3          1.000000  1.000000  1.000000  1.000000  -0.537626
portfolio -0.537639 -0.537654 -0.537656 -0.537626   1.000000
------------------
0:  annret:19.396,  sharpe:0.918
1:  annret:19.722,  sharpe:0.853
2:  annret:40.159,  sharpe:1.771
3:  annret:25.513,  sharpe:1.279
          0         1         2         3
0  1.000000  0.470930  0.500189  0.493142
1  0.470930  1.000000  0.575864  0.360491
2  0.500189  0.575864  1.000000  0.411160
3  0.493142  0.360491  0.411160  1.000000
Timestep 177000, Reward: 568.8985690640487, TD Loss: 23.762271008246238
test
0:  annret:20.718,  sharpe:1.174
1:  annret:18.364,  sharpe:0.799
2:  annret:18.112,  sharpe:0.860
3:  annret:17.543,  sharpe:0.835
          0         1         2         3
0  1.000000  0.848926  0.873029  0.843090
1  0.848926  1.000000  0.943181  0.927978
2  0.873029  0.943181  1.000000  0.902741
3  0.843090  0.927978  0.902741  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.839,  sharpe:-0.060
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:50.366,  sharpe:2.407
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.839937
1          1.000000  1.000000  1.000000  1.000000  -0.839942
2          1.000000  1.000000  1.000000  1.000000  -0.839941
3          1.000000  1.000000  1.000000  1.000000  -0.839941
portfolio -0.839937 -0.839942 -0.839941 -0.839941   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:24.041,  sharpe:1.471
                  0         1        2         3  portfolio
0          1.000000  1.000000  1.00000  1.000000  -0.937595
1          1.000000  1.000000  1.00000  1.000000  -0.937606
2          1.000000  1.000000  1.00000  1.000000  -0.937610
3          1.000000  1.000000  1.00000  1.000000  -0.937603
portfolio -0.937595 -0.937606 -0.93761 -0.937603   1.000000
------------------
Timestep 178000, Reward: 568.8985690640487, TD Loss: 16.067504941981984
test
0:  annret:18.344,  sharpe:1.139
1:  annret:14.411,  sharpe:0.698
2:  annret:17.419,  sharpe:0.945
3:  annret:16.770,  sharpe:0.912
          0         1         2         3
0  1.000000  0.797568  0.827713  0.783881
1  0.797568  1.000000  0.863070  0.827854
2  0.827713  0.863070  1.000000  0.824479
3  0.783881  0.827854  0.824479  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:54.470,  sharpe:3.097
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.671132
1          1.000000  1.000000  1.000000  1.000000  -0.671141
2          1.000000  1.000000  1.000000  1.000000  -0.671135
3          1.000000  1.000000  1.000000  1.000000  -0.671135
portfolio -0.671132 -0.671141 -0.671135 -0.671135   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:17.156,  sharpe:1.478
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.826204
1          1.000000  1.000000  1.000000  1.000000  -0.826221
2          1.000000  1.000000  1.000000  1.000000  -0.826205
3          1.000000  1.000000  1.000000  1.000000  -0.826204
portfolio -0.826204 -0.826221 -0.826205 -0.826204   1.000000
------------------
0:  annret:16.021,  sharpe:0.712
1:  annret:17.909,  sharpe:0.805
2:  annret:37.323,  sharpe:1.656
3:  annret:31.595,  sharpe:1.433
          0         1         2         3
0  1.000000  0.535913  0.584388  0.645443
1  0.535913  1.000000  0.511997  0.565515
2  0.584388  0.511997  1.000000  0.554217
3  0.645443  0.565515  0.554217  1.000000
Timestep 179000, Reward: 592.059873989753, TD Loss: 19.76169590828422
test
0:  annret:11.054,  sharpe:0.889
1:  annret:14.426,  sharpe:0.731
2:  annret:19.429,  sharpe:1.075
3:  annret:16.104,  sharpe:0.814
          0         1         2         3
0  1.000000  0.586863  0.623989  0.608719
1  0.586863  1.000000  0.831927  0.856119
2  0.623989  0.831927  1.000000  0.825623
3  0.608719  0.856119  0.825623  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:64.560,  sharpe:4.186
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.534709
1          1.000000  1.000000  1.000000  1.000000  -0.534716
2          1.000000  1.000000  1.000000  1.000000  -0.534714
3          1.000000  1.000000  1.000000  1.000000  -0.534716
portfolio -0.534709 -0.534716 -0.534714 -0.534716   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:22.754,  sharpe:2.297
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.655331
1          1.000000  1.00000  1.000000  1.000000  -0.655350
2          1.000000  1.00000  1.000000  1.000000  -0.655346
3          1.000000  1.00000  1.000000  1.000000  -0.655334
portfolio -0.655331 -0.65535 -0.655346 -0.655334   1.000000
------------------
Timestep 180000, Reward: 592.059873989753, TD Loss: 7.736675999151778
test
0:  annret:11.216,  sharpe:1.082
1:  annret:16.105,  sharpe:0.798
2:  annret:18.303,  sharpe:1.004
3:  annret:19.163,  sharpe:1.148
          0         1         2         3
0  1.000000  0.532948  0.599334  0.539119
1  0.532948  1.000000  0.842967  0.795291
2  0.599334  0.842967  1.000000  0.799877
3  0.539119  0.795291  0.799877  1.000000
train
0:  annret:-1.824,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:61.037,  sharpe:4.062
                  0        1         2         3  portfolio
0          1.000000  1.00000  1.000000  1.000000  -0.445206
1          1.000000  1.00000  1.000000  1.000000  -0.445220
2          1.000000  1.00000  1.000000  1.000000  -0.445215
3          1.000000  1.00000  1.000000  1.000000  -0.445218
portfolio -0.445206 -0.44522 -0.445215 -0.445218   1.000000
test
0:  annret:-17.404,  sharpe:-0.673
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.415,  sharpe:-0.674
portfolio:  annret:18.908,  sharpe:2.269
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.594849
1          1.000000  1.000000  1.000000  1.000000  -0.594884
2          1.000000  1.000000  1.000000  1.000000  -0.594876
3          1.000000  1.000000  1.000000  1.000000  -0.594863
portfolio -0.594849 -0.594884 -0.594876 -0.594863   1.000000
------------------
0:  annret:12.650,  sharpe:0.613
1:  annret:19.315,  sharpe:0.849
2:  annret:35.977,  sharpe:1.692
3:  annret:30.115,  sharpe:1.465
          0         1         2         3
0  1.000000  0.614966  0.459689  0.521818
1  0.614966  1.000000  0.471880  0.480886
2  0.459689  0.471880  1.000000  0.514281
3  0.521818  0.480886  0.514281  1.000000
Timestep 181000, Reward: 531.8387845210457, TD Loss: 8.53627364255085
test
0:  annret:-1.469,  sharpe:-0.117
1:  annret:16.377,  sharpe:0.794
2:  annret:18.011,  sharpe:0.926
3:  annret:17.125,  sharpe:0.827
          0         1         2         3
0  1.000000 -0.795767 -0.757829 -0.829728
1 -0.795767  1.000000  0.857656  0.846852
2 -0.757829  0.857656  1.000000  0.867219
3 -0.829728  0.846852  0.867219  1.000000
train
0:  annret:-1.823,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.838,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:67.252,  sharpe:4.455
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.471310
1          1.00000  1.000000  1.000000  1.000000  -0.471321
2          1.00000  1.000000  1.000000  1.000000  -0.471318
3          1.00000  1.000000  1.000000  1.000000  -0.471324
portfolio -0.47131 -0.471321 -0.471318 -0.471324   1.000000
test
0:  annret:-17.404,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.421,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:18.996,  sharpe:2.102
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.672741
1          1.000000  1.000000  1.000000  1.00000  -0.672775
2          1.000000  1.000000  1.000000  1.00000  -0.672774
3          1.000000  1.000000  1.000000  1.00000  -0.672760
portfolio -0.672741 -0.672775 -0.672774 -0.67276   1.000000
------------------
Timestep 182000, Reward: 531.8387845210457, TD Loss: 41.39550911920789
test
0:  annret:21.149,  sharpe:1.044
1:  annret:-2.163,  sharpe:-0.225
2:  annret:20.444,  sharpe:1.036
3:  annret:18.781,  sharpe:1.125
          0         1         2         3
0  1.000000 -0.372072  0.898091  0.812674
1 -0.372072  1.000000 -0.356451 -0.262165
2  0.898091 -0.356451  1.000000  0.824700
3  0.812674 -0.262165  0.824700  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.830,  sharpe:-0.059
portfolio:  annret:58.396,  sharpe:4.085
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.420086
1          1.000000  1.000000  1.000000  1.000000  -0.420075
2          1.000000  1.000000  1.000000  1.000000  -0.420082
3          1.000000  1.000000  1.000000  1.000000  -0.420084
portfolio -0.420086 -0.420075 -0.420082 -0.420084   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.420,  sharpe:-0.674
3:  annret:-17.414,  sharpe:-0.674
portfolio:  annret:16.822,  sharpe:1.858
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.512039
1          1.000000  1.000000  1.000000  1.000000  -0.512031
2          1.000000  1.000000  1.000000  1.000000  -0.512038
3          1.000000  1.000000  1.000000  1.000000  -0.512012
portfolio -0.512039 -0.512031 -0.512038 -0.512012   1.000000
------------------
0:  annret:14.931,  sharpe:0.730
1:  annret:13.343,  sharpe:0.592
2:  annret:38.643,  sharpe:1.734
3:  annret:32.355,  sharpe:1.423
          0         1         2         3
0  1.000000  0.408851  0.420048  0.560670
1  0.408851  1.000000  0.492301  0.539184
2  0.420048  0.492301  1.000000  0.603275
3  0.560670  0.539184  0.603275  1.000000
Timestep 183000, Reward: 554.1198004627029, TD Loss: 17.901948591633897
test
0:  annret:22.150,  sharpe:1.072
1:  annret:15.394,  sharpe:0.714
2:  annret:20.708,  sharpe:1.031
3:  annret:14.820,  sharpe:0.745
          0         1         2         3
0  1.000000  0.840851  0.888225  0.854171
1  0.840851  1.000000  0.886686  0.838352
2  0.888225  0.886686  1.000000  0.821792
3  0.854171  0.838352  0.821792  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:50.738,  sharpe:2.726
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.809094
1          1.000000  1.000000  1.000000  1.000000  -0.809094
2          1.000000  1.000000  1.000000  1.000000  -0.809092
3          1.000000  1.000000  1.000000  1.000000  -0.809095
portfolio -0.809094 -0.809094 -0.809092 -0.809095   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.416,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:21.218,  sharpe:1.558
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.882831
1          1.000000  1.000000  1.000000  1.000000  -0.882845
2          1.000000  1.000000  1.000000  1.000000  -0.882838
3          1.000000  1.000000  1.000000  1.000000  -0.882828
portfolio -0.882831 -0.882845 -0.882838 -0.882828   1.000000
------------------
Timestep 184000, Reward: 554.1198004627029, TD Loss: 129.03184647756916
test
0:  annret:-8.160,  sharpe:-0.438
1:  annret:-16.838,  sharpe:-0.782
2:  annret:14.324,  sharpe:0.859
3:  annret:-0.105,  sharpe:-0.011
          0         1         2         3
0  1.000000  0.870384 -0.758304  0.343514
1  0.870384  1.000000 -0.835330  0.297853
2 -0.758304 -0.835330  1.000000 -0.110841
3  0.343514  0.297853 -0.110841  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:56.433,  sharpe:3.542
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.491512
1          1.000000  1.000000  1.000000  1.000000   0.491512
2          1.000000  1.000000  1.000000  1.000000   0.491519
3          1.000000  1.000000  1.000000  1.000000   0.491519
portfolio  0.491512  0.491512  0.491519  0.491519   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.412,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:7.312,  sharpe:0.684
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000   0.631315
1          1.000000  1.000000  1.000000  1.000000   0.631313
2          1.000000  1.000000  1.000000  1.000000   0.631323
3          1.000000  1.000000  1.000000  1.000000   0.631338
portfolio  0.631315  0.631313  0.631323  0.631338   1.000000
------------------
0:  annret:18.577,  sharpe:0.890
1:  annret:11.077,  sharpe:0.483
2:  annret:31.362,  sharpe:1.371
3:  annret:29.604,  sharpe:1.315
          0         1         2         3
0  1.000000  0.596004  0.476343  0.545914
1  0.596004  1.000000  0.448939  0.529205
2  0.476343  0.448939  1.000000  0.605848
3  0.545914  0.529205  0.605848  1.000000
Timestep 185000, Reward: 593.0514676987422, TD Loss: 34.08855649981172
test
0:  annret:21.974,  sharpe:1.232
1:  annret:14.298,  sharpe:0.659
2:  annret:22.196,  sharpe:1.131
3:  annret:15.510,  sharpe:0.848
          0         1         2         3
0  1.000000  0.679430  0.793558  0.805572
1  0.679430  1.000000  0.839331  0.723382
2  0.793558  0.839331  1.000000  0.755838
3  0.805572  0.723382  0.755838  1.000000
train
0:  annret:-1.828,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.831,  sharpe:-0.059
portfolio:  annret:55.960,  sharpe:3.139
                  0         1      2      3  portfolio
0          1.000000  1.000000  1.000  1.000  -0.713995
1          1.000000  1.000000  1.000  1.000  -0.714003
2          1.000000  1.000000  1.000  1.000  -0.714000
3          1.000000  1.000000  1.000  1.000  -0.714000
portfolio -0.713995 -0.714003 -0.714 -0.714   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.414,  sharpe:-0.674
portfolio:  annret:22.906,  sharpe:1.910
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.831148
1          1.000000  1.000000  1.000000  1.000000  -0.831174
2          1.000000  1.000000  1.000000  1.000000  -0.831165
3          1.000000  1.000000  1.000000  1.000000  -0.831146
portfolio -0.831148 -0.831174 -0.831165 -0.831146   1.000000
------------------
Timestep 186000, Reward: 593.0514676987422, TD Loss: 34.548153569743434
test
0:  annret:21.758,  sharpe:1.003
1:  annret:18.005,  sharpe:0.770
2:  annret:19.797,  sharpe:0.917
3:  annret:15.666,  sharpe:0.718
          0         1         2         3
0  1.000000  0.927497  0.918163  0.927426
1  0.927497  1.000000  0.943554  0.945984
2  0.918163  0.943554  1.000000  0.913145
3  0.927426  0.945984  0.913145  1.000000
train
0:  annret:-1.833,  sharpe:-0.060
1:  annret:-1.838,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:41.923,  sharpe:1.813
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.913926
1          1.000000  1.000000  1.000000  1.000000  -0.913927
2          1.000000  1.000000  1.000000  1.000000  -0.913925
3          1.000000  1.000000  1.000000  1.000000  -0.913927
portfolio -0.913926 -0.913927 -0.913925 -0.913927   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:23.404,  sharpe:1.263
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.964501
1          1.000000  1.000000  1.000000  1.000000  -0.964509
2          1.000000  1.000000  1.000000  1.000000  -0.964505
3          1.000000  1.000000  1.000000  1.000000  -0.964504
portfolio -0.964501 -0.964509 -0.964505 -0.964504   1.000000
------------------
0:  annret:18.067,  sharpe:0.865
1:  annret:12.241,  sharpe:0.533
2:  annret:40.406,  sharpe:1.778
3:  annret:29.512,  sharpe:1.303
          0         1         2         3
0  1.000000  0.631499  0.364971  0.364335
1  0.631499  1.000000  0.368960  0.361206
2  0.364971  0.368960  1.000000  0.607389
3  0.364335  0.361206  0.607389  1.000000
Timestep 187000, Reward: 583.8478910786552, TD Loss: 13.917350674583762
test
0:  annret:18.837,  sharpe:0.973
1:  annret:12.601,  sharpe:0.643
2:  annret:19.061,  sharpe:0.957
3:  annret:9.852,  sharpe:0.586
          0         1         2         3
0  1.000000  0.729488  0.867963  0.751034
1  0.729488  1.000000  0.821430  0.658657
2  0.867963  0.821430  1.000000  0.703352
3  0.751034  0.658657  0.703352  1.000000
train
0:  annret:-1.834,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.060
portfolio:  annret:55.090,  sharpe:3.242
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.666212
1          1.000000  1.000000  1.000000  1.000000  -0.666217
2          1.000000  1.000000  1.000000  1.000000  -0.666211
3          1.000000  1.000000  1.000000  1.000000  -0.666218
portfolio -0.666212 -0.666217 -0.666211 -0.666218   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.414,  sharpe:-0.674
portfolio:  annret:19.559,  sharpe:1.744
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.815391
1          1.000000  1.000000  1.000000  1.000000  -0.815406
2          1.000000  1.000000  1.000000  1.000000  -0.815399
3          1.000000  1.000000  1.000000  1.000000  -0.815389
portfolio -0.815391 -0.815406 -0.815399 -0.815389   1.000000
------------------
Timestep 188000, Reward: 583.8478910786552, TD Loss: 19.77475602996288
test
0:  annret:21.953,  sharpe:1.046
1:  annret:20.658,  sharpe:0.914
2:  annret:20.950,  sharpe:0.957
3:  annret:16.577,  sharpe:0.768
          0         1         2         3
0  1.000000  0.892918  0.905159  0.909130
1  0.892918  1.000000  0.945615  0.921605
2  0.905159  0.945615  1.000000  0.910337
3  0.909130  0.921605  0.910337  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.837,  sharpe:-0.060
3:  annret:-1.835,  sharpe:-0.060
portfolio:  annret:45.424,  sharpe:2.054
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.893314
1          1.000000  1.000000  1.000000  1.000000  -0.893316
2          1.000000  1.000000  1.000000  1.000000  -0.893314
3          1.000000  1.000000  1.000000  1.000000  -0.893317
portfolio -0.893314 -0.893316 -0.893314 -0.893317   1.000000
test
0:  annret:-17.409,  sharpe:-0.674
1:  annret:-17.413,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:25.775,  sharpe:1.468
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.949848
1          1.000000  1.000000  1.000000  1.000000  -0.949855
2          1.000000  1.000000  1.000000  1.000000  -0.949852
3          1.000000  1.000000  1.000000  1.000000  -0.949852
portfolio -0.949848 -0.949855 -0.949852 -0.949852   1.000000
------------------
Timestep 189000, Reward: 583.8478910786552, TD Loss: 12.512353689748638
test
0:  annret:20.175,  sharpe:1.039
1:  annret:15.200,  sharpe:0.785
2:  annret:18.511,  sharpe:0.940
3:  annret:13.828,  sharpe:0.781
          0         1         2         3
0  1.000000  0.798615  0.869365  0.814350
1  0.798615  1.000000  0.870236  0.763427
2  0.869365  0.870236  1.000000  0.757636
3  0.814350  0.763427  0.757636  1.000000
train
0:  annret:-1.827,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.830,  sharpe:-0.059
portfolio:  annret:57.099,  sharpe:3.548
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.617997
1          1.000000  1.000000  1.000000  1.000000  -0.617997
2          1.000000  1.000000  1.000000  1.000000  -0.617997
3          1.000000  1.000000  1.000000  1.000000  -0.617996
portfolio -0.617997 -0.617997 -0.617997 -0.617996   1.000000
test
0:  annret:-17.408,  sharpe:-0.674
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.412,  sharpe:-0.674
portfolio:  annret:21.023,  sharpe:2.047
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.675448
1          1.000000  1.000000  1.000000  1.000000  -0.675463
2          1.000000  1.000000  1.000000  1.000000  -0.675463
3          1.000000  1.000000  1.000000  1.000000  -0.675432
portfolio -0.675448 -0.675463 -0.675463 -0.675432   1.000000
------------------
0:  annret:14.012,  sharpe:0.629
1:  annret:18.192,  sharpe:0.808
2:  annret:35.643,  sharpe:1.565
3:  annret:34.489,  sharpe:1.577
          0         1         2         3
0  1.000000  0.566736  0.586396  0.568404
1  0.566736  1.000000  0.484669  0.529486
2  0.586396  0.484669  1.000000  0.529930
3  0.568404  0.529486  0.529930  1.000000
Timestep 190000, Reward: 610.6496705348457, TD Loss: 24.352077186090288
test
0:  annret:14.744,  sharpe:0.941
1:  annret:18.154,  sharpe:0.813
2:  annret:16.985,  sharpe:0.808
3:  annret:16.723,  sharpe:0.808
          0         1         2         3
0  1.000000  0.724100  0.769684  0.765305
1  0.724100  1.000000  0.913172  0.870069
2  0.769684  0.913172  1.000000  0.835294
3  0.765305  0.870069  0.835294  1.000000
train
0:  annret:-1.824,  sharpe:-0.059
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:54.511,  sharpe:2.928
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.784888
1          1.000000  1.000000  1.000000  1.000000  -0.784899
2          1.000000  1.000000  1.000000  1.000000  -0.784895
3          1.000000  1.000000  1.000000  1.000000  -0.784896
portfolio -0.784888 -0.784899 -0.784895 -0.784896   1.000000
test
0:  annret:-17.405,  sharpe:-0.673
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:25.470,  sharpe:1.906
                  0         1        2        3  portfolio
0          1.000000  1.000000  1.00000  1.00000  -0.880154
1          1.000000  1.000000  1.00000  1.00000  -0.880182
2          1.000000  1.000000  1.00000  1.00000  -0.880180
3          1.000000  1.000000  1.00000  1.00000  -0.880170
portfolio -0.880154 -0.880182 -0.88018 -0.88017   1.000000
------------------
Timestep 191000, Reward: 610.6496705348457, TD Loss: 9.102649512449362
test
0:  annret:16.330,  sharpe:0.948
1:  annret:15.430,  sharpe:0.762
2:  annret:17.293,  sharpe:0.927
3:  annret:15.317,  sharpe:0.900
          0         1         2         3
0  1.000000  0.763056  0.823157  0.739925
1  0.763056  1.000000  0.854932  0.765546
2  0.823157  0.854932  1.000000  0.754946
3  0.739925  0.765546  0.754946  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:56.604,  sharpe:3.620
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.579050
1          1.00000  1.000000  1.000000  1.000000  -0.579055
2          1.00000  1.000000  1.000000  1.000000  -0.579047
3          1.00000  1.000000  1.000000  1.000000  -0.579053
portfolio -0.57905 -0.579055 -0.579047 -0.579053   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.419,  sharpe:-0.674
3:  annret:-17.414,  sharpe:-0.674
portfolio:  annret:19.355,  sharpe:2.098
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.682379
1          1.000000  1.000000  1.000000  1.000000  -0.682397
2          1.000000  1.000000  1.000000  1.000000  -0.682386
3          1.000000  1.000000  1.000000  1.000000  -0.682376
portfolio -0.682379 -0.682397 -0.682386 -0.682376   1.000000
------------------
0:  annret:13.641,  sharpe:0.651
1:  annret:15.570,  sharpe:0.692
2:  annret:36.149,  sharpe:1.538
3:  annret:33.566,  sharpe:1.460
          0         1         2         3
0  1.000000  0.539944  0.569126  0.580220
1  0.539944  1.000000  0.401829  0.382410
2  0.569126  0.401829  1.000000  0.544485
3  0.580220  0.382410  0.544485  1.000000
Timestep 192000, Reward: 601.3406357097116, TD Loss: 16.803590317229425
test
0:  annret:17.535,  sharpe:1.158
1:  annret:15.699,  sharpe:0.761
2:  annret:16.978,  sharpe:0.859
3:  annret:16.178,  sharpe:0.752
          0         1         2         3
0  1.000000  0.624866  0.786397  0.822131
1  0.624866  1.000000  0.847062  0.825721
2  0.786397  0.847062  1.000000  0.863311
3  0.822131  0.825721  0.863311  1.000000
train
0:  annret:-1.829,  sharpe:-0.059
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:58.246,  sharpe:3.446
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.680129
1          1.000000  1.000000  1.000000  1.000000  -0.680136
2          1.000000  1.000000  1.000000  1.000000  -0.680134
3          1.000000  1.000000  1.000000  1.000000  -0.680141
portfolio -0.680129 -0.680136 -0.680134 -0.680141   1.000000
test
0:  annret:-17.410,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:21.018,  sharpe:1.833
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.817897
1          1.000000  1.000000  1.000000  1.000000  -0.817917
2          1.000000  1.000000  1.000000  1.000000  -0.817913
3          1.000000  1.000000  1.000000  1.000000  -0.817916
portfolio -0.817897 -0.817917 -0.817913 -0.817916   1.000000
------------------
Timestep 193000, Reward: 601.3406357097116, TD Loss: 24.120816164631684
test
0:  annret:4.394,  sharpe:0.537
1:  annret:14.952,  sharpe:0.747
2:  annret:17.144,  sharpe:0.859
3:  annret:15.647,  sharpe:0.809
          0         1         2         3
0  1.000000 -0.398165 -0.280178 -0.327149
1 -0.398165  1.000000  0.889589  0.872304
2 -0.280178  0.889589  1.000000  0.880297
3 -0.327149  0.872304  0.880297  1.000000
train
0:  annret:-1.826,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:64.278,  sharpe:4.200
                 0         1         2         3  portfolio
0          1.00000  1.000000  1.000000  1.000000  -0.400490
1          1.00000  1.000000  1.000000  1.000000  -0.400494
2          1.00000  1.000000  1.000000  1.000000  -0.400496
3          1.00000  1.000000  1.000000  1.000000  -0.400497
portfolio -0.40049 -0.400494 -0.400496 -0.400497   1.000000
test
0:  annret:-17.407,  sharpe:-0.673
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:18.816,  sharpe:2.016
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.608826
1          1.000000  1.000000  1.000000  1.000000  -0.608839
2          1.000000  1.000000  1.000000  1.000000  -0.608837
3          1.000000  1.000000  1.000000  1.000000  -0.608833
portfolio -0.608826 -0.608839 -0.608837 -0.608833   1.000000
------------------
0:  annret:22.102,  sharpe:1.015
1:  annret:23.345,  sharpe:0.989
2:  annret:27.840,  sharpe:1.208
3:  annret:27.884,  sharpe:1.195
          0         1         2         3
0  1.000000  0.403141  0.493948  0.471025
1  0.403141  1.000000  0.612431  0.674761
2  0.493948  0.612431  1.000000  0.598533
3  0.471025  0.674761  0.598533  1.000000
Timestep 194000, Reward: 573.5083926371198, TD Loss: 8.468836949692639
test
0:  annret:0.814,  sharpe:0.079
1:  annret:14.119,  sharpe:0.699
2:  annret:17.947,  sharpe:0.903
3:  annret:14.386,  sharpe:0.715
          0         1         2         3
0  1.000000 -0.347192 -0.357163 -0.428800
1 -0.347192  1.000000  0.833496  0.817550
2 -0.357163  0.833496  1.000000  0.868464
3 -0.428800  0.817550  0.868464  1.000000
train
0:  annret:-1.823,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.832,  sharpe:-0.059
portfolio:  annret:67.459,  sharpe:4.572
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.425433
1          1.000000  1.000000  1.000000  1.000000  -0.425444
2          1.000000  1.000000  1.000000  1.000000  -0.425441
3          1.000000  1.000000  1.000000  1.000000  -0.425441
portfolio -0.425433 -0.425444 -0.425441 -0.425441   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.414,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:18.271,  sharpe:2.133
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.520724
1          1.000000  1.000000  1.000000  1.00000  -0.520753
2          1.000000  1.000000  1.000000  1.00000  -0.520744
3          1.000000  1.000000  1.000000  1.00000  -0.520740
portfolio -0.520724 -0.520753 -0.520744 -0.52074   1.000000
------------------
Timestep 195000, Reward: 573.5083926371198, TD Loss: 27.983201289022578
test
0:  annret:3.567,  sharpe:0.429
1:  annret:12.969,  sharpe:0.681
2:  annret:14.109,  sharpe:0.777
3:  annret:12.308,  sharpe:0.628
          0         1         2         3
0  1.000000  0.131928  0.210127  0.193877
1  0.131928  1.000000  0.859679  0.850929
2  0.210127  0.859679  1.000000  0.883197
3  0.193877  0.850929  0.883197  1.000000
train
0:  annret:-1.843,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.833,  sharpe:-0.059
3:  annret:-1.833,  sharpe:-0.059
portfolio:  annret:54.209,  sharpe:3.261
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.530423
1          1.000000  1.000000  1.000000  1.000000  -0.530439
2          1.000000  1.000000  1.000000  1.000000  -0.530434
3          1.000000  1.000000  1.000000  1.000000  -0.530434
portfolio -0.530423 -0.530439 -0.530434 -0.530434   1.000000
test
0:  annret:-17.419,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.419,  sharpe:-0.674
portfolio:  annret:10.254,  sharpe:0.922
                  0         1         2        3  portfolio
0          1.000000  1.000000  1.000000  1.00000  -0.764644
1          1.000000  1.000000  1.000000  1.00000  -0.764675
2          1.000000  1.000000  1.000000  1.00000  -0.764659
3          1.000000  1.000000  1.000000  1.00000  -0.764660
portfolio -0.764644 -0.764675 -0.764659 -0.76466   1.000000
------------------
0:  annret:20.401,  sharpe:1.022
1:  annret:19.590,  sharpe:0.838
2:  annret:36.405,  sharpe:1.644
3:  annret:21.408,  sharpe:0.946
          0         1         2         3
0  1.000000  0.497508  0.468739  0.459909
1  0.497508  1.000000  0.556309  0.610740
2  0.468739  0.556309  1.000000  0.572093
3  0.459909  0.610740  0.572093  1.000000
Timestep 196000, Reward: 534.6958862459776, TD Loss: 17.22101914452269
test
0:  annret:13.479,  sharpe:0.788
1:  annret:16.736,  sharpe:0.827
2:  annret:16.368,  sharpe:0.865
3:  annret:18.898,  sharpe:0.863
          0         1         2         3
0  1.000000  0.775264  0.832871  0.856039
1  0.775264  1.000000  0.860364  0.885303
2  0.832871  0.860364  1.000000  0.895283
3  0.856039  0.885303  0.895283  1.000000
train
0:  annret:-1.830,  sharpe:-0.059
1:  annret:-1.834,  sharpe:-0.060
2:  annret:-1.834,  sharpe:-0.060
3:  annret:-1.833,  sharpe:-0.060
portfolio:  annret:56.537,  sharpe:3.170
                  0        1         2        3  portfolio
0          1.000000  1.00000  1.000000  1.00000  -0.700839
1          1.000000  1.00000  1.000000  1.00000  -0.700840
2          1.000000  1.00000  1.000000  1.00000  -0.700842
3          1.000000  1.00000  1.000000  1.00000  -0.700840
portfolio -0.700839 -0.70084 -0.700842 -0.70084   1.000000
test
0:  annret:-17.411,  sharpe:-0.674
1:  annret:-17.415,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.417,  sharpe:-0.674
portfolio:  annret:21.707,  sharpe:1.706
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.825796
1          1.000000  1.000000  1.000000  1.000000  -0.825803
2          1.000000  1.000000  1.000000  1.000000  -0.825797
3          1.000000  1.000000  1.000000  1.000000  -0.825795
portfolio -0.825796 -0.825803 -0.825797 -0.825795   1.000000
------------------
Timestep 197000, Reward: 534.6958862459776, TD Loss: 184.46165836386663
test
0:  annret:21.293,  sharpe:0.978
1:  annret:16.648,  sharpe:0.759
2:  annret:19.454,  sharpe:0.891
3:  annret:17.998,  sharpe:0.773
          0         1         2         3
0  1.000000  0.923230  0.918190  0.947738
1  0.923230  1.000000  0.943286  0.962953
2  0.918190  0.943286  1.000000  0.948115
3  0.947738  0.962953  0.948115  1.000000
train
0:  annret:-1.833,  sharpe:-0.060
1:  annret:-1.837,  sharpe:-0.060
2:  annret:-1.836,  sharpe:-0.060
3:  annret:-1.839,  sharpe:-0.060
portfolio:  annret:41.744,  sharpe:1.832
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.867941
1          1.000000  1.000000  1.000000  1.000000  -0.867938
2          1.000000  1.000000  1.000000  1.000000  -0.867934
3          1.000000  1.000000  1.000000  1.000000  -0.867937
portfolio -0.867941 -0.867938 -0.867934 -0.867937   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.418,  sharpe:-0.674
3:  annret:-17.422,  sharpe:-0.674
portfolio:  annret:18.825,  sharpe:1.013
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.964081
1          1.000000  1.000000  1.000000  1.000000  -0.964082
2          1.000000  1.000000  1.000000  1.000000  -0.964078
3          1.000000  1.000000  1.000000  1.000000  -0.964077
portfolio -0.964081 -0.964082 -0.964078 -0.964077   1.000000
------------------
0:  annret:17.745,  sharpe:0.816
1:  annret:8.591,  sharpe:0.387
2:  annret:32.424,  sharpe:1.479
3:  annret:26.546,  sharpe:1.154
          0         1         2         3
0  1.000000  0.555409  0.571957  0.574790
1  0.555409  1.000000  0.457648  0.429738
2  0.571957  0.457648  1.000000  0.534119
3  0.574790  0.429738  0.534119  1.000000
Timestep 198000, Reward: 513.8880271729664, TD Loss: 14.14594827888163
test
0:  annret:-0.026,  sharpe:-0.003
1:  annret:18.000,  sharpe:0.906
2:  annret:14.506,  sharpe:0.943
3:  annret:17.029,  sharpe:0.839
          0         1         2         3
0  1.000000  0.062027  0.217430  0.075865
1  0.062027  1.000000  0.753717  0.856418
2  0.217430  0.753717  1.000000  0.730360
3  0.075865  0.856418  0.730360  1.000000
train
0:  annret:-1.825,  sharpe:-0.059
1:  annret:-1.833,  sharpe:-0.059
2:  annret:-1.831,  sharpe:-0.059
3:  annret:-1.834,  sharpe:-0.060
portfolio:  annret:66.230,  sharpe:4.248
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.389355
1          1.000000  1.000000  1.000000  1.000000  -0.389352
2          1.000000  1.000000  1.000000  1.000000  -0.389357
3          1.000000  1.000000  1.000000  1.000000  -0.389367
portfolio -0.389355 -0.389352 -0.389357 -0.389367   1.000000
test
0:  annret:-17.406,  sharpe:-0.673
1:  annret:-17.418,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.416,  sharpe:-0.674
portfolio:  annret:19.326,  sharpe:2.059
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.535303
1          1.000000  1.000000  1.000000  1.000000  -0.535324
2          1.000000  1.000000  1.000000  1.000000  -0.535318
3          1.000000  1.000000  1.000000  1.000000  -0.535333
portfolio -0.535303 -0.535324 -0.535318 -0.535333   1.000000
------------------
Timestep 199000, Reward: 513.8880271729664, TD Loss: 19.7524088384927
test
0:  annret:21.297,  sharpe:1.008
1:  annret:18.777,  sharpe:0.819
2:  annret:19.775,  sharpe:0.945
3:  annret:16.908,  sharpe:0.741
          0         1         2         3
0  1.000000  0.908458  0.918835  0.917139
1  0.908458  1.000000  0.935643  0.945086
2  0.918835  0.935643  1.000000  0.926483
3  0.917139  0.945086  0.926483  1.000000
train
0:  annret:-1.832,  sharpe:-0.059
1:  annret:-1.836,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.837,  sharpe:-0.060
portfolio:  annret:44.875,  sharpe:2.017
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.879638
1          1.000000  1.000000  1.000000  1.000000  -0.879636
2          1.000000  1.000000  1.000000  1.000000  -0.879637
3          1.000000  1.000000  1.000000  1.000000  -0.879636
portfolio -0.879638 -0.879636 -0.879637 -0.879636   1.000000
test
0:  annret:-17.412,  sharpe:-0.674
1:  annret:-17.418,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:20.731,  sharpe:1.170
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.953879
1          1.000000  1.000000  1.000000  1.000000  -0.953883
2          1.000000  1.000000  1.000000  1.000000  -0.953881
3          1.000000  1.000000  1.000000  1.000000  -0.953885
portfolio -0.953879 -0.953883 -0.953881 -0.953885   1.000000
------------------
Timestep 200000, Reward: 513.8880271729664, TD Loss: 23.360478606538003
test
0:  annret:16.919,  sharpe:0.890
1:  annret:9.985,  sharpe:0.591
2:  annret:16.454,  sharpe:0.868
3:  annret:18.001,  sharpe:0.830
          0         1         2         3
0  1.000000  0.664867  0.871015  0.863849
1  0.664867  1.000000  0.760570  0.762628
2  0.871015  0.760570  1.000000  0.846823
3  0.863849  0.762628  0.846823  1.000000
train
0:  annret:-1.835,  sharpe:-0.060
1:  annret:-1.835,  sharpe:-0.060
2:  annret:-1.835,  sharpe:-0.060
3:  annret:-1.836,  sharpe:-0.060
portfolio:  annret:53.643,  sharpe:2.949
                  0         1         2         3  portfolio
0          1.000000  1.000000  1.000000  1.000000  -0.703804
1          1.000000  1.000000  1.000000  1.000000  -0.703803
2          1.000000  1.000000  1.000000  1.000000  -0.703804
3          1.000000  1.000000  1.000000  1.000000  -0.703809
portfolio -0.703804 -0.703803 -0.703804 -0.703809   1.000000
test
0:  annret:-17.413,  sharpe:-0.674
1:  annret:-17.416,  sharpe:-0.674
2:  annret:-17.417,  sharpe:-0.674
3:  annret:-17.418,  sharpe:-0.674
portfolio:  annret:16.896,  sharpe:1.331
                 0        1         2         3  portfolio
0          1.00000  1.00000  1.000000  1.000000  -0.865150
1          1.00000  1.00000  1.000000  1.000000  -0.865150
2          1.00000  1.00000  1.000000  1.000000  -0.865153
3          1.00000  1.00000  1.000000  1.000000  -0.865158
portfolio -0.86515 -0.86515 -0.865153 -0.865158   1.000000
------------------
0:  annret:15.337,  sharpe:0.696
1:  annret:21.648,  sharpe:0.989
2:  annret:30.145,  sharpe:1.355
3:  annret:29.775,  sharpe:1.269
          0         1         2         3
0  1.000000  0.261409  0.580838  0.665119
1  0.261409  1.000000  0.198536  0.238827
2  0.580838  0.198536  1.000000  0.643632
3  0.665119  0.238827  0.643632  1.000000
